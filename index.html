<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb" dir="ltr" >
<head>

<script src="version.js"></script>

<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

<script src="fits.js" type="text/javascript" charset="utf-8"></script>    
<script type="text/javascript">
  var FITS = astro.FITS;
</script>

<style>
body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 14px;
}

/* Style the tab */
div.tab {
    margin: auto;
    overflow: hidden;
    border: 1px solid #000;
    background-color: #CED8F6;
    width:984px;
    #box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1), 0 0 10px 0 rgba(0, 0, 0, 0.1);
}

/* Style the buttons inside the tab */
div.tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
}

/* Change background color of buttons on hover */
div.tab button:hover {
    background-color: #BBD1FC;
}

/* Create an active/current tablink class */
div.tab button.active {
    background-color: #9ABCFD;
}

/* Style the tab content */
.tabcontent {
    margin: auto;
    display: none;
    padding: 6px 12px;
    border: 1px solid #000;
    border-top: none;
    width:960px;
    background-color: #E6E6FA;
    height: 520px;
    overflow: scroll;
    #box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1), 0 0 10px 0 rgba(0, 0, 0, 0.1);
}
</style>

<SCRIPT LANGUAGE="JavaScript">
$(document).on('keydown', 'input', function (e) {
    var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;
    if (key == 13) {
        e.preventDefault();
        var inputs = $(this).closest('form').find(':input:visible:enabled');
        if ((inputs.length-1) == inputs.index(this))
            $(':input:enabled:visible:first').focus();
        else
            inputs.eq(inputs.index(this) + 1).focus();
    } else if (key == 27) {
        $(this).val(window.event.srcElement.defaultValue);
        $('input').blur();
    }
});
</script>

<SCRIPT LANGUAGE="JavaScript">
function openTabContent(evt, tabName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}
</script>

<script type="text/javascript">
$(document).ready(function () {
    $('#runStarProducer').change(function () {
      if (this.checked) {
        $('#StarProducer').fadeIn();
        $('#runTransitFluxModulator_star0').prop('checked', true);
        $('#runTransitFluxModulator_star0').prop('disabled', false);
        $('#TransitFluxModulator_star0').fadeIn();
        $('#runTransitFluxModulator_star1').prop('disabled', false);
        if (document.getElementById("runTransitFluxModulator_star1").checked) {
            $('#TransitFluxModulator_star1').fadeIn();
        }
        $('#runTransitFluxModulator_star2').prop('disabled', false);
        if (document.getElementById("runTransitFluxModulator_star2").checked) {
            $('#TransitFluxModulator_star2').fadeIn();
        }
        $('#runStellarNoiseFluxModulator_star0').prop('checked', true);
        $('#runStellarNoiseFluxModulator_star0').prop('disabled', false);
        $('#StellarNoiseFluxModulator_star0').fadeIn();
        $('#runStellarVariationFluxModulator_star0').prop('disabled', false);
        if (document.getElementById("runStellarVariationFluxModulator_star0").checked) {
            $('#StellarVariationFluxModulator_star0').fadeIn();
        }
        $('#runUserFluxModifier_star0').prop('disabled', false);
        if (document.getElementById("runUserFluxModifier_star0").checked) {
            $('#UserFluxModifier_star0').fadeIn();
        }
        if (document.getElementById("runFocalPlaneGenerator").checked) {
          $('#runPSFGenerator').prop('checked', true);
          $('#runPSFGenerator').prop('disabled', false);
          $('#PSFGenerator').fadeIn();
          $('#runHaloGenerator').prop('disabled', false);
          if (document.getElementById("runHaloGenerator").checked) {
            $('#HaloGenerator').fadeIn();
          }
          $('#runFrameTransferSmearer').prop('checked', true);
          $('#runFrameTransferSmearer').prop('disabled', false);
          $('#FrameTransferSmearer').fadeIn();
          $('#writeImagettes').prop('checked', true);
          $('#writeImagettes').prop('disabled', false);
          $('#writeCentroid').prop('checked', true);
          $('#writeCentroid').prop('disabled', false);
        }
        $('#writeIncidentLightCurve').prop('checked', true);
        $('#writeIncidentLightCurve').prop('disabled', false);
      } else {
        $('#StarProducer').fadeOut();
        $('#runTransitFluxModulator_star0').prop('checked', false);
        $('#runTransitFluxModulator_star0').prop('disabled', true);
        $('#TransitFluxModulator_star0').fadeOut();
        $('#runTransitFluxModulator_star1').prop('disabled', true);
        $('#TransitFluxModulator_star1').fadeOut();
        $('#runTransitFluxModulator_star2').prop('disabled', true);
        $('#TransitFluxModulator_star2').fadeOut();
        $('#runStellarNoiseFluxModulator_star0').prop('checked', false);
        $('#runStellarNoiseFluxModulator_star0').prop('disabled', true);
        $('#StellarNoiseFluxModulator_star0').fadeOut();
        $('#runStellarVariationFluxModulator_star0').prop('disabled', true);
        $('#StellarVariationFluxModulator_star0').fadeOut();
        $('#runUserFluxModifier_star0').prop('disabled', true);
        $('#UserFluxModifier_star0').fadeOut();
        $('#runPSFGenerator').prop('checked', false);
        $('#runPSFGenerator').prop('disabled', true);
        $('#PSFGenerator').fadeOut();
        $('#runHaloGenerator').prop('disabled', true);
        $('#HaloGenerator').fadeOut();
        $('#runFrameTransferSmearer').prop('checked', false);
        $('#runFrameTransferSmearer').prop('disabled', true);
        $('#FrameTransferSmearer').fadeOut();
        $('#writeIncidentLightCurve').prop('checked', false);
        $('#writeIncidentLightCurve').prop('disabled', true);
        $('#writeImagettes').prop('checked', false);
        $('#writeImagettes').prop('disabled', true);
        $('#writeCentroid').prop('checked', false);
        $('#writeCentroid').prop('disabled', true);
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doForegroundStars').change(function () {
      if (this.checked) {
        $('#foregroundStars').fadeIn();
        $('#runTransitFluxModulator_star0').prop('checked', true);
        $('#runTransitFluxModulator_star0').prop('disabled', false);
        $('#TransitFluxModulator_star0').fadeIn();
        $('#runTransitFluxModulator_star1').prop('checked', true);
        $('#runTransitFluxModulator_star1').prop('disabled', false);
        $('#TransitFluxModulator_star1').fadeIn();
        $('#runTransitFluxModulator_star2').prop('checked', true);
        $('#runTransitFluxModulator_star2').prop('disabled', false);
        $('#TransitFluxModulator_star2').fadeIn();
        $('#runStellarNoiseFluxModulator_star0').prop('checked', true);
        $('#runStellarNoiseFluxModulator_star0').prop('disabled', false);
        $('#StellarNoiseFluxModulator_star0').fadeIn();
        $('#runStellarVariationFluxModulator_star0').prop('disabled', false);
        $('#StellarVariationFluxModulator_star0').fadeIn();
        $('#runUserFluxModifier_star0').prop('disabled', false);
        $('#UserFluxModifier_star0').fadeIn();
        if (document.getElementById("runFocalPlaneGenerator").checked) {
          $('#writeIncidentLightCurve').prop('checked', true);
          $('#writeIncidentLightCurve').prop('disabled', false);
          $('#writeImagettes').prop('checked', true);
          $('#writeImagettes').prop('disabled', false);
          $('#writeCentroid').prop('checked', true);
          $('#writeCentroid').prop('disabled', false);
        }
     } else {
        $('#foregroundStars').fadeOut();
        $('#doBackgroundStars').prop('checked', true);
        $('#backgroundStars').fadeIn();
        $('#runTransitFluxModulator_star0').prop('checked', false);
        $('#runTransitFluxModulator_star0').prop('disabled', true);
        $('#TransitFluxModulator_star0').fadeOut();
        $('#runTransitFluxModulator_star1').prop('checked', false);
        $('#runTransitFluxModulator_star1').prop('disabled', true);
        $('#TransitFluxModulator_star1').fadeOut();
        $('#runTransitFluxModulator_star2').prop('checked', false);
        $('#runTransitFluxModulator_star2').prop('disabled', true);
        $('#TransitFluxModulator_star2').fadeOut();
        $('#runStellarNoiseFluxModulator_star0').prop('checked', false);
        $('#runStellarNoiseFluxModulator_star0').prop('disabled', true);
        $('#StellarNoiseFluxModulator_star0').fadeOut();
        $('#runStellarVariationFluxModulator_star0').prop('disabled', true);
        $('#StellarVariationFluxModulator_star0').fadeOut();
        $('#runUserFluxModifier_star0').prop('disabled', true);
        $('#UserFluxModifier_star0').fadeOut();
        $('#writeIncidentLightCurve').prop('checked', false);
        $('#writeIncidentLightCurve').prop('disabled', true);
        $('#writeImagettes').prop('checked', false);
        $('#writeImagettes').prop('disabled', true);
        $('#writeCentroid').prop('checked', false);
        $('#writeCentroid').prop('disabled', true);
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doBackgroundStars').change(function () {
      if (this.checked) {
        $('#backgroundStars').fadeIn();
      } else {
        if (!document.getElementById("doForegroundStars").checked) {
          alert("Cannot run StarProducer with both foreground and background stars deselected. In order to deselect background stars, please select foreground stars or deselect StarProducer.");
          $(this).prop('checked', true);
          return;
        }
        $('#backgroundStars').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runTransitFluxModulator_star0').change(function () {
      if (this.checked) {
        $('#TransitFluxModulator_star0').fadeIn();
      } else {
        $('#TransitFluxModulator_star0').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runTransitFluxModulator_star1').change(function () {
      if (this.checked) {
        $('#TransitFluxModulator_star1').fadeIn();
      } else {
        $('#TransitFluxModulator_star1').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runTransitFluxModulator_star2').change(function () {
      if (this.checked) {
        $('#TransitFluxModulator_star2').fadeIn();
      } else {
        $('#TransitFluxModulator_star2').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runStellarNoiseFluxModulator_star0').change(function () {
      if (this.checked) {
        $('#StellarNoiseFluxModulator_star0').fadeIn();
      } else {
        $('#StellarNoiseFluxModulator_star0').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runStellarVariationFluxModulator_star0').change(function () {
      if (this.checked) {
        $('#StellarVariationFluxModulator_star0').fadeIn();
      } else {
        $('#StellarVariationFluxModulator_star0').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runUserFluxModifier_star0').change(function () {
      if (this.checked) {
        $('#UserFluxModifier_star0').fadeIn();
      } else {
        $('#UserFluxModifier_star0').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runOrbitSimulator').change(function () {
      if (this.checked) {
        $('#OrbitSimulator').fadeIn();
        $('#runJitterProducer').prop('checked', true);
        $('#runJitterProducer').prop('disabled', false);
        $('#JitterProducer').fadeIn();
      } else {
        $('#OrbitSimulator').fadeOut();
        $('#runJitterProducer').prop('checked', false);
        $('#runJitterProducer').prop('disabled', true);
        $('#JitterProducer').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#rotateFOV').change(function () {
      if (this.checked) {
        $('#rotation').fadeIn();
      } else {
        $('#rotation').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#telescopeTemperatureVariation').change(function () {
      if (this.checked) {
        $('#telescopeTemp').fadeIn();
      } else {
        $('#telescopeTemp').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#ccdTemperatureVariation').change(function () {
      if (this.checked) {
        $('#ccdTemp').fadeIn();
      } else {
        $('#ccdTemp').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#feeTemperatureVariation').change(function () {
      if (this.checked) {
        $('#feeTemp').fadeIn();
      } else {
        $('#feeTemp').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runJitterProducer').change(function () {
      if (this.checked) {
        $('#JitterProducer').fadeIn();
      } else {
        $('#JitterProducer').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runFocalPlaneGenerator').change(function () {
      if (this.checked) {
        $('#FocalPlaneGenerator').fadeIn();
        $('#runPSFGenerator').prop('disabled', false);
        $('#runHaloGenerator').prop('disabled', false);
        $('#runZodiacalLightGenerator').prop('checked', true);
        $('#runZodiacalLightGenerator').prop('disabled', false);
        $('#runStrayLightGenerator').prop('checked', true);
        $('#runStrayLightGenerator').prop('disabled', false);
        $('#StrayLightGenerator').fadeIn();
        $('#runGlobalThroughputGenerator').prop('checked', true);
        $('#runGlobalThroughputGenerator').prop('disabled', false);
        $('#GlobalThroughputGenerator').fadeIn();
        $('#runFlatFieldGenerator').prop('checked', true);
        $('#runFlatFieldGenerator').prop('disabled', false);
        $('#FlatFieldGenerator').fadeIn();
        $('#runFrameTransferSmearer').prop('checked', true);
        $('#runFrameTransferSmearer').prop('disabled', false);
        $('#FrameTransferSmearer').fadeIn();
        $('#runPhotonNoiseGenerator').prop('checked', true);
        $('#runPhotonNoiseGenerator').prop('disabled', false);
        $('#PhotonNoiseGenerator').fadeIn();
        if (document.getElementById("runStarProducer").checked) {
          $('#runPSFGenerator').prop('checked', true);
          $('#PSFGenerator').fadeIn();
          $('#runHaloGenerator').prop('checked', true);
          $('#HaloGenerator').fadeIn();
        }
        $('#runDarkCurrentGenerator').prop('checked', true);
        $('#runDarkCurrentGenerator').prop('disabled', false);
        $('#DarkCurrentGenerator').fadeIn();
        $('#runCosmicRayGenerator').prop('checked', true);
        $('#runCosmicRayGenerator').prop('disabled', false);
        $('#CosmicRayGenerator').fadeIn();
        $('#runFullWellSimulator').prop('checked', true);
        $('#runFullWellSimulator').prop('disabled', false);
        $('#FullWellSimulator').fadeIn();
        $('#runChargeTransferSimulator').prop('disabled', false);
        if (document.getElementById("runChargeTransferSimulator").checked) {
          $('#ChargeTransferSimulator').fadeIn();
        }
        $('#runBiasGenerator').prop('checked', true);
        $('#runBiasGenerator').prop('disabled', false);
        $('#BiasGenerator').fadeIn();
        $('#runImageWriter').prop('checked', true);
        $('#runImageWriter').prop('disabled', false);
        $('#ImageWriter').fadeIn();
        $('#extractLightCurve').prop('disabled', false);
      } else {
        $('#FocalPlaneGenerator').fadeOut();
        $('#runZodiacalLightGenerator').prop('checked', false);
        $('#runZodiacalLightGenerator').prop('disabled', true);
        $('#runStrayLightGenerator').prop('checked', false);
        $('#runStrayLightGenerator').prop('disabled', true);
        $('#StrayLightGenerator').fadeOut();
        $('#runGlobalThroughputGenerator').prop('checked', false);
        $('#runGlobalThroughputGenerator').prop('disabled', true);
        $('#GlobalThroughputGenerator').fadeOut();
        $('#runPSFGenerator').prop('checked', false);
        $('#runPSFGenerator').prop('disabled', true);
        $('#PSFGenerator').fadeOut();
        $('#runHaloGenerator').prop('checked', false);
        $('#runHaloGenerator').prop('disabled', true);
        $('#HaloGenerator').fadeOut();
        $('#runFlatFieldGenerator').prop('checked', false);
        $('#runFlatFieldGenerator').prop('disabled', true);
        $('#FlatFieldGenerator').fadeOut();
        $('#runFrameTransferSmearer').prop('checked', false);
        $('#runFrameTransferSmearer').prop('disabled', true);
        $('#FrameTransferSmearer').fadeOut();
        $('#runPhotonNoiseGenerator').prop('checked', false);
        $('#runPhotonNoiseGenerator').prop('disabled', true);
        $('#PhotonNoiseGenerator').fadeOut();
        $('#runDarkCurrentGenerator').prop('checked', false);
        $('#runDarkCurrentGenerator').prop('disabled', true);
        $('#DarkCurrentGenerator').fadeOut();
        $('#runCosmicRayGenerator').prop('checked', false);
        $('#runCosmicRayGenerator').prop('disabled', true);
        $('#CosmicRayGenerator').fadeOut();
        $('#runFullWellSimulator').prop('checked', false);
        $('#runFullWellSimulator').prop('disabled', true);
        $('#FullWellSimulator').fadeOut();
        $('#runChargeTransferSimulator').prop('disabled', true);
        $('#ChargeTransferSimulator').fadeOut();
        $('#runBiasGenerator').prop('checked', false);
        $('#runBiasGenerator').prop('disabled', true);
        $('#BiasGenerator').fadeOut();
        $('#runImageWriter').prop('checked', false);
        $('#runImageWriter').prop('disabled', true);
        $('#ImageWriter').fadeOut();
        $('#extractLightCurve').prop('checked', false);
        $('#extractLightCurve').prop('disabled', true);
        $('#photometry').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runStrayLightGenerator').change(function () {
      if (this.checked) {
        $('#StrayLightGenerator').fadeIn();
      } else {
        $('#StrayLightGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runGlobalThroughputGenerator').change(function () {
      if (this.checked) {
        $('#GlobalThroughputGenerator').fadeIn();
      } else {
        $('#GlobalThroughputGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runPSFGenerator').change(function () {
      if (this.checked) {
        $('#PSFGenerator').fadeIn();
        $('#runFrameTransferSmearer').prop('checked', true);
        $('#runFrameTransferSmearer').prop('disabled', false);
        $('#FrameTransferSmearer').fadeIn();
        $('#writeImagettes').prop('checked', true);
        $('#writeImagettes').prop('disabled', false);
        $('#writeCentroid').prop('checked', true);
        $('#writeCentroid').prop('disabled', false);
      } else {
        $('#PSFGenerator').fadeOut();
        $('#runFrameTransferSmearer').prop('checked', false);
        $('#runFrameTransferSmearer').prop('disabled', true);
        $('#FrameTransferSmearer').fadeOut();
        $('#writeImagettes').prop('checked', false);
        $('#writeImagettes').prop('disabled', true);
        $('#writeCentroid').prop('checked', false);
        $('#writeCentroid').prop('disabled', true);
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runHaloGenerator').change(function () {
      if (this.checked) {
        $('#HaloGenerator').fadeIn();
      } else {
        $('#HaloGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runFrameTransferSmearer').change(function () {
      if (this.checked) {
        $('#FrameTransferSmearer').fadeIn();
      } else {
        $('#FrameTransferSmearer').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runFlatFieldGenerator').change(function () {
      if (this.checked) {
        $('#FlatFieldGenerator').fadeIn();
        $('#subtractFlatField').prop('disabled', false);
      } else {
        $('#FlatFieldGenerator').fadeOut();
        $('#subtractFlatField').prop('disabled', true);
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#applyThroughput').change(function () {
      if (this.checked) {
        $('#throughput').fadeIn();
      } else {
        $('#throughput').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#applyFlatField').change(function () {
      if (this.checked) {
        $('#flatField').fadeIn();
      } else {
        $('#flatField').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#applyQE').change(function () {
      if (this.checked) {
        $('#QE').fadeIn();
      } else {
        $('#QE').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doDeadPixels').change(function () {
      if (this.checked) {
        $('#DeadPixels').fadeIn();
      } else {
        $('#DeadPixels').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runDarkCurrentGenerator').change(function () {
      if (this.checked) {
        $('#DarkCurrentGenerator').fadeIn();
      } else {
        $('#DarkCurrentGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#includeReadoutTime').change(function () {
      if (this.checked) {
        $('#readoutTime').fadeIn();
      } else {
        $('#readoutTime').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doHotPixels').change(function () {
      if (this.checked) {
        $('#HotPixels').fadeIn();
      } else {
        $('#HotPixels').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doWarmPixels').change(function () {
      if (this.checked) {
        $('#WarmPixels').fadeIn();
      } else {
        $('#WarmPixels').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doTelegraphicPixels').change(function () {
      if (this.checked) {
        $('#TelegraphicPixels').fadeIn();
      } else {
        $('#TelegraphicPixels').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doManualHotPixels').change(function () {
      if (this.checked) {
        $('#ManualHotPixels').fadeIn();
      } else {
        $('#ManualHotPixels').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runPhotonNoiseGenerator').change(function () {
      if (this.checked) {
        $('#PhotonNoiseGenerator').fadeIn();
      } else {
        $('#PhotonNoiseGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runCosmicRayGenerator').change(function () {
      if (this.checked) {
        $('#CosmicRayGenerator').fadeIn();
      } else {
        $('#CosmicRayGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runFullWellSimulator').change(function () {
      if (this.checked) {
        $('#FullWellSimulator').fadeIn();
      } else {
        $('#FullWellSimulator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runChargeTransferSimulator').change(function () {
      if (this.checked) {
        $('#ChargeTransferSimulator').fadeIn();
      } else {
        $('#ChargeTransferSimulator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#runBiasGenerator').change(function () {
      if (this.checked) {
        $('#BiasGenerator').fadeIn();
      } else {
        $('#BiasGenerator').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#doCcdNonLinearity').change(function () {
      if (this.checked) {
        $('#ccdNonLinearity').fadeIn();
      } else {
        $('#ccdNonLinearity').fadeOut();
      }
    });
});
</script>
<!-- <script type="text/javascript"> -->
<!-- $(document).ready(function () { -->
<!--     $('#applyAnalogChainRandomNoise').change(function () { -->
<!--       if (this.checked) { -->
<!--         $('#analogChainRandomNoise').fadeIn(); -->
<!--       } else { -->
<!--         $('#analogChainRandomNoise').fadeOut(); -->
<!--       } -->
<!--     }); -->
<!-- }); -->
<!-- </script> -->
<!-- <script type="text/javascript"> -->
<!-- $(document).ready(function () { -->
<!--     $('#doADCSaturation').change(function () { -->
<!--       if (this.checked) { -->
<!--         $('#ADCSaturation').fadeIn(); -->
<!--       } else { -->
<!--         $('#ADCSaturation').fadeOut(); -->
<!--       } -->
<!--     }); -->
<!-- }); -->
<!-- </script> -->
<script type="text/javascript">
$(document).ready(function () {
    $('#runImageWriter').change(function () {
      if (this.checked) {
        $('#ImageWriter').fadeIn();
        $('#extractLightCurve').prop('disabled', false);
      } else {
        $('#ImageWriter').fadeOut();
        $('#extractLightCurve').prop('checked', false);
        $('#extractLightCurve').prop('disabled', true);
        $('#photometry').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#writeStackedImages').change(function () {
      if (this.checked) {
        $('#stackedImages').fadeIn();
      } else {
        $('#stackedImages').fadeOut();
      }
    });
});
$(document).ready(function () {
    $('#writeImagettes').change(function () {
      if (this.checked) {
        $('#imagette').fadeIn();
      } else {
        $('#imagette').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#extractLightCurve').change(function () {
      if (this.checked) {
        $('#photometry').fadeIn();
      } else {
        $('#photometry').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#subtractBackground').change(function () {
      if (this.checked) {
        $('#backgroundSubtraction').fadeIn();
      } else {
        $('#backgroundSubtraction').fadeOut();
      }
    });
});
</script>
<script type="text/javascript">
$(document).ready(function () {
    $('#subtractFlatField').change(function () {
      if (this.checked) {
        $('#flatFieldCorrection').fadeIn();
      } else {
        $('#flatFieldCorrection').fadeOut();
      }
    });
});
</script>

<script language="JavaScript">
function showHide() {

    if (sessionStorage.getItem("repetitionPeriod")>0) {
      document.getElementById("repetitionPeriodTR").style.display = "table-row";
    } else {
      document.getElementById("repetitionPeriodTR").style.display = "none";
    }

    if (document.getElementById("visitFileExists").value=="true") {
      document.getElementById("saaFlagFromVisitConstraints").disabled = false; 
      document.getElementById("saaFlagFromVisitConstraints").checked = true;
      document.getElementById("strayLightFromVisitConstraints").disabled = false; 
      document.getElementById("strayLightFromVisitConstraints").checked = true;
    }

    if (document.getElementById("runStarProducer").checked) {
      document.getElementById("StarProducer").style.display = "block";
    } else {
      document.getElementById("StarProducer").style.display = "none";
    }

    if (document.getElementById("doForegroundStars").checked) {
       document.getElementById("foregroundStars").style.display = "block";
    } else {
        document.getElementById("foregroundStars").style.display = "none";
    }

    if (document.getElementById("doBackgroundStars").checked) {
      document.getElementById("backgroundStars").style.display = "block";
    } else {
      document.getElementById("backgroundStars").style.display = "none";
    }

    if (document.getElementById("runTransitFluxModulator_star0").checked) {
      document.getElementById("TransitFluxModulator_star0").style.display = "block";
    } else {
      document.getElementById("TransitFluxModulator_star0").style.display = "none";
    }

    if (document.getElementById("runTransitFluxModulator_star1").checked) {
      document.getElementById("TransitFluxModulator_star1").style.display = "block";
    } else {
      document.getElementById("TransitFluxModulator_star1").style.display = "none";
    }

    if (document.getElementById("runTransitFluxModulator_star2").checked) {
      document.getElementById("TransitFluxModulator_star2").style.display = "block";
    } else {
      document.getElementById("TransitFluxModulator_star2").style.display = "none";
    }

    if (document.getElementById("runStellarNoiseFluxModulator_star0").checked) {
      document.getElementById("StellarNoiseFluxModulator_star0").style.display = "block";
    } else {
      document.getElementById("StellarNoiseFluxModulator_star0").style.display = "none";
    }

    if (document.getElementById("runStellarVariationFluxModulator_star0").checked) {
      document.getElementById("StellarVariationFluxModulator_star0").style.display = "block";
    } else {
      document.getElementById("StellarVariationFluxModulator_star0").style.display = "none";
    }

    if (document.getElementById("runUserFluxModifier_star0").checked) {
      document.getElementById("UserFluxModifier_star0").style.display = "block";
    } else {
      document.getElementById("UserFluxModifier_star0").style.display = "none";
    }
 
    if (document.getElementById("runJitterProducer").checked) {
      document.getElementById("JitterProducer").style.display = "block";
    } else {
      document.getElementById("JitterProducer").style.display = "none";
    }

    if (document.getElementById("runOrbitSimulator").checked) {
      document.getElementById("OrbitSimulator").style.display = "block";
    } else {
      document.getElementById("OrbitSimulator").style.display = "none";
    }

    if (document.getElementById("runFocalPlaneGenerator").checked) {
      document.getElementById("FocalPlaneGenerator").style.display = "block";
    } else {
      document.getElementById("FocalPlaneGenerator").style.display = "none";
    }

    if (document.getElementById("rotateFOV").checked) {
      document.getElementById("rotation").style.display = "block";
    } else {
      document.getElementById("rotation").style.display = "none";
    }

    if (document.getElementById("ccdTemperatureVariation").checked) {
      document.getElementById("ccdTemp").style.display = "block";
    } else {
      document.getElementById("ccdTemp").style.display = "none";
    }

    if (document.getElementById("feeTemperatureVariation").checked) {
      document.getElementById("feeTemp").style.display = "block";
    } else {
      document.getElementById("feeTemp").style.display = "none";
    }

    if (document.getElementById("telescopeTemperatureVariation").checked) {
      document.getElementById("telescopeTemp").style.display = "block";
    } else {
      document.getElementById("telescopeTemp").style.display = "none";
    }

    if (document.getElementById("runStrayLightGenerator").checked) {
      document.getElementById("StrayLightGenerator").style.display = "block";
    } else {
      document.getElementById("StrayLightGenerator").style.display = "none";
    }

    if (document.getElementById("runGlobalThroughputGenerator").checked) {
      document.getElementById("GlobalThroughputGenerator").style.display = "block";
    } else {
      document.getElementById("GlobalThroughputGenerator").style.display = "none";
    }

    if (document.getElementById("runPSFGenerator").checked) {
      document.getElementById("PSFGenerator").style.display = "block";
    } else {
      document.getElementById("PSFGenerator").style.display = "none";
    }
    
    if (document.getElementById("runHaloGenerator").checked) {
        document.getElementById("HaloGenerator").style.display = "block";
    } else {	
        document.getElementById("HaloGenerator").style.display = "none";
    }

    if (document.getElementById("runFlatFieldGenerator").checked) {
      document.getElementById("FlatFieldGenerator").style.display = "block";
    } else {
      document.getElementById("FlatFieldGenerator").style.display = "none";
    }

    if (document.getElementById("runFrameTransferSmearer").checked) {
      document.getElementById("FrameTransferSmearer").style.display = "block";
    } else {
      document.getElementById("FrameTransferSmearer").style.display = "none";
    }

    if (document.getElementById("runPhotonNoiseGenerator").checked) {
      document.getElementById("PhotonNoiseGenerator").style.display = "block";
    } else {
      document.getElementById("PhotonNoiseGenerator").style.display = "none";
    }

    if (document.getElementById("applyThroughput").checked) {
      document.getElementById("throughput").style.display = "block";
    } else {
      document.getElementById("throughput").style.display = "none";
    }

    if (document.getElementById("applyFlatField").checked) {
      document.getElementById("flatField").style.display = "block";
    } else {
      document.getElementById("flatField").style.display = "none";
    }

    if (document.getElementById("applyQE").checked) {
      document.getElementById("QE").style.display = "block";
    } else {
      document.getElementById("QE").style.display = "none";
    }

    if (document.getElementById("doDeadPixels").checked) {
      document.getElementById("DeadPixels").style.display = "block";
    } else {
      document.getElementById("DeadPixels").style.display = "none";
    }

    if (document.getElementById("runDarkCurrentGenerator").checked) {
      document.getElementById("DarkCurrentGenerator").style.display = "block";
    } else {
      document.getElementById("DarkCurrentGenerator").style.display = "none";
    }

    if (document.getElementById("includeReadoutTime").checked) {
      document.getElementById("readoutTime").style.display = "block";
    } else {
      document.getElementById("readoutTime").style.display = "none";
    }

    if (document.getElementById("doHotPixels").checked) {
      document.getElementById("HotPixels").style.display = "block";
    } else {
      document.getElementById("HotPixels").style.display = "none";
    }

    if (document.getElementById("doWarmPixels").checked) {
      document.getElementById("WarmPixels").style.display = "block";
    } else {
      document.getElementById("WarmPixels").style.display = "none";
    }

    if (document.getElementById("doTelegraphicPixels").checked) {
      document.getElementById("TelegraphicPixels").style.display = "block";
    } else {
      document.getElementById("TelegraphicPixels").style.display = "none";
    }

    if (document.getElementById("doManualHotPixels").checked) {
      document.getElementById("ManualHotPixels").style.display = "block";
    } else {
      document.getElementById("ManualHotPixels").style.display = "none";
    }

    if (document.getElementById("runCosmicRayGenerator").checked) {
      document.getElementById("CosmicRayGenerator").style.display = "block";
    } else {
      document.getElementById("CosmicRayGenerator").style.display = "none";
    }

    if (document.getElementById("runFullWellSimulator").checked) {
      document.getElementById("FullWellSimulator").style.display = "block";
    } else {
      document.getElementById("FullWellSimulator").style.display = "none";
    }
    if (document.getElementById("runChargeTransferSimulator").checked) {
      document.getElementById("ChargeTransferSimulator").style.display = "block";
    } else {
      document.getElementById("ChargeTransferSimulator").style.display = "none";
    }

    if (document.getElementById("runBiasGenerator").checked) {
      document.getElementById("BiasGenerator").style.display = "block";
    } else {
      document.getElementById("BiasGenerator").style.display = "none";
    }

    if (document.getElementById("doCcdNonLinearity").checked) {
      document.getElementById("ccdNonLinearity").style.display = "block";
    } else {
      document.getElementById("ccdNonLinearity").style.display = "none";
    }

    <!-- if (document.getElementById("applyAnalogChainRandomNoise").checked) { -->
    <!--   document.getElementById("analogChainRandomNoise").style.display = "block"; -->
    <!-- } else { -->
    <!--   document.getElementById("analogChainRandomNoise").style.display = "none"; -->
    <!-- } -->

    <!-- if (document.getElementById("doADCSaturation").checked) { -->
    <!--   document.getElementById("ADCSaturation").style.display = "block"; -->
    <!-- } else { -->
    <!--   document.getElementById("ADCSaturation").style.display = "none"; -->
    <!-- } -->

    if (document.getElementById("runImageWriter").checked) {
      document.getElementById("ImageWriter").style.display = "block";
    } else {
      document.getElementById("ImageWriter").style.display = "none";
    }

    if (document.getElementById("writeStackedImages").checked) {
      document.getElementById("stackedImages").style.display = "block";
    } else {
      document.getElementById("stackedImages").style.display = "none";
    }

    if (document.getElementById("writeImagettes").checked) {
      document.getElementById("imagette").style.display = "block";
    } else {
      document.getElementById("imagette").style.display = "none";
    }

    if (document.getElementById("extractLightCurve").checked) {
      document.getElementById("photometry").style.display = "block";
    } else {
      document.getElementById("photometry").style.display = "none";
    }

    if (document.getElementById("subtractBackground").checked) {
      document.getElementById("backgroundSubtraction").style.display = "block";
    } else {
      document.getElementById("backgroundSubtraction").style.display = "none";
    }

    if (document.getElementById("subtractFlatField").checked) {
      document.getElementById("flatFieldCorrection").style.display = "block";
    } else {
      document.getElementById("flatFieldCorrection").style.display = "none";
    }

}
</script>

<script language="JavaScript">
function isInteger(val) {
    var retval = false;
    var intRegex = /^\d+$/;
    if(intRegex.test(val)) retval = true;
    return retval;
}
</script>
<script language="JavaScript">
function isPosNegInteger(val) {
    var retval = false;
    var intRegex = /^(\+|-)?\d+$/;
    if(intRegex.test(val)) retval = true;
    return retval;
}
</script>
<script language="JavaScript">
function isFloat(val) {
    var retval = false;
    var floatRegex = /^\d+\.?\d*((\e|E)(\+|-)?\d+)?$/;
    if(floatRegex.test(val)) retval = true;
    return retval;
}
</script>
<script language="JavaScript">
function isPosNegFloat(val) {
    var retval = false;
    var floatRegex = /^(\+|-)?\d+\.?\d*((\e|E)(\+|-)?\d+)?$/;
    if(floatRegex.test(val)) retval = true;
    return retval;
}
</script>
<script language="JavaScript">
function checkInteger(el) {
    if(!isInteger(el.value)) {
      alert('Value must be a non-negative integer');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkFloat(el) {
    if(!isFloat(el.value)) {
      alert('Value must be a positive floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkPosNegFloat(el) {
    if(!isPosNegFloat(el.value)) {
      alert('Value must be a floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkNonZeroFloat(el) {
    if(!isFloat(el.value)) {
      alert('Value must be a positive floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else if(el.value<0.000000000001) {
      alert('Value cannot be zero');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkStartTime(el) {
    var format = /^\d{4}\-\d{2}\-\d{2}\ \d{2}\:\d{2}\:\d{2}\.?\d*?$/;
    if(!format.test(el.value)) {
      alert('Required format is YYYY-MM-DD HH:MM:SS[.SSS]');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
    if ((el.value.split("-")[0] < 2019 || el.value.split("-")[0] > 2022 || el.value.split("-")[0] == 2022 && el.value.split("-")[1] > 7) && document.getElementById("orbitFilename").value == "AUX_REF_Orbit_20181231_20220801_V0000") {
      alert('Warning: Default Orbit file from INTA is valid only for 2018-12-31 to 2022-08-01. Please change the start date or change the orbit file.');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkRA(el) {
    var format = /^\-?\+?\d{2}\:\d{2}\:\d{2}\.?\d*?$/;
    if(!format.test(el.value) && !isPosNegFloat(el.value)) {
      alert('Required format is [+/-]HH:MM:SS[.SSS] or a floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkDec(el) {
    var format = /^\-?\+?\d{2}\:\d{2}\:\d{2}\.?\d*?$/;
    if(!format.test(el.value) && !isPosNegFloat(el.value)) {
      alert('Required format is [+/-]DD:MM:SS[.SSS] or a floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkObsId(el) {
    if(!isInteger(el.value) && el.value!="") {
      alert('Value must be a non-negative integer');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="javascript">
function checkExposure() {
    var exposureTime = document.getElementById("exposureTime").value;
    var exposuresPerStack = document.getElementById("exposuresPerStack").value;
    var inRange = true;

    if (exposureTime<0 || exposureTime>600) {
      alert("Exposure duration must be between 1 and 600");
      document.getElementById("exposureTime").style.color = "red";
      document.getElementById("exposureTime").style.borderColor = "red";
      inRange = false;
    } else {
      document.getElementById("exposureTime").style.borderColor="";
      document.getElementById("exposureTime").style.color="";
    }

    if (inRange==true) {
      if (exposureTime*exposuresPerStack> 600) {
        alert("Product of exposure duration and number of exposures per stack cannot exceed 600 seconds");
        document.getElementById("exposuresPerStack").style.color = "red";
        document.getElementById("exposuresPerStack").style.borderColor = "red";
      } else {
        document.getElementById("exposuresPerStack").style.borderColor="";
        document.getElementById("exposuresPerStack").style.color="";
      }
    }

    if (exposureTime>60 && document.getElementById("jitterFilename").value != "48hrAOCSTimeseries2016_simu1_1s.fits") {
      alert("Warning: exposure time > 60 is not allowed for science observations (OK for M&C visits)");
      alert("Payload must not be in the loop for exposure time > 60. Setting jitter time series to 48hrAOCSTimeseries2016_simu1_1s.fits");
      document.getElementById("jitterFilename").value = "48hrAOCSTimeseries2016_simu1_1s.fits";
    } else if (exposureTime<=60 && document.getElementById("jitterFilename").value == "48hrAOCSTimeseries2016_simu1_1s.fits") {
      alert("Warning: Selected jitter time series (48hrAOCSTimeseries2016_simu1_1s.fits) corresponds to no payload in the loop.");
    }

}
</script>
<script language="javascript">
function checkRepetitionPeriod(el) {
    checkFloat(el);
    if (document.getElementById("exposureTime").value > 1. && !isInteger(el.value)) {
        alert("Warning: For exposure durations greater than 1 second, it is recommended to use an integer value for the repetition period, so that the image cadence is in sync with the 1 second cadence of the jitter. Otherwise additional noise may be introduced into the light curve.");
    }
}
</script>
<script language="JavaScript">
function checkStackedImages() {
    var el = document.getElementById("numberOfStackedImages");
    if(!isInteger(el.value) || el.value<1) {
      alert('Number of stacked images must be an integer with value greater than or equal to 1');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkMagnitude(el) {
    //if(!isFloat(el.value) || el.value<6.0 || el.value>12) {
    if(!isFloat(el.value)) {
      //alert('Magnitude of target star must be an integer or floating point number between 6.0 and 12.0');
      alert('Magnitude of target star must be an integer or floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkFirstTransitTime() {
    var el = document.getElementById("firstTransitTime");
    if(!isFloat(el.value)) {
      alert('Value must be a positive floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else if (el.value>1.) {
      alert("Warning: Transit midpoint will not occur during the simulated observation period");
      el.style.borderColor="orange";
      el.style.color="orange";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="JavaScript">
function checkImpactParameter() {
    var el = document.getElementById("impactParameter");
    var starRadius = document.getElementById("starRadius").value;
    var planetRadius = document.getElementById("planetRadius").value;
    var planetScale = document.getElementById("planetScale").value;
    if (planetScale == "Jupiter") {
      planetRadius *= 69911.;
    } else if (planetScale == "Neptune") {
      planetRadius *= 24622.;
    } else if (planetScale == "Earth") {
      planetRadius *= 6371.;
    }
    starRadius *= 696342.;
    if(!isFloat(el.value)) {
      alert('Value must be a positive floating point number');
      el.style.borderColor="red";
      el.style.color="red";
    } else if (el.value>(1.+planetRadius/starRadius)) {
      alert("Warning: there will be no transit with this impact parameter");
      el.style.borderColor="orange";
      el.style.color="orange";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>
<script language="javascript">
function checkSubarrayIndex(el) {
    if (!isPosNegInteger(el.value) || el.value<-428 || el.value>628) {
      alert('Value must be an integer in the range -428 to 628');
      el.style.borderColor="red";
      el.style.color="red";
    } else {
      el.style.borderColor="";
      el.style.color="";
    }
}
</script>

<script language="JavaScript">
function validateForm() {
    var valid = true;
    if (document.getElementById("fileRadio").checked) {
        var el = document.getElementById("nStars_subarray");
        if(!isInteger(el.value)) {
            el.style.borderColor="red";
            el.style.color="red";
            valid = false;
        } else {
            el.style.borderColor="";
            el.style.color="";
        }
    }
    var x = document.getElementById("CHEOPSimForm");
    for (var i = 0; i < x.length; i++) {
        if(x.elements[i].style.borderColor=="red") valid = false;
    }
    if (!valid) alert("There is at least one invalid entry in the form - please modify values marked red");

    if (document.getElementById("exposuresPerStack").value == "") {
        alert("Invalid value for number of exposures per stacked image");
        valid = false;
        document.getElementById("exposuresPerStack").style.borderColor="red";
        document.getElementById("exposuresPerStack").style.color="red";
    }

    if (document.getElementById("imagetteStackingOrder").value == "") {
        alert("Invalid value for imagetteStackingOrder");
        valid = false;
        document.getElementById("imagetteStackingOrder").style.borderColor="red";
        document.getElementById("imagetteStackingOrder").style.color="red";
    }

    if ((document.getElementById("fullFrameRadio").checked || (document.getElementById("subArrayXDim").value==1024 && document.getElementById("subArrayYDim").value==1024)) &&  document.getElementById("exposuresPerStack").value!=1) {
        alert("Full frame images cannot be stacked. Either set the number of exposures per stacked image to 1 (Visit tab) or reduce the sub-array dimensions in FocalPlaneGenerator (Detector tab)");
        valid = false;
    }

    var xoff = parseInt(document.getElementById("subArrayXOffset").value);
    var yoff = parseInt(document.getElementById("subArrayYOffset").value);
    var xdim = parseInt(document.getElementById("subArrayXDim").value);
    var ydim = parseInt(document.getElementById("subArrayYDim").value);
    if (xoff+xdim>1024 || xoff+xdim>1024) {
        alert("Error in FocalPlaneGenerator: the sub-array cannot extend outside the exposure part of the CCD.");
        valid = false;
    }

    var specType = document.getElementById("star0_SpecType").value;
    if (document.getElementById("fileRadio").checked) {
      specType = document.getElementById("star0_SpecType_file").value;
    }
    if ((specType.charAt(0)=="B"|| specType.charAt(0)=="O") &&
        (document.getElementById("runStellarNoiseFluxModulator_star0").checked || document.getElementById("runStellarVariationFluxModulator_star0").checked)) {
        valid = false;
        alert("Cannot run StellarNoiseFluxModulator or StellarVariationFluxModulator for B and O type stars because the model does not apply since these have radiative rather than convective envelopes. Please ensure that these modules are disabled in the Stellar Flux tab, or use a different spectral type.");
    }

    if (!checkSolarAvoidanceZone()) {
        valid = false;
        alert("Pointing direction is within the solar avoidance zone on the specified simulation start date. Please use a different start date or pointing direction.");
    }

    if (!document.getElementById("runOrbitSimulator").checked && document.getElementById("thermalMap").value=="breathing") {
        valid = false;
        alert("OrbitSimulator must be switched on when PSF thermal map is set to breathing");
    }

    if (document.getElementById("whitePSF_filename").value.includes("CCDLocation") && document.getElementById("thermalMap").value!="fixed") {
        valid = false;
        alert("PSF thermal map must be fixed for REF_APP_WhiteCCDLocationPSF");
    }

    if (document.getElementById("obsId").value=="" &&
        document.getElementById("visitFile").files.length &&
        document.getElementById("visitFile").value.endsWith('.fits')) {
        alert("MPS_PRE_Visits file has been uploaded in Visit Configuration but Observation ID has not been specified");
        valid = false;
        document.getElementById("obsId").style.borderColor="red";
        document.getElementById("obsId").style.color="red";
    }

    if (document.getElementById("runStarProducer").checked && 
        document.getElementById("doForegroundStars").checked &&
        document.getElementById("fileRadio").checked &&
        !document.getElementById("starFile").files.length) {
        alert("Star file has not been uploaded in StarProducer");
        valid = false;
    }

    if (document.getElementById("runUserFluxModifier_star0").checked &&
        !document.getElementById("userFluxUploadFile").files.length) {
        alert("Flux time series file has not been uploaded in UserFluxModifier");
        valid = false;
    }

    if (document.getElementById("runJitterProducer").checked &&
        document.getElementById("jitterUploadRadio").checked &&
        !document.getElementById("jitterUploadFile").files.length) {
        alert("Jitter file has not been uploaded in JitterProducer");
        valid = false;
    }

    if (document.getElementById("runStrayLightGenerator").checked &&
        document.getElementById("strayLightUploadRadio").checked &&
        !document.getElementById("strayLightUploadFile").files.length) {
        alert("Stray light file has not been uploaded in StrayLightProducer");
        valid = false;
    }

    if (document.getElementById("runGlobalThroughputGenerator").checked &&
        document.getElementById("applyThroughput").checked &&
        document.getElementById("throughputUploadRadio").checked &&
        !document.getElementById("throughputUploadFile").files.length) {
        alert("Optical throughput file has not been uploaded in GlobalThroughputGenerator");
        valid = false;
    }

    if (document.getElementById("runGlobalThroughputGenerator").checked &&
        document.getElementById("applyQE").checked &&
        document.getElementById("qeUploadRadio").checked &&
        !document.getElementById("qeUploadFile").files.length) {
        alert("Quantum Efficiency file has not been uploaded in GlobalThroughputGenerator");
        valid = false;
    }

    for (i = 0; i < 3; i++) { 
        if (document.getElementById("runTransitFluxModulator_star"+i).checked) {
            if (document.getElementById("planetScale_star"+i).value == "") alert("Invalid value for parameter planetScale_star"+i);
            if (document.getElementById("orbitUnits_star"+i).value == "") alert("Invalid value for parameter orbitUnits_star"+i);
        }
    }
    if (document.getElementById("runJitterProducer").checked && document.getElementById("jitterFilename").value == "") {
        alert("Invalid value for parameter jitterFilename");
        valid = false;
    }
    if (document.getElementById("runOrbitSimulator").checked) {
        if (document.getElementById("telescopeTemperatureVariation").checked &&
            document.getElementById("telescopeTemperatureFileRadio").checked  &&
            document.getElementById("telescopeTemperatureFilename").value == "") {
            alert("Invalid value for parameter telescopeTemperatureFilename");
            valid = false;
        }
        if (document.getElementById("orbitFilename").value == "") {
            alert("Invalid value for parameter orbitFilename");
            valid = false;
        }
    }
    if (document.getElementById("runStrayLightGenerator").checked && document.getElementById("strayLightFile").value == "") {
        alert("Invalid value for parameter strayLightFile");
        valid = false;
    }
    if (document.getElementById("runPSFGenerator").checked) {
        if (document.getElementById("whitePSFradio").checked && document.getElementById("whitePSF_filename").value == "") {
            alert("Invalid value for parameter PSF_filename");
            valid = false;
        }
        if (document.getElementById("monochromaticPSFradio").checked && document.getElementById("monochromaticPSF_filename").value == "") {
            alert("Invalid value for parameter PSF_filename");
            valid = false;
        }
        if (document.getElementById("thermalMap").value == "") {
            alert("Invalid value for parameter thermalMap");
            valid = false;
        }
        if (document.getElementById("targetStarPositioning").value == "") {
            alert("Invalid value for parameter targetStarPositioning");
            valid = false;
        }
        if (document.getElementById("backgroundStarPositioning").value == "") {
            alert("Invalid value for parameter backgroundStarPositioning");
            valid = false;
        }
    }
    if (document.getElementById("runGlobalThroughputGenerator").checked) {
        if (document.getElementById("applyThroughput").checked && document.getElementById("throughputFilename").value == "") {
            alert("Invalid value for parameter throughputFilename");
            valid = false;
        }
        if (document.getElementById("applyQE").checked && document.getElementById("QEFilename").value == "") {
            alert("Invalid value for parameter QEFilename");
            valid = false;
        }
    }
    if (document.getElementById("runFlatFieldGenerator").checked && document.getElementById("flatFieldFileRadio").checked && document.getElementById("flatFieldFilename").value == "") {
        alert("The flat field filename does not match any of those included in the release. Please select a valid option or upload a file in FlatFieldGenerator");
        valid = false;
    }
    if (document.getElementById("runDarkCurrentGenerator").checked && document.getElementById("darkFrameRadio").checked && document.getElementById("darkFrameFilename").value == "") {
        alert("Invalid value for parameter darkFrameFilename");
        valid = false;
    }
    if (document.getElementById("runBiasGenerator").checked) {
        if (document.getElementById("biasFrameRadio").checked && document.getElementById("biasFrameFilename").value == "") {
            alert("Invalid value for parameter biasFrameFilename");
            valid = false;
        }
        if (document.getElementById("gainCorrectionFilename").value == "") {
            alert("Invalid value for parameter gainCorrectionFilename");
            valid = false;
        }
        if (document.getElementById("doCcdNonLinearity").checked && document.getElementById("ccdNonLinearityFilename").value == "") {
            alert("Invalid value for parameter ccdNonLinearityFilename")
            valid = false;
        }
    }

    if (document.getElementById("extractLightCurve").checked && !document.getElementById("writeTruthData").checked) {
        alert("Photometry module requires truth data to be written: please select Write truth information in Output tab or switch off Photometry");
        valid = false;
    }

    return valid;

}

function checkSolarAvoidanceZone() {

    //if (!document.getElementById("runZodiacalLightGenerator").checked) return true;

    var date = new Date(document.getElementById("startTime").value);
    var julianDate = Math.floor((date.valueOf() / (1000 * 3600 * 24)) - 0.5) + 2440588;
    julianDate += date.getHours()/24.;

    var T = (julianDate - 2451545.0) / 36525.;

    //Geometric mean longitude of the Sun, referred to the mean equinox of the date:
    var L0 = 280.46645 + 36000.76983*T + 0.0003032*Math.pow(T,2);
    L0 = setRange0to360(L0);

    //Mean anomaly of the Sun:
    var M = 357.52910 + 35999.05030*T - 0.0001559*Math.pow(T,2) - 0.00000048*Math.pow(T,3);
    M = setRange0to360(M);

    //Sun's equation of center:
    var C = (1.914600 - 0.004817*T - 0.000014*Math.pow(T,2)) * sind(M) + (0.01993 - 0.000101*T) * sind(2.*M) + 0.000290 * sind(3.*M);

    //Ecliptic longitude of the Sun:
    var sunEclipticLong = L0 + C;
    sunEclipticLong = setRange0to360(sunEclipticLong);

    var ra_in = document.getElementById("pointingRA").value;
    var dec_in = document.getElementById("pointingDec").value;

    if (ra_in=="As target star") {
      if (document.getElementById("fileRadio").checked) {
        return true; //Cannot read target star position from EXT_PRE_StarCatalog
      } else {
        ra_in = document.getElementById("star0_RA").value;
        dec_in = document.getElementById("star0_Dec").value;
      }
    }

    var ra = convertToDegrees(ra_in,true);
    var dec = convertToDegrees(dec_in,false);

    var pointingEclipticLong = eclipticLongitude(ra,dec);
    var pointingEclipticLat = eclipticLatitude(ra,dec);
    //console.log(sunEclipticLong,pointingEclipticLong,pointingEclipticLat);

    var deltaLong = Math.abs(pointingEclipticLong - sunEclipticLong);
    if (deltaLong>180.) deltaLong = 360.-deltaLong;
    var deltaLat = Math.abs(pointingEclipticLat);

    var separationFromSun = Math.sqrt(Math.pow(deltaLong,2)+Math.pow(deltaLat,2));
    //console.log(deltaLong,deltaLat,separationFromSun);

    if (separationFromSun < 120.) return false;
    return true;

}

function eclipticLatitude(ra,dec) {
    //Formula from https://books.google.co.uk/books?id=DwJfCtzaVvYC&printsec=frontcover#v=onepage&q&f=false p.42
    //("Practical Astronomy With Your Calculator" by Peter Duffett-Smith)
    //Checked using https://ned.ipac.caltech.edu/forms/calculator.html
    var eclipticObliquity = 23.4392911;
    var epsilon_rads = eclipticObliquity * Math.PI/180.;
    var ra_rads = ra * Math.PI/180.;
    var dec_rads = dec * Math.PI/180.;
    return Math.asin(Math.sin(dec_rads)*Math.cos(epsilon_rads) - Math.cos(dec_rads)*Math.sin(epsilon_rads)*Math.sin(ra_rads)) * 180./Math.PI;
}

function eclipticLongitude(ra,dec) {
    //Formula from https://books.google.co.uk/books?id=DwJfCtzaVvYC&printsec=frontcover#v=onepage&q&f=false p.42
    //("Practical Astronomy With Your Calculator" by Peter Duffett-Smith)
    //Checked using https://ned.ipac.caltech.edu/forms/calculator.html
    var eclipticObliquity = 23.4392911;
    var epsilon_rads = eclipticObliquity * Math.PI/180.;
    var ra_rads = ra * Math.PI/180.;
    var dec_rads = dec * Math.PI/180.;
    var eclipticLongitude = Math.atan2(Math.sin(ra_rads)*Math.cos(epsilon_rads)+Math.tan(dec_rads)*Math.sin(epsilon_rads),Math.cos(ra_rads)) * 180/Math.PI;
    setRange0to360(eclipticLongitude);
    return eclipticLongitude;
}

function convertToDegrees(degreesMinsSecs,isRA) {
    if (degreesMinsSecs.search(":") == -1) {
        //already in decimal format
        return degreesMinsSecs;
    } else {
        var substrings = degreesMinsSecs.split(":")
        var degrees = parseInt(substrings[0]);
        var minutes = parseInt(substrings[1]);
        var seconds = parseFloat(substrings[2]);
        var return_value = Math.abs(degrees)+minutes/60.+seconds/3600.;
        if (isRA) return_value*=15.;
        if (degreesMinsSecs.substr(0,1)=="-") return_value *= -1.;
        //console.log(degreesMinsSecs,degrees,minutes,seconds,return_value);
        return return_value;
    }
}

function setRange0to360(angle) {
    if (angle > 360.) {
        angle -= 360.*(Math.floor(angle/360.));
    } else if (angle < 0.) {
        angle += 360.*(Math.ceil(-angle/360.));
    }
    return angle;
}

function sind(angle) {
    return Math.sin(angle * Math.PI/180.);
}
</script>

</head>

<body bgcolor="#E6E6FA" onload="updateStars();setPSFDropDown();displayManualHot();displayManualStars();setSAAMap();setOversampling()" onpageshow="showHide()">

<form action="CHEOPSimForm" id="CHEOPSimForm" method="post" enctype="multipart/form-data" autocomplete="on" onsubmit="return validateForm()">

<script language="JavaScript">
    document.writeln("<input name='version' id='version' type='hidden' value='"+version+"'>");
    document.writeln("<input name='webrelease' id='webrelease' type='hidden' value='"+webrelease+"'>");
</script>
  
<center>
<img src="CHEOPS_logo.png"><img src="cheops.png" width="100">
<br><br><font size="6">CHEOPSim Configuration</font><br><br>
<!--<font color="green" size="3">Recommended browsers (for form data caching): Chrome, Safari</font><br><br>-->

<p>This web interface can be used to generate a configuration file for running the CHEOPSim simulator.
<p>The <img src="information.gif" width="12"> buttons link to the relevant sections of the <a href="UserManual/CHEOPSim_UserManual.html" target="_CHEOPSimUserManual">CHEOPSim User Guide</a> via a new browser tab. 
</center>

<br><br>
<center>
<style type="text/css">
.myTable3 { background-color:#CED8F6;border-collapse:collapse;text-align:center;border:1px solid #000;width:750px; }
.myTable3 th { background-color:#A9BCF5;border:1px solid #000;}
.myTable3 td, .myTable th { padding:6px }
</style>
<table class="myTable3">
  <tr>
    <td>
      <!--<input TYPE="Button" name="xmlImport" value="Import data from existing configuration xml file" onClick="importXml()">-->
      Optionally import data from a pre-existing configuration xml file:</td><td><input type="file" id="xmlFile" />
    </td>
    <td><input type="button" id="xmlUpload" value="Import" /></td>
  </tr>
</table>
</center>

<script type="text/javascript">
$(function () {
    $("#xmlUpload").bind("click", function () {
        var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xml)$/;
        if (regex.test($("#xmlFile").val().toLowerCase())) {
            if (typeof (FileReader) != "undefined") {
                var reader = new FileReader();
                reader.onload = function (e) {
                    var xmlDoc = $.parseXML(e.target.result);

                    var filesToUpload = "";

                    var modulesToRun="";
                    $.each($(xmlDoc).find('param'), function () {
                        if ($(this).find('name').text() == 'MPSFilename') {
                            var visitFilename = $(this).find('value').text();
                            if (visitFilename.endsWith(".fits")) {
                                filesToUpload += "Visit Configuration \t MPS_PRE_Visits file\n";
                            } else if (visitFilename.endsWith(".xml")) {
                                filesToUpload += "Visit Configuration \t Observation Request xml file\n";
                            }
                        }
                        if ($(this).find('name').text() == 'programType') document.getElementById("programType").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'piName') document.getElementById("piName").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'piUid') document.getElementById("piUid").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'startTime') document.getElementById("startTime").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'numberOfStackedImages') document.getElementById("numberOfStackedImages").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'exposuresPerStack') document.getElementById("exposuresPerStack").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'exposureTime') document.getElementById("exposureTime").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'repetitionPeriod') document.getElementById("repetitionPeriod").value = $(this).find('value').text();
                        if (document.getElementById("repetitionPeriod").value>0.) {
                            document.getElementById("repetitionPeriodMethod").value = "manual"
                            document.getElementById("repetitionPeriodTR").style.display = "table-row"
                        }
                        if ($(this).find('name').text() == 'maxImagesPerCube') document.getElementById("maxImagesPerCube").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'doFullFrame') document.getElementById("doFullFrame").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'pointingRA') {
                            var ra = $(this).find('value').text()
                            document.getElementById("pointingRA").value = ra;
                            if (ra != "As target star") document.getElementById("hiddenPointingRA").value = ra;
                        }
                        if ($(this).find('name').text() == 'pointingDec') {
                            var dec = $(this).find('value').text()
                            document.getElementById("pointingDec").value = dec;
                            if (dec != "As target star") document.getElementById("hiddenPointingDec").value = dec;
                        }
                        if ($(this).find('name').text() == 'obsId') document.getElementById("obsId").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'applyThroughput') document.getElementById("applyThroughput").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'throughputFilename') {
                            var throughputFilename = $(this).find('value').text();
                            if (throughputFilename.split('.').pop()=="fits") {
                                document.getElementById("throughputFilename").value = throughputFilename;
                                setThroughputSelectRadio();
                            } else {
                                if (document.getElementById("applyThroughput").checked) filesToUpload += "GlobalThroughput \t QE versus wavelength\n";
                                setThroughputUploadRadio();
                            }
                        }
                        if ($(this).find('name').text() == 'applyQE') document.getElementById("applyQE").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'QEFilename') {
                            var qeFilename = $(this).find('value').text();
                            if (qeFilename.split('.').pop()=="fits") {
                                document.getElementById("QEFilename").value = qeFilename;
                                setQESelectRadio();
                            } else {
                                if (document.getElementById("applyQE").checked) filesToUpload += "GlobalThroughput \t Optical throughput versus wavelength\n";
                                setQEUploadRadio();
                            }
                        }
                        if ($(this).find('name').text() == 'SEDFilename') {
                            var sedFilename = $(this).find('value').text(); 
                            if (!(sedFilename.split('.').pop()=="fits")) sedFilename = "black body";
                            document.getElementById("sedFilename").value = sedFilename; 
                        }
                        if ($(this).find('name').text() == 'targetSEDFilename') {
                            if ($(this).find('value').text() != "") filesToUpload += "StarProducer \t\t Spectral Energy Distribution file\n";
                        }
                        if ($(this).find('name').text() == 'gainCorrectionFilename') document.getElementById("gainCorrectionFilename").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'radius_bkgInner') document.getElementById("radius_bkgInner").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'radius_bkgOuter') document.getElementById("radius_bkgOuter").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'radius_psf') document.getElementById("radius_psf").value = $(this).find('value').text();
                        if ($(this).find('name').text() == 'subtractBackground') document.getElementById("subtractBackground").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'modulesToRun') modulesToRun = $(this).find('value').text();
                        if ($(this).find('name').text() == 'redundantHardware') document.getElementById("readoutHardware").value = ($(this).find('value').text()=="true") ? "redundant" : "main";
                    });

                    if (modulesToRun.indexOf("StarProducer")!=-1) {
                        document.getElementById("runStarProducer").checked = true;
                        var starFilename = "";
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'starFilename') starFilename = $(this).find('value').text();
                            if ($(this).find('name').text() == 'gaiaBand') document.getElementById("passband").value = ($(this).find('value').text()=="true") ? "GaiaBand" : "Vband";
                            if ($(this).find('name').text() == 'targetMagnitude') document.getElementById("targetMagnitude").value = $(this).find('value').text(); 
                            if ($(this).find('name').text() == 'minMagnitude') document.getElementById("minMagnitude").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'useTargetStarForPointing') document.getElementById("useTargetStarForPointing").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'doBackgroundStars') document.getElementById("doBackgroundStars").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'fieldCrowding') document.getElementById("fieldCrowding").value = $(this).find('value').text();
                         });
                        setFileRadio();
                        //filesToUpload += "StarProducer \t\t\t List of stars (EXT_PRE_StarCatalogue or ascii)\n";
                        alert("NOTE: The list of stars is not defined in the xml file and must be separately defined in the StarProducer module");
                    } else {
                        document.getElementById("runStarProducer").checked = false;
                    }

                    for (i = 0; i < 3; i++) { 
                        if (modulesToRun.indexOf("TransitFluxModulator_star"+i)!=-1) {
                            document.getElementById("runTransitFluxModulator_star"+i).checked = true;
                            $.each($(xmlDoc).find('param'), function () {
                                if ($(this).find('name').text() == 'firstTransitTime') document.getElementById("firstTransitTime_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'planetRadius') document.getElementById("planetRadius_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'planetScale') document.getElementById("planetScale_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'orbitPeriod') document.getElementById("orbitPeriod_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'orbitUnits') document.getElementById("orbitUnits_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'impactParameter') document.getElementById("impactParameter_star"+i).value = $(this).find('value').text();
                                if ($(this).find('name').text() == 'doLimbDarkening') document.getElementById("doLimbDarkening_star"+i).checked = ($(this).find('value').text()=="true") ? true : false;
                            });
                            if (document.getElementById("planetScale_star"+i).value == "") alert("Invalid value for parameter planetScale_star"+i);
                            if (document.getElementById("orbitUnits_star"+i).value == "") alert("Invalid value for parameter orbitUnits_star"+i);
                        } else {
                            document.getElementById("runTransitFluxModulator_star"+i).checked = false;
                        }
                    }

                    if (modulesToRun.indexOf("StellarNoiseFluxModulator_star0")!=-1) {
                        document.getElementById("runStellarNoiseFluxModulator_star0").checked = true;
                    } else {
                        document.getElementById("runStellarNoiseFluxModulator_star0").checked = false;
                    }

                    if (modulesToRun.indexOf("StellarVariationFluxModulator_star0")!=-1) {
                        document.getElementById("runStellarVariationFluxModulator_star0").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'rotationPeriod') document.getElementById("rotationPeriod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'stellarVariationSeed') document.getElementById("stellarVariationSeed").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runStellarVariationFluxModulator_star0").checked = false;
                    }

                    if (modulesToRun.indexOf("UserFluxModifier_star0")!=-1) {
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'userFluxFilename') filesToUpload += "UserFluxModifier \t\t Flux time series for taget star\n";
                        });
                        document.getElementById("runUserFluxModifier_star0").checked = true;
                    } else {
                        document.getElementById("runUserFluxModifier_star0").checked = false;
                    }

                    if (modulesToRun.indexOf("JitterProducer")!=-1) {
                        document.getElementById("runJitterProducer").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'jitterFilename') {
                                var jitterFilename = $(this).find('value').text();
                                if (jitterFilename.split('.').pop()=="fits") {
                                    document.getElementById("jitterFilename").value = jitterFilename;
                                    setJitterSelectRadio();
                                } else {
                                    filesToUpload += "JitterProducer \t\t Jitter time series\n";
                                    setJitterUploadRadio();
                                }
                            }
                            if ($(this).find('name').text() == 'jitterFileOffset') document.getElementById("jitterFileOffset").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'jitterScale') document.getElementById("jitterScale").value = $(this).find('value').text();
                        });
                        if (document.getElementById("jitterFilename").value == "") alert("Invalid value for parameter jitterFilename");
                    } else {
                        document.getElementById("runJitterProducer").checked = false;
                    }

                    if (modulesToRun.indexOf("OrbitSimulator")!=-1) {
                        document.getElementById("runOrbitSimulator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'ccdTemperatureVariation') document.getElementById("ccdTemperatureVariation").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'ccdMeanTemperature') document.getElementById("ccdMeanTemperature").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'ccdTemperatureAmplitude') document.getElementById("ccdTemperatureAmplitude").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'ccdTemperaturePeriod') document.getElementById("ccdTemperaturePeriod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'feeTemperatureVariation') document.getElementById("feeTemperatureVariation").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'feeMeanTemperature') document.getElementById("feeMeanTemperature").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'feeTemperatureAmplitude') document.getElementById("feeTemperatureAmplitude").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'feeTemperaturePeriod') document.getElementById("feeTemperaturePeriod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telescopeTemperatureVariation') document.getElementById("telescopeTemperatureVariation").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'telescopeMeanTemperature') document.getElementById("telescopeMeanTemperature").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telescopeTemperatureAmplitude') document.getElementById("telescopeTemperatureAmplitude").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telescopeTemperaturePeriod') document.getElementById("telescopeTemperaturePeriod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telescopeTemperatureFromFile') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("telescopeTemperatureFileRadio").checked = true;
                                } else {
                                    document.getElementById("telescopeTemperatureSinusoidRadio").checked = true;
                                }
                            }
                            if ($(this).find('name').text() == 'telescopeTemperatureFilename') document.getElementById("telescopeTemperatureFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'saaFlagFromVisitConstraints') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("saaFlagFromVisitConstraints").checked = true;
                                    document.getElementById("saaFlagFromVisitConstraints").disabled = false;
                                }
                            }
                            if ($(this).find('name').text() == 'rotateFOV') document.getElementById("rotateFOV").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'orbitFilename') {
                                var orbitFilename = $(this).find('value').text(); 
                                if (orbitFilename == "UserOrbit.fits") {
                                    filesToUpload += "OrbitProducer \t\t Orbit time series\n";
                                    setOrbitUploadRadio();
                                } else {
                                    document.getElementById("orbitFilename").value = orbitFilename;
                                    setOrbitSelectRadio();
                                }
                            }
                            if ($(this).find('name').text() == 'minAngleToOrbitalPlane') document.getElementById("minAngleToOrbitalPlane").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'attitudeCadence') document.getElementById("attitudeCadence").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'orbitCadence') document.getElementById("orbitCadence").value = $(this).find('value').text();
                        });
                        if (document.getElementById("telescopeTemperatureVariation").checked &&
                            document.getElementById("telescopeTemperatureFileRadio").checked  &&
                            document.getElementById("telescopeTemperatureFilename").value == "") alert("Invalid value for parameter telescopeTemperatureFilename");
                        if (document.getElementById("orbitFilename").value == "") alert("Invalid value for parameter orbitFilename");
                    } else {
                        document.getElementById("runOrbitSimulator").checked = false;
                    }

                    if (modulesToRun.indexOf("FocalPlaneGenerator")!=-1) {
                        document.getElementById("runFocalPlaneGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'subArrayXDim') document.getElementById("subArrayXDim").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'subArrayYDim') document.getElementById("subArrayYDim").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'subArrayXOffset') document.getElementById("subArrayXOffset").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'subArrayYOffset') document.getElementById("subArrayYOffset").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetLocationX') document.getElementById("targetLocationX").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetLocationY') document.getElementById("targetLocationY").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetLocationListX') document.getElementById("targetLocationListX").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetLocationListY') document.getElementById("targetLocationListY").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runFocalPlaneGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("ZodiacalLightGenerator")!=-1) {
                        document.getElementById("runZodiacalLightGenerator").checked = true;
                    } else {
                        document.getElementById("runZodiacalLightGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("StrayLightGenerator")!=-1) {
                        document.getElementById("runStrayLightGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'strayLightThreshold') document.getElementById("strayLightThreshold").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'strayLightFile') {
                                var strayLightFile = $(this).find('value').text();
                                if (strayLightFile.split('.').pop()=="fits") {
                                    if (strayLightFile.includes("MPS_PRE_Visits")) {
                                        setStrayLightMpsRadio();
                                    } else {
                                        document.getElementById("strayLightFile").value = strayLightFile;
                                        setStrayLightSelectRadio();
                                    };
                                } else {
                                    filesToUpload += "StrayLightGenerator \t Stray light time series\n";
                                    setStrayLightUploadRadio();
                                }
                            }
                        });
                        if (document.getElementById("strayLightFile").value == "") alert("Invalid value for parameter strayLightFile");
                    } else {
                        document.getElementById("runStrayLightGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("HaloGenerator")!=-1) {
                        document.getElementById("runHaloGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'doGhosts') document.getElementById("doGhosts").checked = ($(this).find('value').text()=="true") ? true : false;
                        });
                    } else {
                        document.getElementById("runHaloGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("PSFGenerator")!=-1) {
                        document.getElementById("runPSFGenerator").checked = true;
                        var monochromatic = false;
                        var PSF_filename = "";
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'PSF_filename') PSF_filename = $(this).find('value').text();
                            if ($(this).find('name').text() == 'monochromaticPSF') {
                                var val = $(this).find('value').text();
                                if (val=="true") {
                                    document.getElementById("monochromaticPSFradio").checked = true;
                                    document.getElementById("monochromaticPSF_filename").value = PSF_filename;
                                    monochromatic = true;
                                    setMonochromaticPSFradio();
                                } else {
                                    document.getElementById("whitePSFradio").checked = true;
                                    document.getElementById("whitePSF_filename").value = PSF_filename;
                                    setWhitePSFradio();
                                }
                            }
                            if (monochromatic && $(this).find('name').text() == 'monochromaticPSFwavelength') {
                                var val = $(this).find('value').text();
                                if (val==0) {
                                    document.getElementById("monoPSFblackbodyRadio").checked = true;
                                } else {
                                    document.getElementById("monoPSFsingleWavelengthRadio").checked = true;
                                    document.getElementById("monoPSFwavelength").value = val;
                                }
                            }
                            if ($(this).find('name').text() == 'thermalMap') document.getElementById("thermalMap").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'oversampleJitter') document.getElementById("oversampleJitter").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetStarPositioning') document.getElementById("targetStarPositioning").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'backgroundStarPositioning') document.getElementById("backgroundStarPositioning").value = $(this).find('value').text();
                        });
                        if (document.getElementById("whitePSFradio").checked && document.getElementById("whitePSF_filename").value == "") alert("Invalid value for parameter PSF_filename");
                        if (document.getElementById("monochromaticPSFradio").checked && document.getElementById("monochromaticPSF_filename").value == "") alert("Invalid value for parameter PSF_filename");
                        if (document.getElementById("thermalMap").value == "") alert("Invalid value for parameter thermalMap");
                        if (document.getElementById("targetStarPositioning").value == "") alert("Invalid value for parameter targetStarPositioning");
                        if (document.getElementById("backgroundStarPositioning").value == "") alert("Invalid value for parameter backgroundStarPositioning");
                    } else {
                        document.getElementById("runPSFGenerator").checked = false;
                    }


                    if (modulesToRun.indexOf("GlobalThroughputGenerator")!=-1) {
                        document.getElementById("runGlobalThroughputGenerator").checked = true;
                        if (document.getElementById("applyThroughput").checked && document.getElementById("throughputFilename").value == "") alert("Invalid value for parameter throughputFilename");
                        if (document.getElementById("applyQE").checked && document.getElementById("QEFilename").value == "") alert("Invalid value for parameter QEFilename");
                    } else {
                        document.getElementById("runGlobalThroughputGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("FlatFieldGenerator")!=-1) {
                        document.getElementById("runFlatFieldGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'applyFlatField') document.getElementById("applyFlatField").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'gaussianFlatField') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("flatFieldGaussianRadio").checked = true;
                                } else {
                                    document.getElementById("flatFieldFileRadio").checked = true;
                                }
                            }
                            if ($(this).find('name').text() == 'flatFieldFilename') document.getElementById("flatFieldFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldToSubtractFilename') document.getElementById("flatFieldToSubtractFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldSeed') document.getElementById("flatFieldSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldScaleFactor') document.getElementById("flatFieldScaleFactor").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldSigma') document.getElementById("flatFieldSigma").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldTeffOffset') document.getElementById("flatFieldTeffOffset").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'flatFieldSmearSigma') document.getElementById("flatFieldSmearSigma").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'doDeadPixels') document.getElementById("doDeadPixels").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'deadPixelPositionSeed') document.getElementById("deadPixelPositionSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'fracDeadPixels') document.getElementById("fracDeadPixels").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'deadPixelRelativeQE') document.getElementById("deadPixelRelativeQE").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'writeTruthFlatField') document.getElementById("writeTruthFlatField").checked = ($(this).find('value').text()=="true") ? true : false;
                        });
                        if (document.getElementById("flatFieldFileRadio").checked && document.getElementById("flatFieldFilename").value == "") alert("The flat field filename does not match any of those included in the release. Please select a valid option or upload a file in FlatFieldGenerator");
                    } else {
                        document.getElementById("runFlatFieldGenerator").checked = false;
                    }

                    var manualHotPixelX_str="";
                    var manualHotPixelY_str="";
                    var manualHotPixelRate_str="";
                    var manualHotPixelIsTelegraphic_str="";
                    if (modulesToRun.indexOf("DarkCurrentGenerator")!=-1) {
                        document.getElementById("runDarkCurrentGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                           if ($(this).find('name').text() == 'empiricalDarkFrame') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("darkFrameRadio").checked = true;
                                } else {
                                    document.getElementById("flatDarkCurrentRadio").checked = true;
                                }
                            }
                            if ($(this).find('name').text() == 'darkFrameFilename') document.getElementById("darkFrameFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'darkFrameScaleFactor') document.getElementById("darkFrameScaleFactor").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'meanDarkCurrent233K') document.getElementById("meanDarkCurrent233K").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'includeReadoutTime') document.getElementById("includeReadoutTime").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'rowDownShiftTime') document.getElementById("rowDownShiftTime").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'serialReadRate') document.getElementById("serialReadRate").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'doHotPixels') document.getElementById("doHotPixels").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'hotPixelPositionSeed') document.getElementById("hotPixelPositionSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'fracHotPixels') document.getElementById("fracHotPixels").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'hotPixelRelativeDarkCurrent') document.getElementById("hotPixelRelativeDarkCurrent").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'doWarmPixels') document.getElementById("doWarmPixels").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'warmPixelPositionSeed') document.getElementById("warmPixelPositionSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'fracWarmPixels') document.getElementById("fracWarmPixels").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'warmPixelRelativeDarkCurrent') document.getElementById("warmPixelRelativeDarkCurrent").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'doTelegraphicPixels') document.getElementById("doTelegraphicPixels").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'telegraphicPixelPositionSeed') document.getElementById("telegraphicPixelPositionSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'fracTelegraphicPixels') document.getElementById("fracTelegraphicPixels").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telegraphicPixelRelativeDarkCurrent') document.getElementById("telegraphicPixelRelativeDarkCurrent").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telegraphicTimeConstant') document.getElementById("telegraphicTimeConstant").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'telegraphicTransitionSeed') document.getElementById("telegraphicTransitionSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'doManualHotPixels') document.getElementById("doManualHotPixels").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'manualHotPixelX') manualHotPixelX_str = $(this).find('value').text();
                            if ($(this).find('name').text() == 'manualHotPixelY') manualHotPixelY_str = $(this).find('value').text();
                            if ($(this).find('name').text() == 'manualHotPixelRate') manualHotPixelRate_str = $(this).find('value').text();
                            if ($(this).find('name').text() == 'manualHotPixelIsTelegraphic') manualHotPixelIsTelegraphic_str = $(this).find('value').text();
                        });
                        if (document.getElementById("darkFrameRadio").checked && document.getElementById("darkFrameFilename").value == "") alert("Invalid value for parameter darkFrameFilename");
                        var manualHotPixelX = manualHotPixelX_str.split(',');
                        var manualHotPixelY = manualHotPixelY_str.split(',');
                        var manualHotPixelRate = manualHotPixelRate_str.split(',');
                        var manualHotPixelIsTelegraphic = manualHotPixelIsTelegraphic_str.split(',');
                        if (manualHotPixelX.length != manualHotPixelY.length || manualHotPixelRate.length != manualHotPixelY.length || manualHotPixelIsTelegraphic.length != manualHotPixelY.length) {
                            alert("Error in uploaded xml file: manualHotPixelX, manualHotPixelY, manualHotPixelRate and manualHotIsTelegraphic must all have the same number of comma separated values");
                        }
                        if (manualHotPixelX.length > 14) {
                            alert("Warning in uploaded xml file: more than 14 manual hot pixels are defined but the form will only hold the first 14");
                        }
                        document.getElementById("nManualHotPixels").value = manualHotPixelX.length;
                        for (i = 0; i < Math.min(manualHotPixelX.length,14); i++) {
                            document.getElementById("manualHotPixel"+i+"_X").value = manualHotPixelX[i];
                            document.getElementById("manualHotPixel"+i+"_Y").value = manualHotPixelY[i];
                            document.getElementById("manualHotPixel"+i+"_rate").value = manualHotPixelRate[i];
                            document.getElementById("manualHotPixel"+i+"_isTelegraphic").checked = manualHotPixelIsTelegraphic[i]=="T";
                            if (i != 0) document.getElementById("manualHotPixel"+i).style.display = "inherit";
                        }
                    } else {
                        document.getElementById("runDarkCurrentGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("FrameTransferSmearer")!=-1) {
                        document.getElementById("runFrameTransferSmearer").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'transferClockPeriod') document.getElementById("transferClockPeriod").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runFrameTransferSmearer").checked = false;
                    }

                    if (modulesToRun.indexOf("PhotonNoiseGenerator")!=-1) {
                        document.getElementById("runPhotonNoiseGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'photonNoiseSeed') document.getElementById("photonNoiseSeed").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runPhotonNoiseGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("CosmicRayGenerator")!=-1) {
                        document.getElementById("runCosmicRayGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'meanCosmicsPerMinute') document.getElementById("meanCosmicsPerMinute").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'SAAFluxFactor') document.getElementById("SAAFluxFactor").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cosmicSeed') document.getElementById("cosmicSeed").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cosmicEnergyScaleFactor') document.getElementById("cosmicEnergyScaleFactor").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runCosmicRayGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("FullWellSimulator")!=-1) {
                        document.getElementById("runFullWellSimulator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'fullWellCapacity') document.getElementById("fullWellCapacity").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runFullWellSimulator").checked = false;
                    }

                    if (modulesToRun.indexOf("ChargeTransferSimulator")!=-1) {
                        document.getElementById("runChargeTransferSimulator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                           if ($(this).find('name').text() == 'endOfLife') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("endOfLifeRadio").checked = true;
                                } else {
                                    document.getElementById("beginOfLifeRadio").checked = true;
                                }
                            }
                            if ($(this).find('name').text() == 'cte_vertical') document.getElementById("cte_vertical").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cte_horizontal') document.getElementById("cte_horizontal").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cti_trailLength') document.getElementById("cti_trailLength").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cti_trailFraction') document.getElementById("cti_trailFraction").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'cti_intensityScaling') document.getElementById("cti_intensityScaling").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runChargeTransferSimulator").checked = false;
                    }

                    if (modulesToRun.indexOf("BiasGenerator")!=-1) {
                        document.getElementById("runBiasGenerator").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'empiricalBiasFrame') {
                                if ($(this).find('value').text()=="true") {
                                    document.getElementById("biasFrameRadio").checked = true;
                                } else {
                                    document.getElementById("gaussianBiasRadio").checked = true;
                                }
                            }
                            if ($(this).find('name').text() == 'biasFrameFilename') document.getElementById("biasFrameFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'applyAnalogElectronicsStability') document.getElementById("applyAnalogElectronicsStability").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'doCcdNonLinearity') document.getElementById("doCcdNonLinearity").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'ccdNonLinearityFilename') document.getElementById("ccdNonLinearityFilename").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'biasMean') document.getElementById("biasMean").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'biasWidth') document.getElementById("biasWidth").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'biasNoiseSeed') document.getElementById("biasNoiseSeed").value = $(this).find('value').text();
                        });
                        if (document.getElementById("gainCorrectionFilename").value == "") alert("Invalid value for parameter gainCorrectionFilename");
                        if (document.getElementById("doCcdNonLinearity").checked && document.getElementById("ccdNonLinearityFilename").value == "") alert("Invalid value for parameter ccdNonLinearityFilename");
                        if (document.getElementById("biasFrameRadio").checked && document.getElementById("biasFrameFilename").value == "") alert("Invalid value for parameter biasFrameFilename");
                    } else {
                        document.getElementById("runBiasGenerator").checked = false;
                    }

                    if (modulesToRun.indexOf("ImageWriter")!=-1) {
                        document.getElementById("runImageWriter").checked = true;
                        var newMargins = true;
                        var writeCcdMargins = false;
                        var ccdMarginImages = false;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'writeUnstackedImages') document.getElementById("writeUnstackedImages").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'writeStackedImages') document.getElementById("writeStackedImages").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'doublePrecisionStackedImages') document.getElementById("doublePrecisionStackedImages").value = ($(this).find('value').text()=="true") ? "true" : "false";
                            if ($(this).find('name').text() == 'stackingMethod') document.getElementById("stackingMethod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'marginStackingMethod') document.getElementById("marginStackingMethod").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'marginMode') document.getElementById("marginMode").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'writeCcdMargins') {
                                newMargins = false;
                                writeCcdMargins =  ($(this).find('value').text()=="true") ? true : false;
                            }
                            if ($(this).find('name').text() == 'ccdMarginImages') ccdMarginImages =  ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'writeImagettes') document.getElementById("writeImagettes").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'writeCentroid') document.getElementById("writeCentroid").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'dynamicImagettes') document.getElementById("croppingMethod").value = ($(this).find('value').text()=="true") ? "dynamic" : "static";
                            if ($(this).find('name').text() == 'stackImagettes') document.getElementById("stackImagettes").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'imagetteShape') document.getElementById("imagetteShape").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'subarrayShape') document.getElementById("subarrayShape").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'writeTruthData') document.getElementById("writeTruthData").value = ($(this).find('value').text()=="true") ? "true" : "false";
                            if ($(this).find('name').text() == 'omitEarthOccultation') document.getElementById("omitEarthOccultation").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'omitSAA') document.getElementById("omitSAA").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'omitStrayLight') document.getElementById("omitStrayLight").checked = ($(this).find('value').text()=="true") ? true : false;
                            if ($(this).find('name').text() == 'imagetteSize') document.getElementById("imagetteSize").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'numberOfCEsToOmitAtStart') document.getElementById("numberOfCEsToOmitAtStart").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'onlyWriteEveryNthCE') document.getElementById("onlyWriteEveryNthCE").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'targetLocationFromJitter') document.getElementById("targetLocationFromJitter").value = $(this).find('value').text();
                            if ($(this).find('name').text() == 'ceCounterOffset') document.getElementById("ceCounterOffset").value = $(this).find('value').text();
                        });
                        if (!newMargins) {
                            if (!writeCcdMargins) {
                                document.getElementById("marginMode").value = "collapsed";
                            } else if (ccdMarginImages) {
                                document.getElementById("marginMode").value = "image";
                            } else {
                                document.getElementById("marginMode").value = "reduced";
                            }
                        }
                    } else {
                        document.getElementById("runImageWriter").checked = false;
                    }

                    if (modulesToRun.indexOf("HKWriter")!=-1) {
                        document.getElementById("runHKWriter").checked = true;
                        $.each($(xmlDoc).find('param'), function () {
                            if ($(this).find('name').text() == 'sdsCounterOffset') document.getElementById("sdsCounterOffset").value = $(this).find('value').text();
                        });
                    } else {
                        document.getElementById("runHKWriter").checked = false;
                    }

                    $.each($(xmlDoc).find('param'), function () {
                        if ($(this).find('name').text() == 'extractLightCurve') document.getElementById("extractLightCurve").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'generateNoiseCurve') document.getElementById("generateNoiseCurve").checked = ($(this).find('value').text()=="true") ? true : false;
                        if ($(this).find('name').text() == 'subtractFlatField') document.getElementById("subtractFlatField").checked = ($(this).find('value').text()=="true") ? true : false;
                    });

                    showHide();
                    setImagetteStackingOrder();
                    setOversampling();
                    setTargetStarForPointing();
                    updateStars();
                    checkExposure(); 
                    calculateSaturation();
                    //setReadMode();
                    if (filesToUpload.length>0) {
                        var starFileText = "";
                        if (document.getElementById("runStarProducer").checked) {
                            starFileText = "\nThe above are in addition to the list of stars which must be separately uploaded (EXT_PRE_StarCatalogue or ascii) or defined manually in StarProducer.";
                        }
                        alert("The xml file specifies user provided input files that are not part of the release. The following files will need to be uploaded using the relevant buttons in the form:\n\nForm section \t\t\t Description\n---------------------------------------------------------\n"+filesToUpload+starFileText);
                    }
                }
                reader.readAsText($("#xmlFile")[0].files[0]);
            } else {
                alert("This browser does not support HTML5.");
            }
        } else {
            alert("Please upload a valid XML file.");
        }
    });
});
</script>

<br><br>
<div class="tab" align="center">
  <button type="button" class="tablinks active" onclick="openTabContent(event, 'VisitTab')">Visit</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'StarFieldTab')">Star Field</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'StellarFluxTab')">Stellar Flux</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'SatelliteTab')">Satellite</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'TelescopeTab')">Telescope</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'DetectorTab')">Detector</button>
  <button type="button" class="tablinks" onclick="openTabContent(event, 'OutputTab')">Output</button>
</div>

<div id="VisitTab" class="tabcontent" style="display:block">

<h3 id="time" name"time">Visit configuration <a href="UserManual/CHEOPSim_UserManual.html#time" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>

<style type="text/css">
.myTable4 { background-color:#CED8F6;border-collapse:collapse;text-align:center;vertical-align:middle;border:1px solid #000;width:960px; }
.myTable4 th { background-color:#A9BCF5;border:1px solid #000;}
.myTable4 td, .myTable th { padding:6px }
</style>
<table class="myTable4">
  <tr>
    <td width="450">
      Optionally import visit data from either an Observation Request xml file,<br> or from an MPS_PRE_Visits FITS file:</td><td><input type="file" id="visitFile" name="visitFile" onchange="checkVisitFileType(this)">
    </td>
    <td id="obsIdField" style="display:none">Observation ID<input NAME="obsId" ID="obsId" VALUE="" onchange="checkObsId(this)"></td>
    <td><input type="button" id="visitUpload" value="Import" /></td>
  </tr>
</table>
<input name="visitFileExists" id="visitFileExists" value="false" style="display:none">

<SCRIPT language="javascript">
function checkVisitFileType(el) {
    document.getElementById("visitFileExists").value = "true";
    if (el.value.endsWith('.fits') && el.value.includes('MPS_PRE_Visits')) {
      document.getElementById("obsIdField").style.display = "block";
    } else if (el.value.endsWith('.xml') && el.value.includes('EXT_APP_ObservationRequests')) {
      document.getElementById("obsIdField").style.display = "none";
    } else {
      document.getElementById("obsIdField").style.display = "none";
      alert("Name of uploaded file must contain 'MPS_PRE_Visits' end with '.fits' or contain 'EXT_APP_ObservationRequests' and end in '.xml'")
      el.value="";
    }
}
</SCRIPT>

<SCRIPT language="javascript">
function importMPSVisit() {
    var obsId = document.getElementById("obsId").value;
    var table = this.getDataUnit(1);
    var header = this.getHeader();
    table.getColumn("OBSID", function(column) {
        var row=-1;
        var col = -1;
        for (var i = 0; i < header.get("TFIELDS"); i++) {
            if (header.get("TTYPE"+i)=="OBSID") col = i;
        }
        if (col==-1) alert("Error reading OBSID");
        for (var i = 0; i < column.length; i++) {
            if (column[i]-header.get("TZERO"+col) == parseInt(obsId)) {
                row = i;
                break;
            }
        }
        if (row==-1) {
            alert("No row found in MPS_PRE_Visits table with OBSID="+obsId);
            return;
        }
        alert("The following fields in the form will be updated with values read from the uploaded file:\n\n"
              +"Visit Configuration:\n"
              +" - start time\n"
              +" - exposure duration\n"
              +" - exposures per stack\n"
              +" - imagette stacking order\n"
              +" - number of stacked images           (scroll down for more...)\n"
              +" - flag to generate full fame image\n"
              +" - margin mode\n\n"
              +"StarProducer:\n"
              +" - Target star RA\n"
              +" - Target star declination\n"
              +" - Target star spectral type\n"
              +" - Target star magnitude\n\n"
              +"FocalPlaneGenerator:\n"
              +" - Intended target location on CCD");
        table.getColumn("EXPTIME", function(column) {
            document.getElementById("exposureTime").value = column[row];
            checkExposure();
            table.getColumn("READOUT_MODE", function(column_readMode) {
                document.getElementById("readMode").value = column_readMode[row];
                setReadMode();
                calculateRuntime();calculateSaturation();
            });
        });
        table.getColumn("N_FULLFRAME_EXP", function(column) {
            var col = -1;
            for (var i = 0; i < header.get("TFIELDS"); i++) {
                if (header.get("TTYPE"+i)=="N_FULLFRAME_EXP") col = i;
            }
            if (col==-1) alert("Error reading N_FULLFRAME_EXP");
            document.getElementById("doFullFrame").checked = ((column[row]-header.get("TZERO"+col))==1?true:false);
        });
        table.getColumn("NEXP", function(column) {
            var col = -1;
            for (var i = 0; i < header.get("TFIELDS"); i++) {
                if (header.get("TTYPE"+i)=="NEXP") col = i;
            }
            if (col==-1) alert("Error reading NEXP");
            var exposuresPerStack = column[row]-header.get("TZERO"+col);
            document.getElementById("exposuresPerStack").value = exposuresPerStack;
        });
        table.getColumn("NEXP_IMAGETTES", function(column) {
            var col = -1;
            for (var i = 0; i < header.get("TFIELDS"); i++) {
                if (header.get("TTYPE"+i)=="NEXP_IMAGETTES") col = i;
            }
            if (col==-1) {
                alert("Error reading NEXP_IMAGETTES");
            } else {
                var imagetteStackingOrder = column[row]-header.get("TZERO"+col);
                document.getElementById("imagetteStackingOrder").value = imagetteStackingOrder;
            }
        });
        table.getColumn("UTC_TIME_START", function(column) {
            var startTime = column[row];
            document.getElementById("startTime").value = startTime.replace("T"," ");
            checkStartTime(document.getElementById("startTime"));
            table.getColumn("UTC_TIME_STOP", function(column) {
                var startUTC = new Date(startTime);
                var stopUTC = new Date(column[row]);
                var duration = parseFloat((stopUTC.getTime() - startUTC.getTime())/1000.)-30.;
                var exposureTime = parseFloat(document.getElementById("exposureTime").value);
                var exposuresPerStack = parseFloat(document.getElementById("exposuresPerStack").value);
                var repetitionPeriod = document.getElementById("repetitionPeriod").value;
                if (repetitionPeriod==0.) repetitionPeriod =  exposureTime < 1. ? parseFloat(exposureTime)+1. : Math.ceil(parseFloat(exposureTime));
                if (document.getElementById("doFullFrame").checked) duration -= (5. + exposureTime);
                console.log(repetitionPeriod,duration)
                document.getElementById("numberOfStackedImages").value = parseInt(Math.trunc(duration/(repetitionPeriod*exposuresPerStack)));
                //console.log(startUTC,stopUTC,exposureTime,exposuresPerStack,repetitionPeriod,document.getElementById("doFullFrame").checked,duration,document.getElementById("numberOfStackedImages").value);
                checkStackedImages();
                calculateRuntime();calculateSaturation();
            });
        }); 
            table.getColumn("MARGIN_MODE", function(column) {
            var marginMode = column[row];
            if (marginMode!="image" && marginMode!="reduced" && marginMode!="total collapsed") {
                alert("Error reading MARGIN_MODE from MPS_PRE_Visits: invalid value "+marginMode)
            }
            document.getElementById("marginMode").value = marginMode;
        });
        table.getColumn("RA_TARG", function(column) {
            document.getElementById("hiddenPointingRA").value = column[row];
            document.getElementById("star0_RA").value = column[row];
            checkRA(document.getElementById("hiddenPointingRA"));
        });
        table.getColumn("DEC_TARG", function(column) {
            document.getElementById("hiddenPointingDec").value = column[row];
            document.getElementById("star0_Dec").value = column[row];
            checkDec(document.getElementById("hiddenPointingDec"));
        });
        table.getColumn("MAG_TARG", function(column) {
            document.getElementById("star0_Mag").value = column[row];
            checkMagnitude(document.getElementById("star0_Mag"));
            calculateSaturation();
        });
        table.getColumn("SPECTRAL_TYPE", function(column) {
            var specType = column[row];
            if (specType.endsWith("V")) specType=specType.substr(0, specType.length-1);
            document.getElementById("star0_SpecType").value = specType;
            calculateSaturation();
        });
        table.getColumn("TARGET_LOCATION_X", function(column) {
            document.getElementById("targetLocationX").value = column[row];
            document.getElementById("subArrayXOffset").value = column[row] - document.getElementById("subArrayXDim").value/2; 
        });
        table.getColumn("TARGET_LOCATION_Y", function(column) {
            document.getElementById("targetLocationY").value = column[row];
            document.getElementById("subArrayYOffset").value = column[row] - document.getElementById("subArrayYDim").value/2;
        });
    });
    if (this.getHeader(2).get('EXTNAME') == "MPS_PRE_VisitConstraints") {
        document.getElementById("saaFlagFromVisitConstraints").disabled = false;
        document.getElementById("saaFlagFromVisitConstraints").checked = true;
        document.getElementById("strayLightFromVisitConstraints").disabled = false;
        document.getElementById("strayLightFromVisitConstraints").checked = true;
        alert("Stray light flux will be read from MPS_PRE_VisitConstraints. This can be disabled in StrayLightGenerator (Telescope tab)\n\n"
+"SAA flags, stray light flags and Earth occultation flags will be read from MPS_PRE_VisitConstraints. This can be disabled OrbitSimulator (Satellite tab)");
    }
}
</SCRIPT>

<script type="text/javascript">
$(function () {
    $("#visitUpload").bind("click", function () {

        if ($("#visitFile").val().match(/.fits$/)) {

            if (!($("#obsId").val())) {
                alert("Please specify the Observation ID (value of OBSID column of the MPS_PRE_Visits file for the desired visit) in in order to determine which row to read from the file");
                return;
            }
      
            var fits = new FITS($("#visitFile")[0].files[0], importMPSVisit);

        } else if ($("#visitFile").val().match(/.xml$/)) {

            var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xml)$/;
            if (regex.test($("#visitFile").val().toLowerCase())) {
                if (typeof (FileReader) != "undefined") {
                    alert("The following fields in the form will be updated with values read from the uploaded file:\n\n"
                          +"Visit Configuration:\n"
                          +" - exposure duration\n"
                          +" - exposures per stack\n"
                          +" - imagette stacking order\n"
                          +" - number of stacked images\n\n"
                          +"StarProducer:\n"
                          +" - Target star RA\n"
                          +" - Target star declination\n"
                          +" - Target star spectral type\n"
                          +" - Target star magnitude\n\n"
                          +"TransitFluxModulator:\n"
                          +" - Planet orbital period\n\n"
                          +"ImageWriter:\n"
                          +" - flag to not write images during Earth occultation\n"
                          +" - flag to not write images during SAA\n\n"
                          +"Note that the simulation start time and the flag to generate a full frame image are not provided by the Observation request file and must be assigned manually.");
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        var xmlDoc = $.parseXML(e.target.result);

                        var exposureTime = $(xmlDoc).find('Exposure_Time').text();
                        var repetitionPeriod = $(xmlDoc).find('Repetition_Period').text();
                        if (repetitionPeriod=="") repetitionPeriod =  exposureTime < 1. ? parseFloat(exposureTime)+1. : Math.ceil(parseFloat(exposureTime));
                        var exposuresPerStack = $(xmlDoc).find('Number_Stacked_Images').text();
                        var imagetteStackingOrder = $(xmlDoc).find('Number_Stacked_Imagettes').text();
                        var visitDuration = $(xmlDoc).find('Visit_Duration').text();
                        document.getElementById("exposureTime").value = exposureTime;
                        document.getElementById("exposuresPerStack").value = exposuresPerStack;
                        if (imagetteStackingOrder=="") {
                            setImagetteStackingOrder();
                        } else {
                            document.getElementById("imagetteStackingOrder").value = imagetteStackingOrder;
                        }
                        document.getElementById("numberOfStackedImages").value = parseInt(Math.trunc(visitDuration/(repetitionPeriod*exposuresPerStack)));
                        document.getElementById("repetitionPeriod").value = repetitionPeriod;
                        document.getElementById("repetitionPeriodMethod").value = "manual"
                        document.getElementById("repetitionPeriodTR").style.display = "table-row"
                        document.getElementById("readMode").value = $(xmlDoc).find('Readout_Mode').text();
                        checkExposure();
                        setReadMode();
                        checkStackedImages();

                        document.getElementById("hiddenPointingRA").value = $(xmlDoc).find('Right_Ascension').text();
                        document.getElementById("star0_RA").value = $(xmlDoc).find('Right_Ascension').text();
                        checkRA(document.getElementById("hiddenPointingRA"));

                        document.getElementById("hiddenPointingDec").value = $(xmlDoc).find('Declination').text();
                        document.getElementById("star0_Dec").value = $(xmlDoc).find('Declination').text();
                        checkDec(document.getElementById("hiddenPointingDec"));

                        document.getElementById("star0_Mag").value = $(xmlDoc).find('Target_Magnitude').text();
                        checkMagnitude(document.getElementById("star0_Mag"));

                        var specType = $(xmlDoc).find('Spectral_Type').text();
                        if (specType.endsWith("V")); specType=specType.substr(0, specType.length-1);
                        document.getElementById("star0_SpecType").value = specType;

                        document.getElementById("orbitPeriod_star0").value = $(xmlDoc).find('Transit_Period').text();
                        document.getElementById("orbitUnits_star0").value = "days"

                        document.getElementById("omitEarthOccultation").checked = ($(xmlDoc).find('Send_Data_Taking_During_Earth_Constraints').text()=="false") ? true : false;
                        document.getElementById("omitSAA").checked = ($(xmlDoc).find('Send_Data_Taking_During_SAA').text()=="false") ? true : false;

                        calculateRuntime();calculateSaturation();
                    }
                    reader.readAsText($("#visitFile")[0].files[0]);
                } else {
                    alert("This browser does not support HTML5.");
                }
            } else {
                alert("Please upload a valid XML file.");
            }

        } else {
            alert("Name of uploaded file must end with '.fits' or '.xml'");
        }

    });
});
</script>

<br>
<ul>
<table>
  <tr>
    <td>Start date and time of the simulation, in the following format: YYYY-MM-DD HH:MM:SS[.SSS] </td>
    <td><input NAME="startTime" ID="startTime" VALUE="2020-09-01 12:00:00" onchange="calculateRuntime();calculateSaturation();checkStartTime(this)"></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#startTime" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Exposure duration in seconds</td>
    <td><input NAME="exposureTime" id="exposureTime" VALUE="6" onchange="setExposuresPerStack();checkExposure();checkRepetitionPeriod(this);setReadMode()"></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#exposureTime" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Repetition period in seconds</td>
    <td><select NAME="repetitionPeriodMethod" id="repetitionPeriodMethod" onchange="updateRepetitionPeriod(this)">
      <option value="automatic" selected>automatic</option>
      <option value="manual">manual</option>
    </select></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#repetitionPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr ID="repetitionPeriodTR" style="display:none">
    <td></td>
    <td><input NAME="repetitionPeriod" id="repetitionPeriod" VALUE="0" onchange="checkRepetitionPeriod(this);calculateDuration()"></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#repetitionPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Number of exposures per stacked image <i><font color=green>- default assigned according to exposure duration</i></font></td>
    <td><select NAME="exposuresPerStack" id="exposuresPerStack" onchange="calculateRuntime();calculateSaturation();checkExposure();setImagetteStackingOrder()">
      <option value="44">44</option>
      <option value="40">40</option>
      <option value="39">39</option>
      <option value="36">36</option>
      <option value="33">33</option>
      <option value="30">30</option>
      <option value="28">28</option>
      <option value="26">26</option>
      <option value="24">24</option>
      <option value="22">22</option>
      <option value="20">20</option>
      <option value="18">18</option>
      <option value="16">16</option>
      <option value="15">15</option>
      <option value="14">14</option>
      <option value="13">13</option>
      <option value="12">12</option>
      <option value="11">11</option>
      <option value="10">10</option>
      <option value="9">9</option>
      <option value="8">8</option>
      <option value="7">7</option>
      <option value="6" selected>6</option>
      <option value="5">5</option>
      <option value="4">4</option>
      <option value="3">3</option>
      <option value="2">2</option>
      <option value="1">1</option>
    </select></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#exposuresPerStack" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Imagette stacking order <i><font color=green> - for information only - assigned according to exposures per stacked image</i></font></td>
    <td><select id="imagetteStackingOrder" disabled>
      <option value="4">4</option>
      <option value="3">3</option>
      <option value="2">2</option>
      <option value="1" selected>1</option>
      <option value="0">0</option>
    </select></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#imagetteStackingOrder" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Number of stacked images to produce</td>
    <td><input NAME="numberOfStackedImages" id="numberOfStackedImages" VALUE="6" onchange="calculateRuntime();calculateSaturation();checkStackedImages()"></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#numberOfStackedImages" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Pointing direction Right Ascension either in hours:mins:secs (HH:MM:SS[.SSS]) or in degrees as a decimal</td><td><input NAME="pointingRA" ID="pointingRA" VALUE="As target star" style="color:green" onchange="calculateRuntime();calculateSaturation();checkRA(this);setHiddenPointingRA(this)" onclick="checkTargetStarForPointing(this)" readonly></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#pointingRA" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Pointing direction declination either in degrees:arcmins:arcsecs (DD:MM:SS[.SSS]) or in degrees as a decimal</td><td><input NAME="pointingDec" ID="pointingDec" VALUE="As target star" style="color:green" onchange="calculateRuntime();calculateSaturation();checkDec(this);setHiddenPointingDec(this)" onclick="checkTargetStarForPointing(this)" readonly></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#pointingDec" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td><input type="checkbox" name="doFullFrame" id="doFullFrame" VALUE="false"> Generate a full frame image corresponding to the first exposure 
    <a href="UserManual/CHEOPSim_UserManual.html#doFullFrame" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </tr>
</table>
<input NAME="hiddenPointingRA" ID="hiddenPointingRA" VALUE="00:00:00.0" style="display:none"></td>
<input NAME="hiddenPointingDec" ID="hiddenPointingDec" VALUE="00:00:00.0" style="display:none"></td>
<input NAME="readMode" ID="readMode" VALUE="" style="display:none"></td>
</ul>
<br>

<input NAME="programType" id="programType" VALUE="90" style="display:none">
<input NAME="piName" id="piName" VALUE="CHEOPSim" style="display:none">
<input NAME="piUid" id="piUid" VALUE="0" style="display:none">

<SCRIPT language="javascript">
function updateRepetitionPeriod(el) {
    if (el.value == "automatic") {
        document.getElementById("repetitionPeriod").value = 0;
        document.getElementById("repetitionPeriodTR").style.display = "none";
    } else {
        if (document.getElementById("repetitionPeriod").value == 0) {
            var exposureTime = document.getElementById("exposureTime").value;
            document.getElementById("repetitionPeriod").value =  exposureTime < 1. ? parseFloat(exposureTime)+1. : Math.ceil(parseFloat(exposureTime));
        }
        document.getElementById("repetitionPeriodTR").style.display = "table-row";
    }
    calculateDuration();
}
function setHiddenPointingRA(el) {
    document.getElementById("hiddenPointingRA").value = el.value;
}
function setHiddenPointingDec(el) {
    document.getElementById("hiddenPointingDec").value = el.value;
}
function setReadMode() {
    var exposureTime = document.getElementById("exposureTime").value;
    var readMode = document.getElementById("readMode").value;

    //console.log(readMode,exposureTime);

    var fastRead = (exposureTime <= 2.326);
    if (readMode == "bright" || readMode == "ultrabright") {
        if (!fastRead) {
           alert("Warning: Read mode from Visit file (MPS_PRE_Visits or EXT_PRE_ObservationRequests) is "+readMode
                 +", which is inconsistent with the exposure duration of "+exposureTime+" seconds. The specified read mode will override the exposure duration in determining the readout noise and serial read rate.");
        }
        fastRead = true;
    } else if (readMode == "faint fast" || readMode == "faint") {
        if (fastRead) {
           alert("Warning: Read mode from Visit file (MPS_PRE_Visits or EXT_PRE_ObservationRequests) is "+readMode
                 +", which is inconsistent with the exposure duration of "+exposureTime+" seconds. The specified read mode will override the exposure duration in determining the readout noise and serial read rate.");
        }
        fastRead = false;
    } else if (readMode != "") {
        alert("Error: Invalid read mode from Visit file (MPS_PRE_Visits or EXT_PRE_ObservationRequests): "+readMode);
    }

    var readNoise = document.getElementById("biasWidth").value;
    var serialReadRate = document.getElementById("serialReadRate").value;
    if (fastRead && (readNoise != 7.2 || serialReadRate != 230.)) {
        document.getElementById("biasMean").value = 553.8;
        document.getElementById("biasWidth").value = 7.2;
        document.getElementById("serialReadRate").value = 230.;
        var conditionString = (readMode=="" ? "exposure duration <= 2.326s" : readMode+" readout mode");
        alert("Note: default readout noise is being increased from 3.5ADU to 7.2ADU, bias offset reduced from 609.0 to 553.8, and serial read rate increased from 100kHz to 230kHz, for "+conditionString);
    } else if (!fastRead && (readNoise != 3.5 || serialReadRate != 100.)) {
        document.getElementById("biasMean").value = 609.0;
        document.getElementById("biasWidth").value = 3.5;
        document.getElementById("serialReadRate").value = 100.;
        var conditionString = (readMode=="" ? "exposure duration > 2.326s" : readMode+" readout mode");
        alert("Note: default readout noise is being decreased from 7.2ADU to 3.5ADU, bias offset reduced from 553.8.0 to 609.0, and serial read rate decreased from 230kHz to 100kHz, for "+conditionString);
    }
}
</SCRIPT>

<SCRIPT language="javascript">
function setExposuresPerStack() {
    //Read the image stacking order corresponding to the exposure time from the LUT
    var exposureTime = document.getElementById("exposureTime").value;
    $.get("LUT_image_stacking.txt",function(txt){
        var lut = txt.split("\n");
        for (var i = 1, len = lut.length; i < len-1; i++) {
            var vals = lut[i].split("        ");
            if (parseFloat(exposureTime) <= parseFloat(vals[0])) {
                exposuresPerStack = vals[1];
                break;
            }
        }
        document.getElementById("exposuresPerStack").value = parseInt(Math.round(exposuresPerStack));
        setImagetteStackingOrder();
        calculateRuntime();
        calculateSaturation()
    });
}
</SCRIPT>

<SCRIPT language="javascript">
function calculateDuration() {
    var duration = 0.;
    var exposureTime = document.getElementById("exposureTime").value;
    var repetitionPeriod = document.getElementById("repetitionPeriod").value;
    if (repetitionPeriod==0) repetitionPeriod = exposureTime < 1. ? parseFloat(exposureTime)+1. : Math.ceil(parseFloat(exposureTime));
    duration = document.getElementById("numberOfStackedImages").value *
                   document.getElementById("exposuresPerStack").value *
                   repetitionPeriod;
    document.getElementById("duration").value = parseFloat(duration/3600.).toFixed(2);
}
</SCRIPT>

<SCRIPT language="javascript">
function setImagetteStackingOrder() {
    //Set imagette stacking order according to exposuresPerStack value, using thresholds corresponding to LUT_image_stacking.txt
    var exposuresPerStack = document.getElementById("exposuresPerStack").value;
    var imagetteStackingOrder;
    if (exposuresPerStack==1) {
        imagetteStackingOrder = 0;
    } else if (exposuresPerStack<16) {
        imagetteStackingOrder = 1;
    } else if (exposuresPerStack<30) {
        imagetteStackingOrder = 2;
    } else if (exposuresPerStack<40) {
        imagetteStackingOrder = 3;
    } else {
        imagetteStackingOrder = 4;
    }
    document.getElementById("imagetteStackingOrder").value = imagetteStackingOrder;
}
</SCRIPT>

<SCRIPT language="javascript">
function calculateSaturation() {

    //Array containing time to saturation for full well capacity 100k electrons
    //as a function of Gaia magnitude (rows) and spectral type (columns)
    //1st column indicates Gaia magnitude, columns 2-41 correspond to spectral types
    //O7,O8,O9,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,G0,G1,G2,G3,G4,G5,G6,G7,G8,G9,K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,M0,M1,M2,M3,M4,M5,M6,M7,M8,M9
    //The arrays are calculated by running CHEOPSim/simulator/timeToSaturation.sh

    var timeToSaturationArray_throughput_QE =
      [[5,1.51828,1.51057,1.50283,1.49895,1.47734,1.4552,1.43946,1.43809,1.43349,1.42781,1.42539,1.41797,1.40879,1.40366,1.40114,1.39937,1.39798,1.39667,1.39581,1.39546,1.3946,1.39338,1.39314,1.39233,1.38615,1.3861,1.38605,1.38598,1.38585,1.38564,1.38548,1.38537,1.38516,1.38499,1.38493,1.38477,1.38468,1.38463,1.38462,1.38458,1.38457,1.38457,1.38466,1.38475,1.385,1.38546,1.38661,1.38874,1.39078,1.39536,1.39851,1.40007,1.4024,1.40337,1.40756,1.41224,1.41682,1.42232,1.42571,1.42972,1.42886,1.42524,1.42446],
      [5.5,2.40631,2.39409,2.38183,2.37568,2.34142,2.30633,2.28139,2.27923,2.27192,2.26292,2.2591,2.24734,2.23278,2.22465,2.22066,2.21785,2.21565,2.21358,2.21222,2.21166,2.21029,2.20835,2.20799,2.20669,2.19691,2.19682,2.19674,2.19663,2.19643,2.19609,2.19584,2.19566,2.19532,2.19506,2.19497,2.19472,2.19458,2.1945,2.19447,2.19441,2.19439,2.19439,2.19454,2.19468,2.19508,2.1958,2.19763,2.201,2.20424,2.21149,2.21649,2.21896,2.22266,2.22418,2.23083,2.23824,2.24551,2.25423,2.2596,2.26595,2.26459,2.25885,2.25762],
      [6,3.81375,3.79437,3.77495,3.7652,3.71091,3.65529,3.61575,3.61233,3.60075,3.58649,3.58043,3.56179,3.53872,3.52584,3.51951,3.51506,3.51156,3.50828,3.50613,3.50524,3.50308,3.50001,3.49942,3.49737,3.48186,3.48172,3.48159,3.48143,3.48111,3.48057,3.48018,3.47989,3.47935,3.47893,3.4788,3.4784,3.47817,3.47804,3.478,3.47791,3.47788,3.47788,3.47811,3.47833,3.47896,3.48011,3.48301,3.48835,3.49348,3.50498,3.5129,3.51681,3.52267,3.5251,3.53563,3.54738,3.5589,3.57271,3.58122,3.5913,3.58914,3.58003,3.57809],
      [6.5,6.04438,6.01368,5.98289,5.96745,5.88139,5.79325,5.73058,5.72516,5.70681,5.68421,5.67459,5.64505,5.60849,5.58808,5.57805,5.57099,5.56545,5.56025,5.55684,5.55543,5.552,5.54714,5.54621,5.54296,5.51838,5.51815,5.51795,5.51769,5.51719,5.51634,5.51571,5.51526,5.5144,5.51373,5.51352,5.51289,5.51253,5.51232,5.51226,5.51212,5.51207,5.51207,5.51243,5.51278,5.51378,5.51561,5.5202,5.52866,5.5368,5.55501,5.56756,5.57377,5.58306,5.5869,5.60359,5.62221,5.64047,5.66236,5.67586,5.69182,5.6884,5.67397,5.67088],
      [7,9.5797,9.53103,9.48224,9.45777,9.32138,9.18168,9.08236,9.07377,9.04468,9.00886,8.99362,8.9468,8.88885,8.85651,8.84062,8.82943,8.82064,8.81241,8.80699,8.80476,8.79933,8.79162,8.79015,8.785,8.74604,8.74568,8.74537,8.74494,8.74415,8.74281,8.74181,8.74109,8.73974,8.73868,8.73834,8.73734,8.73677,8.73644,8.73635,8.73612,8.73604,8.73604,8.73662,8.73717,8.73875,8.74165,8.74893,8.76233,8.77523,8.8041,8.82399,8.83382,8.84856,8.85464,8.88109,8.91061,8.93954,8.97424,8.99563,9.02093,9.0155,8.99264,8.98774],
      [7.5,15.1828,15.1057,15.0283,14.9895,14.7734,14.552,14.3946,14.3809,14.3349,14.2781,14.2539,14.1797,14.0879,14.0366,14.0114,13.9937,13.9798,13.9667,13.9581,13.9546,13.946,13.9338,13.9314,13.9233,13.8615,13.861,13.8605,13.8598,13.8585,13.8564,13.8548,13.8537,13.8516,13.8499,13.8493,13.8477,13.8468,13.8463,13.8462,13.8458,13.8457,13.8457,13.8466,13.8475,13.85,13.8546,13.8661,13.8874,13.9078,13.9536,13.9851,14.0007,14.024,14.0337,14.0756,14.1224,14.1682,14.2232,14.2571,14.2972,14.2886,14.2524,14.2446],
      [8,24.0631,23.9409,23.8183,23.7568,23.4142,23.0633,22.8139,22.7923,22.7192,22.6292,22.591,22.4734,22.3278,22.2465,22.2066,22.1785,22.1565,22.1358,22.1222,22.1166,22.1029,22.0835,22.0799,22.0669,21.9691,21.9682,21.9674,21.9663,21.9643,21.9609,21.9584,21.9566,21.9532,21.9506,21.9497,21.9472,21.9458,21.945,21.9447,21.9441,21.9439,21.9439,21.9454,21.9468,21.9508,21.958,21.9763,22.01,22.0424,22.1149,22.1649,22.1896,22.2266,22.2418,22.3083,22.3824,22.4551,22.5423,22.596,22.6595,22.6459,22.5885,22.5762],
      [8.5,38.1375,37.9437,37.7495,37.652,37.1091,36.5529,36.1575,36.1233,36.0075,35.8649,35.8043,35.6179,35.3872,35.2584,35.1951,35.1506,35.1156,35.0828,35.0613,35.0524,35.0308,35.0001,34.9942,34.9737,34.8186,34.8172,34.8159,34.8143,34.8111,34.8057,34.8018,34.7989,34.7935,34.7893,34.788,34.784,34.7817,34.7804,34.78,34.7791,34.7788,34.7788,34.7811,34.7833,34.7896,34.8011,34.8301,34.8835,34.9348,35.0498,35.129,35.1681,35.2267,35.251,35.3563,35.4738,35.589,35.7271,35.8122,35.913,35.8914,35.8003,35.7809],
      [9,60.4438,60.1368,59.8289,59.6745,58.8139,57.9325,57.3058,57.2516,57.0681,56.8421,56.7459,56.4505,56.0849,55.8808,55.7805,55.7099,55.6545,55.6025,55.5684,55.5543,55.52,55.4714,55.4621,55.4296,55.1838,55.1815,55.1795,55.1769,55.1719,55.1634,55.1571,55.1526,55.144,55.1373,55.1352,55.1289,55.1253,55.1232,55.1226,55.1212,55.1207,55.1207,55.1243,55.1278,55.1378,55.1561,55.202,55.2866,55.368,55.5501,55.6756,55.7377,55.8306,55.869,56.0359,56.2221,56.4047,56.6236,56.7586,56.9182,56.884,56.7397,56.7088],
      [9.5,95.797,95.3103,94.8224,94.5777,93.2138,91.8168,90.8236,90.7377,90.4468,90.0886,89.9362,89.468,88.8885,88.5651,88.4062,88.2943,88.2064,88.1241,88.0699,88.0476,87.9933,87.9162,87.9015,87.85,87.4604,87.4568,87.4537,87.4494,87.4415,87.4281,87.4181,87.4109,87.3974,87.3868,87.3834,87.3734,87.3677,87.3644,87.3635,87.3612,87.3604,87.3604,87.3662,87.3717,87.3875,87.4165,87.4893,87.6233,87.7523,88.041,88.2399,88.3382,88.4856,88.5464,88.8109,89.1061,89.3954,89.7424,89.9563,90.2093,90.155,89.9264,89.8774],
      [10,151.828,151.057,150.283,149.895,147.734,145.52,143.946,143.809,143.349,142.781,142.539,141.797,140.879,140.366,140.114,139.937,139.798,139.667,139.581,139.546,139.46,139.338,139.314,139.233,138.615,138.61,138.605,138.598,138.585,138.564,138.548,138.537,138.516,138.499,138.493,138.477,138.468,138.463,138.462,138.458,138.457,138.457,138.466,138.475,138.5,138.546,138.661,138.874,139.078,139.536,139.851,140.007,140.24,140.337,140.756,141.224,141.682,142.232,142.571,142.972,142.886,142.524,142.446],
      [10.5,240.631,239.409,238.183,237.568,234.142,230.633,228.139,227.923,227.192,226.292,225.91,224.734,223.278,222.465,222.066,221.785,221.565,221.358,221.222,221.166,221.029,220.835,220.799,220.669,219.691,219.682,219.674,219.663,219.643,219.609,219.584,219.566,219.532,219.506,219.497,219.472,219.458,219.45,219.447,219.441,219.439,219.439,219.454,219.468,219.508,219.58,219.763,220.1,220.424,221.149,221.649,221.896,222.266,222.418,223.083,223.824,224.551,225.423,225.96,226.595,226.459,225.885,225.762],
      [11,381.375,379.437,377.495,376.52,371.091,365.529,361.575,361.233,360.075,358.649,358.043,356.179,353.872,352.584,351.951,351.506,351.156,350.828,350.613,350.524,350.308,350.001,349.942,349.737,348.186,348.172,348.159,348.143,348.111,348.057,348.018,347.989,347.935,347.893,347.88,347.84,347.817,347.804,347.8,347.791,347.788,347.788,347.811,347.833,347.896,348.011,348.301,348.835,349.348,350.498,351.29,351.681,352.267,352.51,353.563,354.738,355.89,357.271,358.122,359.13,358.914,358.003,357.809],
      [11.5,604.438,601.368,598.289,596.745,588.139,579.325,573.058,572.516,570.681,568.421,567.459,564.505,560.849,558.808,557.805,557.099,556.545,556.025,555.684,555.543,555.2,554.714,554.621,554.296,551.838,551.815,551.795,551.769,551.719,551.634,551.571,551.526,551.44,551.373,551.352,551.289,551.253,551.232,551.226,551.212,551.207,551.207,551.243,551.278,551.378,551.561,552.02,552.866,553.68,555.501,556.756,557.377,558.306,558.69,560.359,562.221,564.047,566.236,567.586,569.182,568.84,567.397,567.088],
      [12,957.97,953.103,948.224,945.777,932.138,918.168,908.236,907.377,904.468,900.886,899.362,894.68,888.885,885.651,884.062,882.943,882.064,881.241,880.699,880.476,879.933,879.162,879.015,878.5,874.604,874.568,874.537,874.494,874.415,874.281,874.181,874.109,873.974,873.868,873.834,873.734,873.677,873.644,873.635,873.612,873.604,873.604,873.662,873.717,873.875,874.165,874.893,876.233,877.523,880.41,882.399,883.382,884.856,885.464,888.109,891.061,893.954,897.424,899.563,902.093,901.55,899.264,898.774],
      [12.5,1518.28,1510.57,1502.83,1498.95,1477.34,1455.2,1439.46,1438.09,1433.49,1427.81,1425.39,1417.97,1408.79,1403.66,1401.14,1399.37,1397.98,1396.67,1395.81,1395.46,1394.6,1393.38,1393.14,1392.33,1386.15,1386.1,1386.05,1385.98,1385.85,1385.64,1385.48,1385.37,1385.16,1384.99,1384.93,1384.77,1384.68,1384.63,1384.62,1384.58,1384.57,1384.57,1384.66,1384.75,1385,1385.46,1386.61,1388.74,1390.78,1395.36,1398.51,1400.07,1402.4,1403.37,1407.56,1412.24,1416.82,1422.32,1425.71,1429.72,1428.86,1425.24,1424.46],
      [13,2406.31,2394.09,2381.83,2375.68,2341.42,2306.33,2281.39,2279.23,2271.92,2262.92,2259.1,2247.34,2232.78,2224.65,2220.66,2217.85,2215.65,2213.58,2212.22,2211.66,2210.29,2208.35,2207.99,2206.69,2196.91,2196.82,2196.74,2196.63,2196.43,2196.09,2195.84,2195.66,2195.32,2195.06,2194.97,2194.72,2194.58,2194.5,2194.47,2194.41,2194.39,2194.39,2194.54,2194.68,2195.08,2195.8,2197.63,2201,2204.24,2211.49,2216.49,2218.96,2222.66,2224.18,2230.83,2238.24,2245.51,2254.23,2259.6,2265.95,2264.59,2258.85,2257.62]];

    var timeToSaturationArray_throughput_noQE =
      [[5,1.07256,1.06623,1.05975,1.05644,1.0371,1.01465,0.995589,0.99375,0.987235,0.978466,0.974434,0.960581,0.938933,0.923237,0.913978,0.906585,0.900116,0.893381,0.888507,0.886375,0.880828,0.871869,0.869978,0.862737,0.871174,0.861886,0.85791,0.854324,0.848301,0.839937,0.834896,0.83143,0.824504,0.81743,0.815113,0.809342,0.806548,0.804172,0.802932,0.798506,0.794478,0.791885,0.781845,0.777503,0.769355,0.758817,0.741466,0.719593,0.700799,0.663754,0.638654,0.625598,0.607646,0.600683,0.567916,0.531407,0.494721,0.44836,0.412838,0.342585,0.301133,0.264018,0.258538],
      [5.5,1.6999,1.68986,1.67959,1.67435,1.6437,1.6081,1.5779,1.57499,1.56466,1.55076,1.54437,1.52242,1.48811,1.46323,1.44856,1.43684,1.42659,1.41591,1.40819,1.40481,1.39602,1.38182,1.37882,1.36735,1.38072,1.366,1.35969,1.35401,1.34447,1.33121,1.32322,1.31773,1.30675,1.29554,1.29187,1.28272,1.27829,1.27453,1.27256,1.26555,1.25916,1.25505,1.23914,1.23226,1.21934,1.20264,1.17514,1.14048,1.11069,1.05198,1.0122,0.991506,0.963054,0.952018,0.900086,0.842224,0.784079,0.710602,0.654304,0.542961,0.477264,0.418441,0.409756],
      [6,2.69416,2.67824,2.66197,2.65367,2.60508,2.54867,2.50081,2.49619,2.47982,2.4578,2.44767,2.41287,2.35849,2.31907,2.29581,2.27724,2.26099,2.24407,2.23183,2.22647,2.21254,2.19004,2.18529,2.1671,2.18829,2.16496,2.15497,2.14596,2.13084,2.10983,2.09716,2.08846,2.07106,2.05329,2.04747,2.03298,2.02596,2.01999,2.01687,2.00576,1.99564,1.98912,1.9639,1.953,1.93253,1.90606,1.86248,1.80754,1.76033,1.66727,1.60423,1.57143,1.52634,1.50885,1.42654,1.33483,1.24268,1.12623,1.037,0.860536,0.756412,0.663184,0.649419],
      [6.5,4.26995,4.24473,4.21893,4.20578,4.12878,4.03938,3.96351,3.95619,3.93025,3.89534,3.87929,3.82414,3.73796,3.67547,3.63861,3.60918,3.58343,3.55661,3.53721,3.52872,3.50664,3.47097,3.46345,3.43462,3.46821,3.43123,3.4154,3.40112,3.37715,3.34385,3.32378,3.30998,3.28241,3.25425,3.24502,3.22205,3.21093,3.20146,3.19653,3.17891,3.16287,3.15255,3.11258,3.09529,3.06286,3.0209,2.95183,2.86475,2.78993,2.64245,2.54253,2.49055,2.41908,2.39136,2.26091,2.11557,1.96952,1.78495,1.64354,1.36386,1.19883,1.05108,1.02926],
      [7,6.76742,6.72744,6.68656,6.66571,6.54367,6.40198,6.28174,6.27014,6.22903,6.1737,6.14826,6.06086,5.92427,5.82523,5.76681,5.72016,5.67935,5.63685,5.6061,5.59265,5.55765,5.50112,5.48919,5.4435,5.49674,5.43813,5.41304,5.39042,5.35242,5.29964,5.26784,5.24597,5.20227,5.15764,5.14302,5.1066,5.08897,5.07398,5.06616,5.03823,5.01282,4.99646,4.93311,4.90571,4.8543,4.78781,4.67833,4.54032,4.42175,4.188,4.02964,3.94726,3.83399,3.79005,3.58331,3.35295,3.12148,2.82896,2.60483,2.16157,1.90002,1.66584,1.63127],
      [7.5,10.7256,10.6623,10.5975,10.5644,10.371,10.1465,9.95589,9.9375,9.87235,9.78466,9.74434,9.60581,9.38933,9.23237,9.13978,9.06585,9.00116,8.93381,8.88507,8.86375,8.80828,8.71869,8.69978,8.62737,8.71174,8.61886,8.5791,8.54324,8.48301,8.39937,8.34896,8.3143,8.24504,8.1743,8.15113,8.09342,8.06548,8.04172,8.02932,7.98506,7.94478,7.91885,7.81845,7.77503,7.69355,7.58817,7.41466,7.19593,7.00799,6.63754,6.38654,6.25598,6.07646,6.00683,5.67916,5.31407,4.94721,4.4836,4.12838,3.42585,3.01133,2.64018,2.58538],
      [8,16.999,16.8986,16.7959,16.7435,16.437,16.081,15.779,15.7499,15.6466,15.5076,15.4437,15.2242,14.8811,14.6323,14.4856,14.3684,14.2659,14.1591,14.0819,14.0481,13.9602,13.8182,13.7882,13.6735,13.8072,13.66,13.5969,13.5401,13.4447,13.3121,13.2322,13.1773,13.0675,12.9554,12.9187,12.8272,12.7829,12.7453,12.7256,12.6555,12.5916,12.5505,12.3914,12.3226,12.1934,12.0264,11.7514,11.4048,11.1069,10.5198,10.122,9.91506,9.63054,9.52018,9.00086,8.42224,7.84079,7.10602,6.54304,5.42961,4.77264,4.18441,4.09756],
      [8.5,26.9416,26.7824,26.6197,26.5367,26.0508,25.4867,25.0081,24.9619,24.7982,24.578,24.4767,24.1287,23.5849,23.1907,22.9581,22.7724,22.6099,22.4407,22.3183,22.2647,22.1254,21.9004,21.8529,21.671,21.8829,21.6496,21.5497,21.4596,21.3084,21.0983,20.9716,20.8846,20.7106,20.5329,20.4747,20.3298,20.2596,20.1999,20.1687,20.0576,19.9564,19.8912,19.639,19.53,19.3253,19.0606,18.6248,18.0754,17.6033,16.6727,16.0423,15.7143,15.2634,15.0885,14.2654,13.3483,12.4268,11.2623,10.37,8.60536,7.56412,6.63184,6.49419],
      [9,42.6995,42.4473,42.1893,42.0578,41.2878,40.3938,39.6351,39.5619,39.3025,38.9534,38.7929,38.2414,37.3796,36.7547,36.3861,36.0918,35.8343,35.5661,35.3721,35.2872,35.0664,34.7097,34.6345,34.3462,34.6821,34.3123,34.154,34.0112,33.7715,33.4385,33.2378,33.0998,32.8241,32.5425,32.4502,32.2205,32.1093,32.0146,31.9653,31.7891,31.6287,31.5255,31.1258,30.9529,30.6286,30.209,29.5183,28.6475,27.8993,26.4245,25.4253,24.9055,24.1908,23.9136,22.6091,21.1557,19.6952,17.8495,16.4354,13.6386,11.9883,10.5108,10.2926],
      [9.5,67.6742,67.2744,66.8656,66.6571,65.4367,64.0198,62.8174,62.7014,62.2903,61.737,61.4826,60.6086,59.2427,58.2523,57.6681,57.2016,56.7935,56.3685,56.061,55.9265,55.5765,55.0112,54.8919,54.435,54.9674,54.3813,54.1304,53.9042,53.5242,52.9964,52.6784,52.4597,52.0227,51.5764,51.4302,51.066,50.8897,50.7398,50.6616,50.3823,50.1282,49.9646,49.3311,49.0571,48.543,47.8781,46.7833,45.4032,44.2175,41.88,40.2964,39.4726,38.3399,37.9005,35.8331,33.5295,31.2148,28.2896,26.0483,21.6157,19.0002,16.6584,16.3127],
      [10,107.256,106.623,105.975,105.644,103.71,101.465,99.5589,99.375,98.7235,97.8466,97.4434,96.0581,93.8933,92.3237,91.3978,90.6585,90.0116,89.3381,88.8507,88.6375,88.0828,87.1869,86.9978,86.2737,87.1174,86.1886,85.791,85.4324,84.8301,83.9937,83.4896,83.143,82.4504,81.743,81.5113,80.9342,80.6548,80.4172,80.2932,79.8506,79.4478,79.1885,78.1845,77.7503,76.9355,75.8817,74.1466,71.9593,70.0799,66.3754,63.8654,62.5598,60.7646,60.0683,56.7916,53.1407,49.4721,44.836,41.2838,34.2585,30.1133,26.4018,25.8538],
      [10.5,169.99,168.986,167.959,167.435,164.37,160.81,157.79,157.499,156.466,155.076,154.437,152.242,148.811,146.323,144.856,143.684,142.659,141.591,140.819,140.481,139.602,138.182,137.882,136.735,138.072,136.6,135.969,135.401,134.447,133.121,132.322,131.773,130.675,129.554,129.187,128.272,127.829,127.453,127.256,126.555,125.916,125.505,123.914,123.226,121.934,120.264,117.514,114.048,111.069,105.198,101.22,99.1506,96.3054,95.2018,90.0086,84.2224,78.4079,71.0602,65.4304,54.2961,47.7264,41.8441,40.9756],
      [11,269.416,267.824,266.197,265.367,260.508,254.867,250.081,249.619,247.982,245.78,244.767,241.287,235.849,231.907,229.581,227.724,226.099,224.407,223.183,222.647,221.254,219.004,218.529,216.71,218.829,216.496,215.497,214.596,213.084,210.983,209.716,208.846,207.106,205.329,204.747,203.298,202.596,201.999,201.687,200.576,199.564,198.912,196.39,195.3,193.253,190.606,186.248,180.754,176.033,166.727,160.423,157.143,152.634,150.885,142.654,133.483,124.268,112.623,103.7,86.0536,75.6412,66.3184,64.9419],
      [11.5,426.995,424.473,421.893,420.578,412.878,403.938,396.351,395.619,393.025,389.534,387.929,382.414,373.796,367.547,363.861,360.918,358.343,355.661,353.721,352.872,350.664,347.097,346.345,343.462,346.821,343.123,341.54,340.112,337.715,334.385,332.378,330.998,328.241,325.425,324.502,322.205,321.093,320.146,319.653,317.891,316.287,315.255,311.258,309.529,306.286,302.09,295.183,286.475,278.993,264.245,254.253,249.055,241.908,239.136,226.091,211.557,196.952,178.495,164.354,136.386,119.883,105.108,102.926],
      [12,676.742,672.744,668.656,666.571,654.367,640.198,628.174,627.014,622.903,617.37,614.826,606.086,592.427,582.523,576.681,572.016,567.935,563.685,560.61,559.265,555.765,550.112,548.919,544.35,549.674,543.813,541.304,539.042,535.242,529.964,526.784,524.597,520.227,515.764,514.302,510.66,508.897,507.398,506.616,503.823,501.282,499.646,493.311,490.571,485.43,478.781,467.833,454.032,442.175,418.8,402.964,394.726,383.399,379.005,358.331,335.295,312.148,282.896,260.483,216.157,190.002,166.584,163.127],
      [12.5,1072.56,1066.23,1059.75,1056.44,1037.1,1014.65,995.589,993.75,987.235,978.466,974.434,960.581,938.933,923.237,913.978,906.585,900.116,893.381,888.507,886.375,880.828,871.869,869.978,862.737,871.174,861.886,857.91,854.324,848.301,839.937,834.896,831.43,824.504,817.43,815.113,809.342,806.548,804.172,802.932,798.506,794.478,791.885,781.845,777.503,769.355,758.817,741.466,719.593,700.799,663.754,638.654,625.598,607.646,600.683,567.916,531.407,494.721,448.36,412.838,342.585,301.133,264.018,258.538],
      [13,1699.9,1689.86,1679.59,1674.35,1643.7,1608.1,1577.9,1574.99,1564.66,1550.76,1544.37,1522.42,1488.11,1463.23,1448.56,1436.84,1426.59,1415.91,1408.19,1404.81,1396.02,1381.82,1378.82,1367.35,1380.72,1366,1359.69,1354.01,1344.47,1331.21,1323.22,1317.73,1306.75,1295.54,1291.87,1282.72,1278.29,1274.53,1272.56,1265.55,1259.16,1255.05,1239.14,1232.26,1219.34,1202.64,1175.14,1140.48,1110.69,1051.98,1012.2,991.506,963.054,952.018,900.086,842.224,784.079,710.602,654.304,542.961,477.264,418.441,409.756]];

    var timeToSaturationArray_noThroughput_QE =
      [[5,1.14675,1.14298,1.13943,1.13775,1.12999,1.12604,1.12702,1.12731,1.12853,1.13068,1.13183,1.13639,1.1447,1.15113,1.15496,1.15801,1.16066,1.16339,1.16535,1.1662,1.1684,1.1719,1.17263,1.17539,1.1767,1.17961,1.18092,1.18213,1.18421,1.18724,1.18913,1.19043,1.19308,1.19576,1.19663,1.19873,1.19975,1.20062,1.20107,1.20265,1.20409,1.20498,1.20829,1.20968,1.21221,1.21545,1.2204,1.22615,1.23052,1.23871,1.2433,1.24541,1.24855,1.24983,1.2552,1.26124,1.26765,1.27658,1.28331,1.29614,1.30257,1.30734,1.30815],
      [5.5,1.81748,1.8115,1.80587,1.80321,1.79091,1.78465,1.78621,1.78666,1.7886,1.79201,1.79383,1.80105,1.81422,1.82441,1.83048,1.83532,1.83952,1.84385,1.84696,1.84831,1.8518,1.85734,1.85849,1.86287,1.86494,1.86956,1.87163,1.87355,1.87684,1.88164,1.88465,1.88671,1.8909,1.89516,1.89654,1.89986,1.90148,1.90285,1.90357,1.90607,1.90835,1.90976,1.91501,1.91722,1.92123,1.92635,1.9342,1.94332,1.95024,1.96322,1.9705,1.97385,1.97881,1.98085,1.98935,1.99894,2.00909,2.02324,2.03391,2.05425,2.06443,2.07199,2.07328],
      [6,2.88052,2.87103,2.86211,2.85789,2.8384,2.82848,2.83096,2.83166,2.83475,2.84014,2.84303,2.85447,2.87535,2.8915,2.90112,2.90878,2.91544,2.92231,2.92723,2.92937,2.9349,2.94368,2.94552,2.95245,2.95573,2.96305,2.96633,2.96937,2.97459,2.9822,2.98697,2.99023,2.99688,3.00362,3.00581,3.01108,3.01364,3.01582,3.01695,3.02092,3.02453,3.02677,3.03508,3.03859,3.04495,3.05306,3.06551,3.07995,3.09093,3.11149,3.12303,3.12833,3.13621,3.13944,3.15291,3.1681,3.18419,3.20661,3.22353,3.25576,3.27191,3.28389,3.28593],
      [6.5,4.56531,4.55027,4.53614,4.52946,4.49856,4.48283,4.48676,4.48789,4.49277,4.50132,4.50589,4.52403,4.55712,4.58272,4.59797,4.61011,4.62066,4.63155,4.63935,4.64275,4.6515,4.66543,4.66833,4.67932,4.68452,4.69612,4.70132,4.70614,4.71441,4.72648,4.73403,4.7392,4.74973,4.76042,4.76389,4.77224,4.7763,4.77975,4.78155,4.78784,4.79356,4.79711,4.81028,4.81584,4.82591,4.83878,4.8585,4.88139,4.89879,4.93138,4.94967,4.95807,4.97055,4.97568,4.99703,5.02111,5.04659,5.08214,5.10895,5.16003,5.18563,5.20461,5.20785],
      [7,7.23553,7.21169,7.1893,7.17871,7.12974,7.10481,7.11104,7.11282,7.12056,7.13411,7.14136,7.17011,7.22255,7.26312,7.28729,7.30653,7.32326,7.34051,7.35288,7.35826,7.37213,7.3942,7.3988,7.41623,7.42447,7.44284,7.45109,7.45873,7.47184,7.49096,7.50293,7.51112,7.52782,7.54476,7.55025,7.5635,7.56992,7.5754,7.57824,7.58821,7.59729,7.6029,7.62379,7.63259,7.64856,7.66894,7.70021,7.73648,7.76406,7.81571,7.8447,7.85802,7.8778,7.88592,7.91975,7.95792,7.99831,8.05465,8.09713,8.1781,8.21866,8.24875,8.25389],
      [7.5,11.4675,11.4298,11.3943,11.3775,11.2999,11.2604,11.2702,11.2731,11.2853,11.3068,11.3183,11.3639,11.447,11.5113,11.5496,11.5801,11.6066,11.6339,11.6535,11.662,11.684,11.719,11.7263,11.7539,11.767,11.7961,11.8092,11.8213,11.8421,11.8724,11.8913,11.9043,11.9308,11.9576,11.9663,11.9873,11.9975,12.0062,12.0107,12.0265,12.0409,12.0498,12.0829,12.0968,12.1221,12.1545,12.204,12.2615,12.3052,12.3871,12.433,12.4541,12.4855,12.4983,12.552,12.6124,12.6765,12.7658,12.8331,12.9614,13.0257,13.0734,13.0815],
      [8,18.1748,18.115,18.0587,18.0321,17.9091,17.8465,17.8621,17.8666,17.886,17.9201,17.9383,18.0105,18.1422,18.2441,18.3048,18.3532,18.3952,18.4385,18.4696,18.4831,18.518,18.5734,18.5849,18.6287,18.6494,18.6956,18.7163,18.7355,18.7684,18.8164,18.8465,18.8671,18.909,18.9516,18.9654,18.9986,19.0148,19.0285,19.0357,19.0607,19.0835,19.0976,19.1501,19.1722,19.2123,19.2635,19.342,19.4332,19.5024,19.6322,19.705,19.7385,19.7881,19.8085,19.8935,19.9894,20.0909,20.2324,20.3391,20.5425,20.6443,20.7199,20.7328],
      [8.5,28.8052,28.7103,28.6211,28.5789,28.384,28.2848,28.3096,28.3166,28.3475,28.4014,28.4303,28.5447,28.7535,28.915,29.0112,29.0878,29.1544,29.2231,29.2723,29.2937,29.349,29.4368,29.4552,29.5245,29.5573,29.6305,29.6633,29.6937,29.7459,29.822,29.8697,29.9023,29.9688,30.0362,30.0581,30.1108,30.1364,30.1582,30.1695,30.2092,30.2453,30.2677,30.3508,30.3859,30.4495,30.5306,30.6551,30.7995,30.9093,31.1149,31.2303,31.2833,31.3621,31.3944,31.5291,31.681,31.8419,32.0661,32.2353,32.5576,32.7191,32.8389,32.8593],
      [9,45.6531,45.5027,45.3614,45.2946,44.9856,44.8283,44.8676,44.8789,44.9277,45.0132,45.0589,45.2403,45.5712,45.8272,45.9797,46.1011,46.2066,46.3155,46.3935,46.4275,46.515,46.6543,46.6833,46.7932,46.8452,46.9612,47.0132,47.0614,47.1441,47.2648,47.3403,47.392,47.4973,47.6042,47.6389,47.7224,47.763,47.7975,47.8155,47.8784,47.9356,47.9711,48.1028,48.1584,48.2591,48.3878,48.585,48.8139,48.9879,49.3138,49.4967,49.5807,49.7055,49.7568,49.9703,50.2111,50.4659,50.8214,51.0895,51.6003,51.8563,52.0461,52.0785],
      [9.5,72.3553,72.1169,71.893,71.7871,71.2974,71.0481,71.1104,71.1282,71.2056,71.3411,71.4136,71.7011,72.2255,72.6312,72.8729,73.0653,73.2326,73.4051,73.5288,73.5826,73.7213,73.942,73.988,74.1623,74.2447,74.4284,74.5109,74.5873,74.7184,74.9096,75.0293,75.1112,75.2782,75.4476,75.5025,75.635,75.6992,75.754,75.7824,75.8821,75.9729,76.029,76.2379,76.3259,76.4856,76.6894,77.0021,77.3648,77.6406,78.1571,78.447,78.5802,78.778,78.8592,79.1975,79.5792,79.9831,80.5465,80.9713,81.781,82.1866,82.4875,82.5389],
      [10,114.675,114.298,113.943,113.775,112.999,112.604,112.702,112.731,112.853,113.068,113.183,113.639,114.47,115.113,115.496,115.801,116.066,116.339,116.535,116.62,116.84,117.19,117.263,117.539,117.67,117.961,118.092,118.213,118.421,118.724,118.913,119.043,119.308,119.576,119.663,119.873,119.975,120.062,120.107,120.265,120.409,120.498,120.829,120.968,121.221,121.545,122.04,122.615,123.052,123.871,124.33,124.541,124.855,124.983,125.52,126.124,126.765,127.658,128.331,129.614,130.257,130.734,130.815],
      [10.5,181.748,181.15,180.587,180.321,179.091,178.465,178.621,178.666,178.86,179.201,179.383,180.105,181.422,182.441,183.048,183.532,183.952,184.385,184.696,184.831,185.18,185.734,185.849,186.287,186.494,186.956,187.163,187.355,187.684,188.164,188.465,188.671,189.09,189.516,189.654,189.986,190.148,190.285,190.357,190.607,190.835,190.976,191.501,191.722,192.123,192.635,193.42,194.332,195.024,196.322,197.05,197.385,197.881,198.085,198.935,199.894,200.909,202.324,203.391,205.425,206.443,207.199,207.328],
      [11,288.052,287.103,286.211,285.789,283.84,282.848,283.096,283.166,283.475,284.014,284.303,285.447,287.535,289.15,290.112,290.878,291.544,292.231,292.723,292.937,293.49,294.368,294.552,295.245,295.573,296.305,296.633,296.937,297.459,298.22,298.697,299.023,299.688,300.362,300.581,301.108,301.364,301.582,301.695,302.092,302.453,302.677,303.508,303.859,304.495,305.306,306.551,307.995,309.093,311.149,312.303,312.833,313.621,313.944,315.291,316.81,318.419,320.661,322.353,325.576,327.191,328.389,328.593],
      [11.5,456.531,455.027,453.614,452.946,449.856,448.283,448.676,448.789,449.277,450.132,450.589,452.403,455.712,458.272,459.797,461.011,462.066,463.155,463.935,464.275,465.15,466.543,466.833,467.932,468.452,469.612,470.132,470.614,471.441,472.648,473.403,473.92,474.973,476.042,476.389,477.224,477.63,477.975,478.155,478.784,479.356,479.711,481.028,481.584,482.591,483.878,485.85,488.139,489.879,493.138,494.967,495.807,497.055,497.568,499.703,502.111,504.659,508.214,510.895,516.003,518.563,520.461,520.785],
      [12,723.553,721.169,718.93,717.871,712.974,710.481,711.104,711.282,712.056,713.411,714.136,717.011,722.255,726.312,728.729,730.653,732.326,734.051,735.288,735.826,737.213,739.42,739.88,741.623,742.447,744.284,745.109,745.873,747.184,749.096,750.293,751.112,752.782,754.476,755.025,756.35,756.992,757.54,757.824,758.821,759.729,760.29,762.379,763.259,764.856,766.894,770.021,773.648,776.406,781.571,784.47,785.802,787.78,788.592,791.975,795.792,799.831,805.465,809.713,817.81,821.866,824.875,825.389],
      [12.5,1146.75,1142.98,1139.43,1137.75,1129.99,1126.04,1127.02,1127.31,1128.53,1130.68,1131.83,1136.39,1144.7,1151.13,1154.96,1158.01,1160.66,1163.39,1165.35,1166.2,1168.4,1171.9,1172.63,1175.39,1176.7,1179.61,1180.92,1182.13,1184.21,1187.24,1189.13,1190.43,1193.08,1195.76,1196.63,1198.73,1199.75,1200.62,1201.07,1202.65,1204.09,1204.98,1208.29,1209.68,1212.21,1215.45,1220.4,1226.15,1230.52,1238.71,1243.3,1245.41,1248.55,1249.83,1255.2,1261.24,1267.65,1276.58,1283.31,1296.14,1302.57,1307.34,1308.15],
      [13,1817.48,1811.5,1805.87,1803.21,1790.91,1784.65,1786.21,1786.66,1788.6,1792.01,1793.83,1801.05,1814.22,1824.41,1830.48,1835.32,1839.52,1843.85,1846.96,1848.31,1851.8,1857.34,1858.49,1862.87,1864.94,1869.56,1871.63,1873.55,1876.84,1881.64,1884.65,1886.71,1890.9,1895.16,1896.54,1899.86,1901.48,1902.85,1903.57,1906.07,1908.35,1909.76,1915.01,1917.22,1921.23,1926.35,1934.2,1943.32,1950.24,1963.22,1970.5,1973.85,1978.81,1980.85,1989.35,1998.94,2009.09,2023.24,2033.91,2054.25,2064.43,2071.99,2073.28]];

    var timeToSaturationArray_noThroughput_noQE =
      [[5,0.685114,0.683854,0.682841,0.682439,0.681822,0.685075,0.690688,0.691323,0.693651,0.696892,0.698388,0.703342,0.709753,0.712902,0.71408,0.714648,0.714872,0.714837,0.714644,0.714516,0.714059,0.712954,0.712664,0.711376,0.729669,0.725261,0.723463,0.721902,0.719332,0.715941,0.713997,0.712652,0.709986,0.707159,0.706209,0.70378,0.702622,0.701599,0.701046,0.699013,0.697118,0.695849,0.690649,0.688287,0.683663,0.677449,0.666316,0.650686,0.636328,0.606742,0.585735,0.574628,0.559304,0.553343,0.524985,0.49312,0.460908,0.419964,0.388329,0.324971,0.287101,0.252886,0.247809],
      [5.5,1.08583,1.08384,1.08223,1.08159,1.08061,1.08577,1.09467,1.09567,1.09936,1.1045,1.10687,1.11472,1.12488,1.12987,1.13174,1.13264,1.133,1.13294,1.13263,1.13243,1.13171,1.12996,1.1295,1.12746,1.15645,1.14946,1.14661,1.14414,1.14006,1.13469,1.13161,1.12948,1.12525,1.12077,1.11927,1.11542,1.11358,1.11196,1.11108,1.10786,1.10486,1.10285,1.09461,1.09086,1.08353,1.07368,1.05604,1.03127,1.00851,0.961622,0.928328,0.910725,0.886437,0.876989,0.832045,0.781543,0.730489,0.665598,0.61546,0.515045,0.455025,0.400797,0.392751],
      [6,1.72093,1.71776,1.71522,1.71421,1.71266,1.72083,1.73493,1.73652,1.74237,1.75051,1.75427,1.76672,1.78282,1.79073,1.79369,1.79511,1.79568,1.79559,1.7951,1.79478,1.79363,1.79086,1.79013,1.7869,1.83284,1.82177,1.81726,1.81333,1.80688,1.79836,1.79348,1.7901,1.7834,1.7763,1.77392,1.76782,1.76491,1.76234,1.76095,1.75584,1.75108,1.74789,1.73483,1.7289,1.71728,1.70168,1.67371,1.63445,1.59838,1.52407,1.4713,1.4434,1.40491,1.38993,1.3187,1.23866,1.15775,1.0549,0.975438,0.816291,0.721165,0.63522,0.622468],
      [6.5,2.72749,2.72247,2.71844,2.71684,2.71438,2.72733,2.74968,2.7522,2.76147,2.77438,2.78033,2.80006,2.82558,2.83811,2.8428,2.84506,2.84596,2.84582,2.84505,2.84454,2.84272,2.83832,2.83716,2.83204,2.90486,2.88732,2.88016,2.87394,2.86371,2.85021,2.84247,2.83712,2.82651,2.81525,2.81147,2.8018,2.79719,2.79312,2.79092,2.78282,2.77527,2.77022,2.74952,2.74012,2.72171,2.69697,2.65265,2.59043,2.53327,2.41548,2.33185,2.28764,2.22663,2.2029,2.09,1.96315,1.83491,1.67191,1.54596,1.29373,1.14297,1.00676,0.986545],
      [7,4.32277,4.31483,4.30843,4.3059,4.302,4.32253,4.35794,4.36195,4.37664,4.39709,4.40653,4.43779,4.47824,4.49811,4.50554,4.50912,4.51054,4.51032,4.5091,4.50829,4.50541,4.49843,4.4966,4.48848,4.6039,4.57609,4.56474,4.55489,4.53868,4.51728,4.50502,4.49653,4.47971,4.46187,4.45588,4.44055,4.43324,4.42679,4.4233,4.41047,4.39851,4.39051,4.3577,4.3428,4.31362,4.27441,4.20417,4.10555,4.01496,3.82828,3.69574,3.62566,3.52897,3.49136,3.31243,3.11138,2.90813,2.64979,2.45019,2.05043,1.81149,1.5956,1.56357],
      [7.5,6.85114,6.83854,6.82841,6.82439,6.81822,6.85075,6.90688,6.91323,6.93651,6.96892,6.98388,7.03342,7.09753,7.12902,7.1408,7.14648,7.14872,7.14837,7.14644,7.14516,7.14059,7.12954,7.12664,7.11376,7.29669,7.25261,7.23463,7.21902,7.19332,7.15941,7.13997,7.12652,7.09986,7.07159,7.06209,7.0378,7.02622,7.01599,7.01046,6.99013,6.97118,6.95849,6.90649,6.88287,6.83663,6.77449,6.66316,6.50686,6.36328,6.06742,5.85735,5.74628,5.59304,5.53343,5.24985,4.9312,4.60908,4.19964,3.88329,3.24971,2.87101,2.52886,2.47809],
      [8,10.8583,10.8384,10.8223,10.8159,10.8061,10.8577,10.9467,10.9567,10.9936,11.045,11.0687,11.1472,11.2488,11.2987,11.3174,11.3264,11.33,11.3294,11.3263,11.3243,11.3171,11.2996,11.295,11.2746,11.5645,11.4946,11.4661,11.4414,11.4006,11.3469,11.3161,11.2948,11.2525,11.2077,11.1927,11.1542,11.1358,11.1196,11.1108,11.0786,11.0486,11.0285,10.9461,10.9086,10.8353,10.7368,10.5604,10.3127,10.0851,9.61622,9.28328,9.10725,8.86437,8.76989,8.32045,7.81543,7.30489,6.65598,6.1546,5.15045,4.55025,4.00797,3.92751],
      [8.5,17.2093,17.1776,17.1522,17.1421,17.1266,17.2083,17.3493,17.3652,17.4237,17.5051,17.5427,17.6672,17.8282,17.9073,17.9369,17.9511,17.9568,17.9559,17.951,17.9478,17.9363,17.9086,17.9013,17.869,18.3284,18.2177,18.1726,18.1333,18.0688,17.9836,17.9348,17.901,17.834,17.763,17.7392,17.6782,17.6491,17.6234,17.6095,17.5584,17.5108,17.4789,17.3483,17.289,17.1728,17.0168,16.7371,16.3445,15.9838,15.2407,14.713,14.434,14.0491,13.8993,13.187,12.3866,11.5775,10.549,9.75438,8.16291,7.21165,6.3522,6.22468],
      [9,27.2749,27.2247,27.1844,27.1684,27.1438,27.2733,27.4968,27.522,27.6147,27.7438,27.8033,28.0006,28.2558,28.3811,28.428,28.4506,28.4596,28.4582,28.4505,28.4454,28.4272,28.3832,28.3716,28.3204,29.0486,28.8732,28.8016,28.7394,28.6371,28.5021,28.4247,28.3712,28.2651,28.1525,28.1147,28.018,27.9719,27.9312,27.9092,27.8282,27.7527,27.7022,27.4952,27.4012,27.2171,26.9697,26.5265,25.9043,25.3327,24.1548,23.3185,22.8764,22.2663,22.029,20.9,19.6315,18.3491,16.7191,15.4596,12.9373,11.4297,10.0676,9.86545],
      [9.5,43.2277,43.1483,43.0843,43.059,43.02,43.2253,43.5794,43.6195,43.7664,43.9709,44.0653,44.3779,44.7824,44.9811,45.0554,45.0912,45.1054,45.1032,45.091,45.0829,45.0541,44.9843,44.966,44.8848,46.039,45.7609,45.6474,45.5489,45.3868,45.1728,45.0502,44.9653,44.7971,44.6187,44.5588,44.4055,44.3324,44.2679,44.233,44.1047,43.9851,43.9051,43.577,43.428,43.1362,42.7441,42.0417,41.0555,40.1496,38.2828,36.9574,36.2566,35.2897,34.9136,33.1243,31.1138,29.0813,26.4979,24.5019,20.5043,18.1149,15.956,15.6357],
      [10,68.5114,68.3854,68.2841,68.2439,68.1822,68.5075,69.0688,69.1323,69.3651,69.6892,69.8388,70.3342,70.9753,71.2902,71.408,71.4648,71.4872,71.4837,71.4644,71.4516,71.4059,71.2954,71.2664,71.1376,72.9669,72.5261,72.3463,72.1902,71.9332,71.5941,71.3997,71.2652,70.9986,70.7159,70.6209,70.378,70.2622,70.1599,70.1046,69.9013,69.7118,69.5849,69.0649,68.8287,68.3663,67.7449,66.6316,65.0686,63.6328,60.6742,58.5735,57.4628,55.9304,55.3343,52.4985,49.312,46.0908,41.9964,38.8329,32.4971,28.7101,25.2886,24.7809],
      [10.5,108.583,108.384,108.223,108.159,108.061,108.577,109.467,109.567,109.936,110.45,110.687,111.472,112.488,112.987,113.174,113.264,113.3,113.294,113.263,113.243,113.171,112.996,112.95,112.746,115.645,114.946,114.661,114.414,114.006,113.469,113.161,112.948,112.525,112.077,111.927,111.542,111.358,111.196,111.108,110.786,110.486,110.285,109.461,109.086,108.353,107.368,105.604,103.127,100.851,96.1622,92.8328,91.0725,88.6437,87.6989,83.2045,78.1543,73.0489,66.5598,61.546,51.5045,45.5025,40.0797,39.2751],
      [11,172.093,171.776,171.522,171.421,171.266,172.083,173.493,173.652,174.237,175.051,175.427,176.672,178.282,179.073,179.369,179.511,179.568,179.559,179.51,179.478,179.363,179.086,179.013,178.69,183.284,182.177,181.726,181.333,180.688,179.836,179.348,179.01,178.34,177.63,177.392,176.782,176.491,176.234,176.095,175.584,175.108,174.789,173.483,172.89,171.728,170.168,167.371,163.445,159.838,152.407,147.13,144.34,140.491,138.993,131.87,123.866,115.775,105.49,97.5438,81.6291,72.1165,63.522,62.2468],
      [11.5,272.749,272.247,271.844,271.684,271.438,272.733,274.968,275.22,276.147,277.438,278.033,280.006,282.558,283.811,284.28,284.506,284.596,284.582,284.505,284.454,284.272,283.832,283.716,283.204,290.486,288.732,288.016,287.394,286.371,285.021,284.247,283.712,282.651,281.525,281.147,280.18,279.719,279.312,279.092,278.282,277.527,277.022,274.952,274.012,272.171,269.697,265.265,259.043,253.327,241.548,233.185,228.764,222.663,220.29,209,196.315,183.491,167.191,154.596,129.373,114.297,100.676,98.6545],
      [12,432.277,431.483,430.843,430.59,430.2,432.253,435.794,436.195,437.664,439.709,440.653,443.779,447.824,449.811,450.554,450.912,451.054,451.032,450.91,450.829,450.541,449.843,449.66,448.848,460.39,457.609,456.474,455.489,453.868,451.728,450.502,449.653,447.971,446.187,445.588,444.055,443.324,442.679,442.33,441.047,439.851,439.051,435.77,434.28,431.362,427.441,420.417,410.555,401.496,382.828,369.574,362.566,352.897,349.136,331.243,311.138,290.813,264.979,245.019,205.043,181.149,159.56,156.357],
      [12.5,685.114,683.854,682.841,682.439,681.822,685.075,690.688,691.323,693.651,696.892,698.388,703.342,709.753,712.902,714.08,714.648,714.872,714.837,714.644,714.516,714.059,712.954,712.664,711.376,729.669,725.261,723.463,721.902,719.332,715.941,713.997,712.652,709.986,707.159,706.209,703.78,702.622,701.599,701.046,699.013,697.118,695.849,690.649,688.287,683.663,677.449,666.316,650.686,636.328,606.742,585.735,574.628,559.304,553.343,524.985,493.12,460.908,419.964,388.329,324.971,287.101,252.886,247.809],
      [13,1085.83,1083.84,1082.23,1081.59,1080.61,1085.77,1094.67,1095.67,1099.36,1104.5,1106.87,1114.72,1124.88,1129.87,1131.74,1132.64,1133,1132.94,1132.63,1132.43,1131.71,1129.96,1129.5,1127.46,1156.45,1149.46,1146.61,1144.14,1140.06,1134.69,1131.61,1129.48,1125.25,1120.77,1119.27,1115.42,1113.58,1111.96,1111.08,1107.86,1104.86,1102.85,1094.61,1090.86,1083.53,1073.68,1056.04,1031.27,1008.51,961.622,928.328,910.725,886.437,876.989,832.045,781.543,730.489,665.598,615.46,515.045,455.025,400.797,392.751]];

    var timeToSaturationArray_throughput_QE_bb =
      [[5,1.51828,1.51057,1.50283,1.49895,1.47734,1.4552,1.43946,1.43809,1.43349,1.42781,1.42539,1.41797,1.40879,1.40366,1.40114,1.39937,1.39798,1.39667,1.39581,1.39546,1.3946,1.39338,1.39314,1.39233,1.39168,1.391,1.39075,1.39053,1.39022,1.38986,1.38969,1.38958,1.38942,1.38932,1.3893,1.38926,1.38926,1.38926,1.38927,1.38929,1.38933,1.38937,1.38956,1.38967,1.38991,1.39027,1.39102,1.39211,1.39318,1.39513,1.39653,1.39735,1.39833,1.39868,1.4005,1.40249,1.40466,1.40778,1.41024,1.41445,1.41689,1.41914,1.41982],
      [5.5,2.40631,2.39409,2.38183,2.37568,2.34142,2.30633,2.28139,2.27923,2.27192,2.26292,2.2591,2.24734,2.23278,2.22465,2.22066,2.21785,2.21565,2.21358,2.21222,2.21166,2.21029,2.20835,2.20799,2.20669,2.20566,2.20458,2.20418,2.20385,2.20335,2.20279,2.20251,2.20234,2.20209,2.20192,2.20189,2.20183,2.20182,2.20183,2.20184,2.20188,2.20195,2.202,2.20231,2.20248,2.20286,2.20344,2.20461,2.20635,2.20805,2.21114,2.21335,2.21465,2.21621,2.21675,2.21964,2.2228,2.22624,2.23118,2.23509,2.24175,2.24562,2.24919,2.25027],
      [6,3.81375,3.79437,3.77495,3.7652,3.71091,3.65529,3.61575,3.61233,3.60075,3.58649,3.58043,3.56179,3.53872,3.52584,3.51951,3.51506,3.51156,3.50828,3.50613,3.50524,3.50308,3.50001,3.49942,3.49737,3.49574,3.49403,3.49339,3.49286,3.49207,3.49118,3.49074,3.49047,3.49007,3.48981,3.48975,3.48966,3.48965,3.48967,3.48968,3.48975,3.48985,3.48994,3.49043,3.49069,3.4913,3.49221,3.49408,3.49683,3.49952,3.50441,3.50793,3.50999,3.51245,3.51331,3.51789,3.52291,3.52835,3.53618,3.54237,3.55293,3.55907,3.56472,3.56643],
      [6.5,6.04438,6.01368,5.98289,5.96745,5.88139,5.79325,5.73058,5.72516,5.70681,5.68421,5.67459,5.64505,5.60849,5.58808,5.57805,5.57099,5.56545,5.56025,5.55684,5.55543,5.552,5.54714,5.54621,5.54296,5.54037,5.53767,5.53666,5.53581,5.53456,5.53315,5.53245,5.53203,5.53139,5.53098,5.53089,5.53074,5.53073,5.53075,5.53077,5.53088,5.53104,5.53118,5.53195,5.53237,5.53333,5.53478,5.53774,5.54211,5.54636,5.55412,5.55969,5.56295,5.56687,5.56823,5.57547,5.58343,5.59205,5.60446,5.61428,5.63101,5.64074,5.6497,5.65241],
      [7,9.5797,9.53103,9.48224,9.45777,9.32138,9.18168,9.08236,9.07377,9.04468,9.00886,8.99362,8.9468,8.88885,8.85651,8.84062,8.82943,8.82064,8.81241,8.80699,8.80476,8.79933,8.79162,8.79015,8.785,8.7809,8.77661,8.77501,8.77367,8.77168,8.76945,8.76834,8.76767,8.76666,8.76601,8.76586,8.76563,8.76562,8.76565,8.76567,8.76585,8.76611,8.76633,8.76755,8.76822,8.76974,8.77204,8.77672,8.78365,8.79039,8.80269,8.81152,8.81668,8.82289,8.82505,8.83653,8.84914,8.86281,8.88247,8.89804,8.92455,8.93998,8.95417,8.95847],
      [7.5,15.1828,15.1057,15.0283,14.9895,14.7734,14.552,14.3946,14.3809,14.3349,14.2781,14.2539,14.1797,14.0879,14.0366,14.0114,13.9937,13.9798,13.9667,13.9581,13.9546,13.946,13.9338,13.9314,13.9233,13.9168,13.91,13.9075,13.9053,13.9022,13.8986,13.8969,13.8958,13.8942,13.8932,13.893,13.8926,13.8926,13.8926,13.8927,13.8929,13.8933,13.8937,13.8956,13.8967,13.8991,13.9027,13.9102,13.9211,13.9318,13.9513,13.9653,13.9735,13.9833,13.9868,14.005,14.0249,14.0466,14.0778,14.1024,14.1445,14.1689,14.1914,14.1982],
      [8,24.0631,23.9409,23.8183,23.7568,23.4142,23.0633,22.8139,22.7923,22.7192,22.6292,22.591,22.4734,22.3278,22.2465,22.2066,22.1785,22.1565,22.1358,22.1222,22.1166,22.1029,22.0835,22.0799,22.0669,22.0566,22.0458,22.0418,22.0385,22.0335,22.0279,22.0251,22.0234,22.0209,22.0192,22.0189,22.0183,22.0182,22.0183,22.0184,22.0188,22.0195,22.02,22.0231,22.0248,22.0286,22.0344,22.0461,22.0635,22.0805,22.1114,22.1335,22.1465,22.1621,22.1675,22.1964,22.228,22.2624,22.3118,22.3509,22.4175,22.4562,22.4919,22.5027],
      [8.5,38.1375,37.9437,37.7495,37.652,37.1091,36.5529,36.1575,36.1233,36.0075,35.8649,35.8043,35.6179,35.3872,35.2584,35.1951,35.1506,35.1156,35.0828,35.0613,35.0524,35.0308,35.0001,34.9942,34.9737,34.9574,34.9403,34.9339,34.9286,34.9207,34.9118,34.9074,34.9047,34.9007,34.8981,34.8975,34.8966,34.8965,34.8967,34.8968,34.8975,34.8985,34.8994,34.9043,34.9069,34.913,34.9221,34.9408,34.9683,34.9952,35.0441,35.0793,35.0999,35.1245,35.1331,35.1789,35.2291,35.2835,35.3618,35.4237,35.5293,35.5907,35.6472,35.6643],
      [9,60.4438,60.1368,59.8289,59.6745,58.8139,57.9325,57.3058,57.2516,57.0681,56.8421,56.7459,56.4505,56.0849,55.8808,55.7805,55.7099,55.6545,55.6025,55.5684,55.5543,55.52,55.4714,55.4621,55.4296,55.4037,55.3767,55.3666,55.3581,55.3456,55.3315,55.3245,55.3203,55.3139,55.3098,55.3089,55.3074,55.3073,55.3075,55.3077,55.3088,55.3104,55.3118,55.3195,55.3237,55.3333,55.3478,55.3774,55.4211,55.4636,55.5412,55.5969,55.6295,55.6687,55.6823,55.7547,55.8343,55.9205,56.0446,56.1428,56.3101,56.4074,56.497,56.5241],
      [9.5,95.797,95.3103,94.8224,94.5777,93.2138,91.8168,90.8236,90.7377,90.4468,90.0886,89.9362,89.468,88.8885,88.5651,88.4062,88.2943,88.2064,88.1241,88.0699,88.0476,87.9933,87.9162,87.9015,87.85,87.809,87.7661,87.7501,87.7367,87.7168,87.6945,87.6834,87.6767,87.6666,87.6601,87.6586,87.6563,87.6562,87.6565,87.6567,87.6585,87.6611,87.6633,87.6755,87.6822,87.6974,87.7204,87.7672,87.8365,87.9039,88.0269,88.1152,88.1668,88.2289,88.2505,88.3653,88.4914,88.6281,88.8247,88.9804,89.2455,89.3998,89.5417,89.5847],
      [10,151.828,151.057,150.283,149.895,147.734,145.52,143.946,143.809,143.349,142.781,142.539,141.797,140.879,140.366,140.114,139.937,139.798,139.667,139.581,139.546,139.46,139.338,139.314,139.233,139.168,139.1,139.075,139.053,139.022,138.986,138.969,138.958,138.942,138.932,138.93,138.926,138.926,138.926,138.927,138.929,138.933,138.937,138.956,138.967,138.991,139.027,139.102,139.211,139.318,139.513,139.653,139.735,139.833,139.868,140.05,140.249,140.466,140.778,141.024,141.445,141.689,141.914,141.982],
      [10.5,240.631,239.409,238.183,237.568,234.142,230.633,228.139,227.923,227.192,226.292,225.91,224.734,223.278,222.465,222.066,221.785,221.565,221.358,221.222,221.166,221.029,220.835,220.799,220.669,220.566,220.458,220.418,220.385,220.335,220.279,220.251,220.234,220.209,220.192,220.189,220.183,220.182,220.183,220.184,220.188,220.195,220.2,220.231,220.248,220.286,220.344,220.461,220.635,220.805,221.114,221.335,221.465,221.621,221.675,221.964,222.28,222.624,223.118,223.509,224.175,224.562,224.919,225.027],
      [11,381.375,379.437,377.495,376.52,371.091,365.529,361.575,361.233,360.075,358.649,358.043,356.179,353.872,352.584,351.951,351.506,351.156,350.828,350.613,350.524,350.308,350.001,349.942,349.737,349.574,349.403,349.339,349.286,349.207,349.118,349.074,349.047,349.007,348.981,348.975,348.966,348.965,348.967,348.968,348.975,348.985,348.994,349.043,349.069,349.13,349.221,349.408,349.683,349.952,350.441,350.793,350.999,351.245,351.331,351.789,352.291,352.835,353.618,354.237,355.293,355.907,356.472,356.643],
      [11.5,604.438,601.368,598.289,596.745,588.139,579.325,573.058,572.516,570.681,568.421,567.459,564.505,560.849,558.808,557.805,557.099,556.545,556.025,555.684,555.543,555.2,554.714,554.621,554.296,554.037,553.767,553.666,553.581,553.456,553.315,553.245,553.203,553.139,553.098,553.089,553.074,553.073,553.075,553.077,553.088,553.104,553.118,553.195,553.237,553.333,553.478,553.774,554.211,554.636,555.412,555.969,556.295,556.687,556.823,557.547,558.343,559.205,560.446,561.428,563.101,564.074,564.97,565.241],
      [12,957.97,953.103,948.224,945.777,932.138,918.168,908.236,907.377,904.468,900.886,899.362,894.68,888.885,885.651,884.062,882.943,882.064,881.241,880.699,880.476,879.933,879.162,879.015,878.5,878.09,877.661,877.501,877.367,877.168,876.945,876.834,876.767,876.666,876.601,876.586,876.563,876.562,876.565,876.567,876.585,876.611,876.633,876.755,876.822,876.974,877.204,877.672,878.365,879.039,880.269,881.152,881.668,882.289,882.505,883.653,884.914,886.281,888.247,889.804,892.455,893.998,895.417,895.847],
      [12.5,1518.28,1510.57,1502.83,1498.95,1477.34,1455.2,1439.46,1438.09,1433.49,1427.81,1425.39,1417.97,1408.79,1403.66,1401.14,1399.37,1397.98,1396.67,1395.81,1395.46,1394.6,1393.38,1393.14,1392.33,1391.68,1391,1390.75,1390.53,1390.22,1389.86,1389.69,1389.58,1389.42,1389.32,1389.3,1389.26,1389.26,1389.26,1389.27,1389.29,1389.33,1389.37,1389.56,1389.67,1389.91,1390.27,1391.02,1392.11,1393.18,1395.13,1396.53,1397.35,1398.33,1398.68,1400.5,1402.49,1404.66,1407.78,1410.24,1414.45,1416.89,1419.14,1419.82],
      [13,2406.31,2394.09,2381.83,2375.68,2341.42,2306.33,2281.39,2279.23,2271.92,2262.92,2259.1,2247.34,2232.78,2224.65,2220.66,2217.85,2215.65,2213.58,2212.22,2211.66,2210.29,2208.35,2207.99,2206.69,2205.66,2204.58,2204.18,2203.85,2203.35,2202.79,2202.51,2202.34,2202.09,2201.92,2201.89,2201.83,2201.82,2201.83,2201.84,2201.88,2201.95,2202,2202.31,2202.48,2202.86,2203.44,2204.61,2206.35,2208.05,2211.14,2213.35,2214.65,2216.21,2216.75,2219.64,2222.8,2226.24,2231.18,2235.09,2241.75,2245.62,2249.19,2250.27]];

    var timeToSaturationArray_throughput_noQE_bb =
      [[5,1.07256,1.06623,1.05975,1.05644,1.0371,1.01465,0.995589,0.99375,0.987235,0.978466,0.974434,0.960581,0.938933,0.923237,0.913978,0.906585,0.900116,0.893381,0.888507,0.886375,0.880828,0.871869,0.869978,0.862737,0.856065,0.847809,0.844254,0.841003,0.835528,0.827987,0.823337,0.819982,0.813524,0.807285,0.805144,0.79909,0.796255,0.793948,0.792781,0.788629,0.784981,0.782502,0.772858,0.768842,0.761229,0.751797,0.736303,0.717761,0.702261,0.677434,0.661283,0.65226,0.641756,0.63817,0.61958,0.599858,0.578955,0.54918,0.52538,0.482878,0.455686,0.427265,0.417529],
      [5.5,1.6999,1.68986,1.67959,1.67435,1.6437,1.6081,1.5779,1.57499,1.56466,1.55076,1.54437,1.52242,1.48811,1.46323,1.44856,1.43684,1.42659,1.41591,1.40819,1.40481,1.39602,1.38182,1.37882,1.36735,1.35677,1.34369,1.33805,1.3329,1.32422,1.31227,1.3049,1.29958,1.28935,1.27946,1.27607,1.26647,1.26198,1.25832,1.25647,1.24989,1.24411,1.24018,1.2249,1.21853,1.20647,1.19152,1.16696,1.13757,1.11301,1.07366,1.04806,1.03376,1.01712,1.01143,0.981969,0.950711,0.917582,0.870391,0.832672,0.76531,0.722213,0.67717,0.661739],
      [6,2.69416,2.67824,2.66197,2.65367,2.60508,2.54867,2.50081,2.49619,2.47982,2.4578,2.44767,2.41287,2.35849,2.31907,2.29581,2.27724,2.26099,2.24407,2.23183,2.22647,2.21254,2.19004,2.18529,2.1671,2.15034,2.1296,2.12067,2.1125,2.09875,2.07981,2.06813,2.0597,2.04348,2.02781,2.02243,2.00722,2.0001,1.99431,1.99138,1.98095,1.97178,1.96556,1.94133,1.93124,1.91212,1.88843,1.84951,1.80293,1.764,1.70164,1.66107,1.6384,1.61202,1.60301,1.55632,1.50677,1.45427,1.37948,1.3197,1.21293,1.14463,1.07324,1.04879],
      [6.5,4.26995,4.24473,4.21893,4.20578,4.12878,4.03938,3.96351,3.95619,3.93025,3.89534,3.87929,3.82414,3.73796,3.67547,3.63861,3.60918,3.58343,3.55661,3.53721,3.52872,3.50664,3.47097,3.46345,3.43462,3.40806,3.37519,3.36104,3.34809,3.3263,3.29628,3.27776,3.26441,3.2387,3.21386,3.20534,3.18123,3.16995,3.16076,3.15612,3.13959,3.12506,3.1152,3.07681,3.06081,3.03051,2.99296,2.93127,2.85746,2.79575,2.69691,2.63262,2.59669,2.55488,2.5406,2.46659,2.38808,2.30486,2.18632,2.09158,1.92237,1.81412,1.70097,1.66221],
      [7,6.76742,6.72744,6.68656,6.66571,6.54367,6.40198,6.28174,6.27014,6.22903,6.1737,6.14826,6.06086,5.92427,5.82523,5.76681,5.72016,5.67935,5.63685,5.6061,5.59265,5.55765,5.50112,5.48919,5.4435,5.4014,5.34931,5.32688,5.30637,5.27182,5.22425,5.1949,5.17374,5.13299,5.09363,5.08012,5.04192,5.02403,5.00947,5.00211,4.97591,4.95289,4.93725,4.87641,4.85106,4.80303,4.74352,4.64576,4.52877,4.43097,4.27432,4.17241,4.11548,4.04921,4.02658,3.90929,3.78485,3.65296,3.46509,3.31493,3.04675,2.87518,2.69586,2.63443],
      [7.5,10.7256,10.6623,10.5975,10.5644,10.371,10.1465,9.95589,9.9375,9.87235,9.78466,9.74434,9.60581,9.38933,9.23237,9.13978,9.06585,9.00116,8.93381,8.88507,8.86375,8.80828,8.71869,8.69978,8.62737,8.56065,8.47809,8.44254,8.41003,8.35528,8.27987,8.23337,8.19982,8.13524,8.07285,8.05144,7.9909,7.96255,7.93948,7.92781,7.88629,7.84981,7.82502,7.72858,7.68842,7.61229,7.51797,7.36303,7.17761,7.02261,6.77434,6.61283,6.5226,6.41756,6.3817,6.1958,5.99858,5.78955,5.4918,5.2538,4.82878,4.55686,4.27265,4.17529],
      [8,16.999,16.8986,16.7959,16.7435,16.437,16.081,15.779,15.7499,15.6466,15.5076,15.4437,15.2242,14.8811,14.6323,14.4856,14.3684,14.2659,14.1591,14.0819,14.0481,13.9602,13.8182,13.7882,13.6735,13.5677,13.4369,13.3805,13.329,13.2422,13.1227,13.049,12.9958,12.8935,12.7946,12.7607,12.6647,12.6198,12.5832,12.5647,12.4989,12.4411,12.4018,12.249,12.1853,12.0647,11.9152,11.6696,11.3757,11.1301,10.7366,10.4806,10.3376,10.1712,10.1143,9.81969,9.50711,9.17582,8.70391,8.32672,7.6531,7.22213,6.7717,6.61739],
      [8.5,26.9416,26.7824,26.6197,26.5367,26.0508,25.4867,25.0081,24.9619,24.7982,24.578,24.4767,24.1287,23.5849,23.1907,22.9581,22.7724,22.6099,22.4407,22.3183,22.2647,22.1254,21.9004,21.8529,21.671,21.5034,21.296,21.2067,21.125,20.9875,20.7981,20.6813,20.597,20.4348,20.2781,20.2243,20.0722,20.001,19.9431,19.9138,19.8095,19.7178,19.6556,19.4133,19.3124,19.1212,18.8843,18.4951,18.0293,17.64,17.0164,16.6107,16.384,16.1202,16.0301,15.5632,15.0677,14.5427,13.7948,13.197,12.1293,11.4463,10.7324,10.4879],
      [9,42.6995,42.4473,42.1893,42.0578,41.2878,40.3938,39.6351,39.5619,39.3025,38.9534,38.7929,38.2414,37.3796,36.7547,36.3861,36.0918,35.8343,35.5661,35.3721,35.2872,35.0664,34.7097,34.6345,34.3462,34.0806,33.7519,33.6104,33.4809,33.263,32.9628,32.7776,32.6441,32.387,32.1386,32.0534,31.8123,31.6995,31.6076,31.5612,31.3959,31.2506,31.152,30.7681,30.6081,30.3051,29.9296,29.3127,28.5746,27.9575,26.9691,26.3262,25.9669,25.5488,25.406,24.6659,23.8808,23.0486,21.8632,20.9158,19.2237,18.1412,17.0097,16.6221],
      [9.5,67.6742,67.2744,66.8656,66.6571,65.4367,64.0198,62.8174,62.7014,62.2903,61.737,61.4826,60.6086,59.2427,58.2523,57.6681,57.2016,56.7935,56.3685,56.061,55.9265,55.5765,55.0112,54.8919,54.435,54.014,53.4931,53.2688,53.0637,52.7182,52.2425,51.949,51.7374,51.3299,50.9363,50.8012,50.4192,50.2403,50.0947,50.0211,49.7591,49.5289,49.3725,48.7641,48.5106,48.0303,47.4352,46.4576,45.2877,44.3097,42.7432,41.7241,41.1548,40.4921,40.2658,39.0929,37.8485,36.5296,34.6509,33.1493,30.4675,28.7518,26.9586,26.3443],
      [10,107.256,106.623,105.975,105.644,103.71,101.465,99.5589,99.375,98.7235,97.8466,97.4434,96.0581,93.8933,92.3237,91.3978,90.6585,90.0116,89.3381,88.8507,88.6375,88.0828,87.1869,86.9978,86.2737,85.6065,84.7809,84.4254,84.1003,83.5528,82.7987,82.3337,81.9982,81.3524,80.7285,80.5144,79.909,79.6255,79.3948,79.2781,78.8629,78.4981,78.2502,77.2858,76.8842,76.1229,75.1797,73.6303,71.7761,70.2261,67.7434,66.1283,65.226,64.1756,63.817,61.958,59.9858,57.8955,54.918,52.538,48.2878,45.5686,42.7265,41.7529],
      [10.5,169.99,168.986,167.959,167.435,164.37,160.81,157.79,157.499,156.466,155.076,154.437,152.242,148.811,146.323,144.856,143.684,142.659,141.591,140.819,140.481,139.602,138.182,137.882,136.735,135.677,134.369,133.805,133.29,132.422,131.227,130.49,129.958,128.935,127.946,127.607,126.647,126.198,125.832,125.647,124.989,124.411,124.018,122.49,121.853,120.647,119.152,116.696,113.757,111.301,107.366,104.806,103.376,101.712,101.143,98.1969,95.0711,91.7582,87.0391,83.2672,76.531,72.2213,67.717,66.1739],
      [11,269.416,267.824,266.197,265.367,260.508,254.867,250.081,249.619,247.982,245.78,244.767,241.287,235.849,231.907,229.581,227.724,226.099,224.407,223.183,222.647,221.254,219.004,218.529,216.71,215.034,212.96,212.067,211.25,209.875,207.981,206.813,205.97,204.348,202.781,202.243,200.722,200.01,199.431,199.138,198.095,197.178,196.556,194.133,193.124,191.212,188.843,184.951,180.293,176.4,170.164,166.107,163.84,161.202,160.301,155.632,150.677,145.427,137.948,131.97,121.293,114.463,107.324,104.879],
      [11.5,426.995,424.473,421.893,420.578,412.878,403.938,396.351,395.619,393.025,389.534,387.929,382.414,373.796,367.547,363.861,360.918,358.343,355.661,353.721,352.872,350.664,347.097,346.345,343.462,340.806,337.519,336.104,334.809,332.63,329.628,327.776,326.441,323.87,321.386,320.534,318.123,316.995,316.076,315.612,313.959,312.506,311.52,307.681,306.081,303.051,299.296,293.127,285.746,279.575,269.691,263.262,259.669,255.488,254.06,246.659,238.808,230.486,218.632,209.158,192.237,181.412,170.097,166.221],
      [12,676.742,672.744,668.656,666.571,654.367,640.198,628.174,627.014,622.903,617.37,614.826,606.086,592.427,582.523,576.681,572.016,567.935,563.685,560.61,559.265,555.765,550.112,548.919,544.35,540.14,534.931,532.688,530.637,527.182,522.425,519.49,517.374,513.299,509.363,508.012,504.192,502.403,500.947,500.211,497.591,495.289,493.725,487.641,485.106,480.303,474.352,464.576,452.877,443.097,427.432,417.241,411.548,404.921,402.658,390.929,378.485,365.296,346.509,331.493,304.675,287.518,269.586,263.443],
      [12.5,1072.56,1066.23,1059.75,1056.44,1037.1,1014.65,995.589,993.75,987.235,978.466,974.434,960.581,938.933,923.237,913.978,906.585,900.116,893.381,888.507,886.375,880.828,871.869,869.978,862.737,856.065,847.809,844.254,841.003,835.528,827.987,823.337,819.982,813.524,807.285,805.144,799.09,796.255,793.948,792.781,788.629,784.981,782.502,772.858,768.842,761.229,751.797,736.303,717.761,702.261,677.434,661.283,652.26,641.756,638.17,619.58,599.858,578.955,549.18,525.38,482.878,455.686,427.265,417.529],
      [13,1699.9,1689.86,1679.59,1674.35,1643.7,1608.1,1577.9,1574.99,1564.66,1550.76,1544.37,1522.42,1488.11,1463.23,1448.56,1436.84,1426.59,1415.91,1408.19,1404.81,1396.02,1381.82,1378.82,1367.35,1356.77,1343.69,1338.05,1332.9,1324.22,1312.27,1304.9,1299.58,1289.35,1279.46,1276.07,1266.47,1261.98,1258.32,1256.47,1249.89,1244.11,1240.18,1224.9,1218.53,1206.47,1191.52,1166.96,1137.57,1113.01,1073.66,1048.06,1033.76,1017.12,1011.43,981.969,950.711,917.582,870.391,832.672,765.31,722.213,677.17,661.739]];

    var timeToSaturationArray_noThroughput_QE_bb =
      [[5,1.14675,1.14298,1.13943,1.13775,1.12999,1.12604,1.12702,1.12731,1.12853,1.13068,1.13183,1.13639,1.1447,1.15113,1.15496,1.15801,1.16066,1.16339,1.16535,1.1662,1.1684,1.1719,1.17263,1.17539,1.17789,1.18093,1.18222,1.18338,1.18532,1.18795,1.18954,1.19068,1.19284,1.19489,1.19558,1.19753,1.19842,1.19915,1.19952,1.20081,1.20194,1.20269,1.20559,1.20678,1.209,1.21168,1.21596,1.22088,1.22483,1.23088,1.23464,1.23669,1.23904,1.23983,1.24383,1.24793,1.25213,1.25785,1.26223,1.26966,1.27415,1.27864,1.28013],
      [5.5,1.81748,1.8115,1.80587,1.80321,1.79091,1.78465,1.78621,1.78666,1.7886,1.79201,1.79383,1.80105,1.81422,1.82441,1.83048,1.83532,1.83952,1.84385,1.84696,1.84831,1.8518,1.85734,1.85849,1.86287,1.86683,1.87165,1.87368,1.87553,1.87861,1.88277,1.8853,1.8871,1.89052,1.89377,1.89487,1.89795,1.89938,1.90053,1.90111,1.90316,1.90494,1.90614,1.91074,1.91262,1.91613,1.92039,1.92717,1.93496,1.94122,1.95081,1.95678,1.96003,1.96374,1.96499,1.97134,1.97784,1.98448,1.99356,2.0005,2.01227,2.01939,2.02651,2.02887],
      [6,2.88052,2.87103,2.86211,2.85789,2.8384,2.82848,2.83096,2.83166,2.83475,2.84014,2.84303,2.85447,2.87535,2.8915,2.90112,2.90878,2.91544,2.92231,2.92723,2.92937,2.9349,2.94368,2.94552,2.95245,2.95873,2.96636,2.96959,2.97252,2.97739,2.98399,2.98799,2.99085,2.99627,3.00142,3.00316,3.00805,3.01031,3.01213,3.01305,3.0163,3.01912,3.02103,3.02832,3.0313,3.03686,3.04361,3.05436,3.06671,3.07663,3.09182,3.10128,3.10643,3.11232,3.1143,3.12436,3.13466,3.1452,3.15958,3.17058,3.18923,3.20053,3.2118,3.21554],
      [6.5,4.56531,4.55027,4.53614,4.52946,4.49856,4.48283,4.48676,4.48789,4.49277,4.50132,4.50589,4.52403,4.55712,4.58272,4.59797,4.61011,4.62066,4.63155,4.63935,4.64275,4.6515,4.66543,4.66833,4.67932,4.68928,4.70136,4.70648,4.71112,4.71885,4.72931,4.73565,4.74017,4.74877,4.75692,4.75969,4.76743,4.77102,4.77391,4.77537,4.78051,4.78499,4.78801,4.79956,4.80428,4.8131,4.8238,4.84084,4.8604,4.87612,4.9002,4.9152,4.92337,4.93269,4.93583,4.95177,4.9681,4.9848,5.00759,5.02503,5.05459,5.07249,5.09036,5.09629],
      [7,7.23553,7.21169,7.1893,7.17871,7.12974,7.10481,7.11104,7.11282,7.12056,7.13411,7.14136,7.17011,7.22255,7.26312,7.28729,7.30653,7.32326,7.34051,7.35288,7.35826,7.37213,7.3942,7.3988,7.41623,7.432,7.45115,7.45927,7.46663,7.47888,7.49545,7.5055,7.51267,7.52629,7.53922,7.5436,7.55587,7.56155,7.56614,7.56844,7.5766,7.5837,7.58848,7.60678,7.61427,7.62826,7.64521,7.67221,7.70322,7.72813,7.7663,7.79007,7.80301,7.81779,7.82277,7.84803,7.87391,7.90038,7.9365,7.96414,8.01099,8.03936,8.06768,8.07707],
      [7.5,11.4675,11.4298,11.3943,11.3775,11.2999,11.2604,11.2702,11.2731,11.2853,11.3068,11.3183,11.3639,11.447,11.5113,11.5496,11.5801,11.6066,11.6339,11.6535,11.662,11.684,11.719,11.7263,11.7539,11.7789,11.8093,11.8222,11.8338,11.8532,11.8795,11.8954,11.9068,11.9284,11.9489,11.9558,11.9753,11.9842,11.9915,11.9952,12.0081,12.0194,12.0269,12.0559,12.0678,12.09,12.1168,12.1596,12.2088,12.2483,12.3088,12.3464,12.3669,12.3904,12.3983,12.4383,12.4793,12.5213,12.5785,12.6223,12.6966,12.7415,12.7864,12.8013],
      [8,18.1748,18.115,18.0587,18.0321,17.9091,17.8465,17.8621,17.8666,17.886,17.9201,17.9383,18.0105,18.1422,18.2441,18.3048,18.3532,18.3952,18.4385,18.4696,18.4831,18.518,18.5734,18.5849,18.6287,18.6683,18.7165,18.7368,18.7553,18.7861,18.8277,18.853,18.871,18.9052,18.9377,18.9487,18.9795,18.9938,19.0053,19.0111,19.0316,19.0494,19.0614,19.1074,19.1262,19.1613,19.2039,19.2717,19.3496,19.4122,19.5081,19.5678,19.6003,19.6374,19.6499,19.7134,19.7784,19.8448,19.9356,20.005,20.1227,20.1939,20.2651,20.2887],
      [8.5,28.8052,28.7103,28.6211,28.5789,28.384,28.2848,28.3096,28.3166,28.3475,28.4014,28.4303,28.5447,28.7535,28.915,29.0112,29.0878,29.1544,29.2231,29.2723,29.2937,29.349,29.4368,29.4552,29.5245,29.5873,29.6636,29.6959,29.7252,29.7739,29.8399,29.8799,29.9085,29.9627,30.0142,30.0316,30.0805,30.1031,30.1213,30.1305,30.163,30.1912,30.2103,30.2832,30.313,30.3686,30.4361,30.5436,30.6671,30.7663,30.9182,31.0128,31.0643,31.1232,31.143,31.2436,31.3466,31.452,31.5958,31.7058,31.8923,32.0053,32.118,32.1554],
      [9,45.6531,45.5027,45.3614,45.2946,44.9856,44.8283,44.8676,44.8789,44.9277,45.0132,45.0589,45.2403,45.5712,45.8272,45.9797,46.1011,46.2066,46.3155,46.3935,46.4275,46.515,46.6543,46.6833,46.7932,46.8928,47.0136,47.0648,47.1112,47.1885,47.2931,47.3565,47.4017,47.4877,47.5692,47.5969,47.6743,47.7102,47.7391,47.7537,47.8051,47.8499,47.8801,47.9956,48.0428,48.131,48.238,48.4084,48.604,48.7612,49.002,49.152,49.2337,49.3269,49.3583,49.5177,49.681,49.848,50.0759,50.2503,50.5459,50.7249,50.9036,50.9629],
      [9.5,72.3553,72.1169,71.893,71.7871,71.2974,71.0481,71.1104,71.1282,71.2056,71.3411,71.4136,71.7011,72.2255,72.6312,72.8729,73.0653,73.2326,73.4051,73.5288,73.5826,73.7213,73.942,73.988,74.1623,74.32,74.5115,74.5927,74.6663,74.7888,74.9545,75.055,75.1267,75.2629,75.3922,75.436,75.5587,75.6155,75.6614,75.6844,75.766,75.837,75.8848,76.0678,76.1427,76.2826,76.4521,76.7221,77.0322,77.2813,77.663,77.9007,78.0301,78.1779,78.2277,78.4803,78.7391,79.0038,79.365,79.6414,80.1099,80.3936,80.6768,80.7707],
      [10,114.675,114.298,113.943,113.775,112.999,112.604,112.702,112.731,112.853,113.068,113.183,113.639,114.47,115.113,115.496,115.801,116.066,116.339,116.535,116.62,116.84,117.19,117.263,117.539,117.789,118.093,118.222,118.338,118.532,118.795,118.954,119.068,119.284,119.489,119.558,119.753,119.842,119.915,119.952,120.081,120.194,120.269,120.559,120.678,120.9,121.168,121.596,122.088,122.483,123.088,123.464,123.669,123.904,123.983,124.383,124.793,125.213,125.785,126.223,126.966,127.415,127.864,128.013],
      [10.5,181.748,181.15,180.587,180.321,179.091,178.465,178.621,178.666,178.86,179.201,179.383,180.105,181.422,182.441,183.048,183.532,183.952,184.385,184.696,184.831,185.18,185.734,185.849,186.287,186.683,187.165,187.368,187.553,187.861,188.277,188.53,188.71,189.052,189.377,189.487,189.795,189.938,190.053,190.111,190.316,190.494,190.614,191.074,191.262,191.613,192.039,192.717,193.496,194.122,195.081,195.678,196.003,196.374,196.499,197.134,197.784,198.448,199.356,200.05,201.227,201.939,202.651,202.887],
      [11,288.052,287.103,286.211,285.789,283.84,282.848,283.096,283.166,283.475,284.014,284.303,285.447,287.535,289.15,290.112,290.878,291.544,292.231,292.723,292.937,293.49,294.368,294.552,295.245,295.873,296.636,296.959,297.252,297.739,298.399,298.799,299.085,299.627,300.142,300.316,300.805,301.031,301.213,301.305,301.63,301.912,302.103,302.832,303.13,303.686,304.361,305.436,306.671,307.663,309.182,310.128,310.643,311.232,311.43,312.436,313.466,314.52,315.958,317.058,318.923,320.053,321.18,321.554],
      [11.5,456.531,455.027,453.614,452.946,449.856,448.283,448.676,448.789,449.277,450.132,450.589,452.403,455.712,458.272,459.797,461.011,462.066,463.155,463.935,464.275,465.15,466.543,466.833,467.932,468.928,470.136,470.648,471.112,471.885,472.931,473.565,474.017,474.877,475.692,475.969,476.743,477.102,477.391,477.537,478.051,478.499,478.801,479.956,480.428,481.31,482.38,484.084,486.04,487.612,490.02,491.52,492.337,493.269,493.583,495.177,496.81,498.48,500.759,502.503,505.459,507.249,509.036,509.629],
      [12,723.553,721.169,718.93,717.871,712.974,710.481,711.104,711.282,712.056,713.411,714.136,717.011,722.255,726.312,728.729,730.653,732.326,734.051,735.288,735.826,737.213,739.42,739.88,741.623,743.2,745.115,745.927,746.663,747.888,749.545,750.55,751.267,752.629,753.922,754.36,755.587,756.155,756.614,756.844,757.66,758.37,758.848,760.678,761.427,762.826,764.521,767.221,770.322,772.813,776.63,779.007,780.301,781.779,782.277,784.803,787.391,790.038,793.65,796.414,801.099,803.936,806.768,807.707],
      [12.5,1146.75,1142.98,1139.43,1137.75,1129.99,1126.04,1127.02,1127.31,1128.53,1130.68,1131.83,1136.39,1144.7,1151.13,1154.96,1158.01,1160.66,1163.39,1165.35,1166.2,1168.4,1171.9,1172.63,1175.39,1177.89,1180.93,1182.22,1183.38,1185.32,1187.95,1189.54,1190.68,1192.84,1194.89,1195.58,1197.53,1198.42,1199.15,1199.52,1200.81,1201.94,1202.69,1205.59,1206.78,1209,1211.68,1215.96,1220.88,1224.83,1230.88,1234.64,1236.69,1239.04,1239.83,1243.83,1247.93,1252.13,1257.85,1262.23,1269.66,1274.15,1278.64,1280.13],
      [13,1817.48,1811.5,1805.87,1803.21,1790.91,1784.65,1786.21,1786.66,1788.6,1792.01,1793.83,1801.05,1814.22,1824.41,1830.48,1835.32,1839.52,1843.85,1846.96,1848.31,1851.8,1857.34,1858.49,1862.87,1866.83,1871.65,1873.68,1875.53,1878.61,1882.77,1885.3,1887.1,1890.52,1893.77,1894.87,1897.95,1899.38,1900.53,1901.11,1903.16,1904.94,1906.14,1910.74,1912.62,1916.13,1920.39,1927.17,1934.96,1941.22,1950.81,1956.78,1960.03,1963.74,1964.99,1971.34,1977.84,1984.48,1993.56,2000.5,2012.27,2019.39,2026.51,2028.87]];

    var timeToSaturationArray_noThroughput_noQE_bb =
      [[5,0.685114,0.683854,0.682841,0.682439,0.681822,0.685075,0.690688,0.691323,0.693651,0.696892,0.698388,0.703342,0.709753,0.712902,0.71408,0.714648,0.714872,0.714837,0.714644,0.714516,0.714059,0.712954,0.712664,0.711376,0.709948,0.707873,0.706878,0.705916,0.704188,0.701591,0.69987,0.698574,0.695952,0.693268,0.692314,0.689528,0.68818,0.687063,0.686491,0.684421,0.682556,0.681265,0.676069,0.673826,0.669453,0.663828,0.654126,0.641842,0.631078,0.613028,0.600825,0.593869,0.585657,0.582827,0.567959,0.55186,0.534484,0.509268,0.488786,0.451637,0.427557,0.402174,0.393433],
      [5.5,1.08583,1.08384,1.08223,1.08159,1.08061,1.08577,1.09467,1.09567,1.09936,1.1045,1.10687,1.11472,1.12488,1.12987,1.13174,1.13264,1.133,1.13294,1.13263,1.13243,1.13171,1.12996,1.1295,1.12746,1.12519,1.1219,1.12033,1.1188,1.11606,1.11195,1.10922,1.10716,1.10301,1.09876,1.09724,1.09283,1.09069,1.08892,1.08802,1.08473,1.08178,1.07973,1.0715,1.06794,1.06101,1.0521,1.03672,1.01725,1.00019,0.971584,0.952243,0.941219,0.928204,0.923719,0.900155,0.874639,0.8471,0.807135,0.774674,0.715796,0.677632,0.637403,0.623549],
      [6,1.72093,1.71776,1.71522,1.71421,1.71266,1.72083,1.73493,1.73652,1.74237,1.75051,1.75427,1.76672,1.78282,1.79073,1.79369,1.79511,1.79568,1.79559,1.7951,1.79478,1.79363,1.79086,1.79013,1.7869,1.78331,1.7781,1.7756,1.77318,1.76884,1.76232,1.75799,1.75474,1.74815,1.74141,1.73902,1.73202,1.72863,1.72582,1.72439,1.71919,1.7145,1.71126,1.69821,1.69257,1.68159,1.66746,1.64309,1.61224,1.5852,1.53986,1.5092,1.49173,1.4711,1.464,1.42665,1.38621,1.34256,1.27922,1.22778,1.13446,1.07397,1.01022,0.988258],
      [6.5,2.72749,2.72247,2.71844,2.71684,2.71438,2.72733,2.74968,2.7522,2.76147,2.77438,2.78033,2.80006,2.82558,2.83811,2.8428,2.84506,2.84596,2.84582,2.84505,2.84454,2.84272,2.83832,2.83716,2.83204,2.82635,2.81809,2.81413,2.8103,2.80342,2.79309,2.78623,2.78107,2.77063,2.75995,2.75615,2.74506,2.73969,2.73525,2.73297,2.72473,2.7173,2.71216,2.69148,2.68255,2.66514,2.64275,2.60412,2.55522,2.51237,2.44051,2.39193,2.36424,2.33154,2.32028,2.26109,2.19699,2.12782,2.02743,1.94589,1.798,1.70213,1.60108,1.56628],
      [7,4.32277,4.31483,4.30843,4.3059,4.302,4.32253,4.35794,4.36195,4.37664,4.39709,4.40653,4.43779,4.47824,4.49811,4.50554,4.50912,4.51054,4.51032,4.5091,4.50829,4.50541,4.49843,4.4966,4.48848,4.47947,4.46637,4.4601,4.45403,4.44313,4.42674,4.41588,4.4077,4.39116,4.37423,4.36821,4.35063,4.34212,4.33507,4.33147,4.3184,4.30664,4.29849,4.26571,4.25155,4.22396,4.18847,4.12726,4.04975,3.98183,3.86795,3.79095,3.74706,3.69525,3.67739,3.58358,3.482,3.37237,3.21326,3.08403,2.84964,2.6977,2.53755,2.48239],
      [7.5,6.85114,6.83854,6.82841,6.82439,6.81822,6.85075,6.90688,6.91323,6.93651,6.96892,6.98388,7.03342,7.09753,7.12902,7.1408,7.14648,7.14872,7.14837,7.14644,7.14516,7.14059,7.12954,7.12664,7.11376,7.09948,7.07873,7.06878,7.05916,7.04188,7.01591,6.9987,6.98574,6.95952,6.93268,6.92314,6.89528,6.8818,6.87063,6.86491,6.84421,6.82556,6.81265,6.76069,6.73826,6.69453,6.63828,6.54126,6.41842,6.31078,6.13028,6.00825,5.93869,5.85657,5.82827,5.67959,5.5186,5.34484,5.09268,4.88786,4.51637,4.27557,4.02174,3.93433],
      [8,10.8583,10.8384,10.8223,10.8159,10.8061,10.8577,10.9467,10.9567,10.9936,11.045,11.0687,11.1472,11.2488,11.2987,11.3174,11.3264,11.33,11.3294,11.3263,11.3243,11.3171,11.2996,11.295,11.2746,11.2519,11.219,11.2033,11.188,11.1606,11.1195,11.0922,11.0716,11.0301,10.9876,10.9724,10.9283,10.9069,10.8892,10.8802,10.8473,10.8178,10.7973,10.715,10.6794,10.6101,10.521,10.3672,10.1725,10.0019,9.71584,9.52243,9.41219,9.28204,9.23719,9.00155,8.74639,8.471,8.07135,7.74674,7.15796,6.77632,6.37403,6.23549],
      [8.5,17.2093,17.1776,17.1522,17.1421,17.1266,17.2083,17.3493,17.3652,17.4237,17.5051,17.5427,17.6672,17.8282,17.9073,17.9369,17.9511,17.9568,17.9559,17.951,17.9478,17.9363,17.9086,17.9013,17.869,17.8331,17.781,17.756,17.7318,17.6884,17.6232,17.5799,17.5474,17.4815,17.4141,17.3902,17.3202,17.2863,17.2582,17.2439,17.1919,17.145,17.1126,16.9821,16.9257,16.8159,16.6746,16.4309,16.1224,15.852,15.3986,15.092,14.9173,14.711,14.64,14.2665,13.8621,13.4256,12.7922,12.2778,11.3446,10.7397,10.1022,9.88258],
      [9,27.2749,27.2247,27.1844,27.1684,27.1438,27.2733,27.4968,27.522,27.6147,27.7438,27.8033,28.0006,28.2558,28.3811,28.428,28.4506,28.4596,28.4582,28.4505,28.4454,28.4272,28.3832,28.3716,28.3204,28.2635,28.1809,28.1413,28.103,28.0342,27.9309,27.8623,27.8107,27.7063,27.5995,27.5615,27.4506,27.3969,27.3525,27.3297,27.2473,27.173,27.1216,26.9148,26.8255,26.6514,26.4275,26.0412,25.5522,25.1237,24.4051,23.9193,23.6424,23.3154,23.2028,22.6109,21.9699,21.2782,20.2743,19.4589,17.98,17.0213,16.0108,15.6628],
      [9.5,43.2277,43.1483,43.0843,43.059,43.02,43.2253,43.5794,43.6195,43.7664,43.9709,44.0653,44.3779,44.7824,44.9811,45.0554,45.0912,45.1054,45.1032,45.091,45.0829,45.0541,44.9843,44.966,44.8848,44.7947,44.6637,44.601,44.5403,44.4313,44.2674,44.1588,44.077,43.9116,43.7423,43.6821,43.5063,43.4212,43.3507,43.3147,43.184,43.0664,42.9849,42.6571,42.5155,42.2396,41.8847,41.2726,40.4975,39.8183,38.6795,37.9095,37.4706,36.9525,36.7739,35.8358,34.82,33.7237,32.1326,30.8403,28.4964,26.977,25.3755,24.8239],
      [10,68.5114,68.3854,68.2841,68.2439,68.1822,68.5075,69.0688,69.1323,69.3651,69.6892,69.8388,70.3342,70.9753,71.2902,71.408,71.4648,71.4872,71.4837,71.4644,71.4516,71.4059,71.2954,71.2664,71.1376,70.9948,70.7873,70.6878,70.5916,70.4188,70.1591,69.987,69.8574,69.5952,69.3268,69.2314,68.9528,68.818,68.7063,68.6491,68.4421,68.2556,68.1265,67.6069,67.3826,66.9453,66.3828,65.4126,64.1842,63.1078,61.3028,60.0825,59.3869,58.5657,58.2827,56.7959,55.186,53.4484,50.9268,48.8786,45.1637,42.7557,40.2174,39.3433],
      [10.5,108.583,108.384,108.223,108.159,108.061,108.577,109.467,109.567,109.936,110.45,110.687,111.472,112.488,112.987,113.174,113.264,113.3,113.294,113.263,113.243,113.171,112.996,112.95,112.746,112.519,112.19,112.033,111.88,111.606,111.195,110.922,110.716,110.301,109.876,109.724,109.283,109.069,108.892,108.802,108.473,108.178,107.973,107.15,106.794,106.101,105.21,103.672,101.725,100.019,97.1584,95.2243,94.1219,92.8204,92.3719,90.0155,87.4639,84.71,80.7135,77.4674,71.5796,67.7632,63.7403,62.3549],
      [11,172.093,171.776,171.522,171.421,171.266,172.083,173.493,173.652,174.237,175.051,175.427,176.672,178.282,179.073,179.369,179.511,179.568,179.559,179.51,179.478,179.363,179.086,179.013,178.69,178.331,177.81,177.56,177.318,176.884,176.232,175.799,175.474,174.815,174.141,173.902,173.202,172.863,172.582,172.439,171.919,171.45,171.126,169.821,169.257,168.159,166.746,164.309,161.224,158.52,153.986,150.92,149.173,147.11,146.4,142.665,138.621,134.256,127.922,122.778,113.446,107.397,101.022,98.8258],
      [11.5,272.749,272.247,271.844,271.684,271.438,272.733,274.968,275.22,276.147,277.438,278.033,280.006,282.558,283.811,284.28,284.506,284.596,284.582,284.505,284.454,284.272,283.832,283.716,283.204,282.635,281.809,281.413,281.03,280.342,279.309,278.623,278.107,277.063,275.995,275.615,274.506,273.969,273.525,273.297,272.473,271.73,271.216,269.148,268.255,266.514,264.275,260.412,255.522,251.237,244.051,239.193,236.424,233.154,232.028,226.109,219.699,212.782,202.743,194.589,179.8,170.213,160.108,156.628],
      [12,432.277,431.483,430.843,430.59,430.2,432.253,435.794,436.195,437.664,439.709,440.653,443.779,447.824,449.811,450.554,450.912,451.054,451.032,450.91,450.829,450.541,449.843,449.66,448.848,447.947,446.637,446.01,445.403,444.313,442.674,441.588,440.77,439.116,437.423,436.821,435.063,434.212,433.507,433.147,431.84,430.664,429.849,426.571,425.155,422.396,418.847,412.726,404.975,398.183,386.795,379.095,374.706,369.525,367.739,358.358,348.2,337.237,321.326,308.403,284.964,269.77,253.755,248.239],
      [12.5,685.114,683.854,682.841,682.439,681.822,685.075,690.688,691.323,693.651,696.892,698.388,703.342,709.753,712.902,714.08,714.648,714.872,714.837,714.644,714.516,714.059,712.954,712.664,711.376,709.948,707.873,706.878,705.916,704.188,701.591,699.87,698.574,695.952,693.268,692.314,689.528,688.18,687.063,686.491,684.421,682.556,681.265,676.069,673.826,669.453,663.828,654.126,641.842,631.078,613.028,600.825,593.869,585.657,582.827,567.959,551.86,534.484,509.268,488.786,451.637,427.557,402.174,393.433],
      [13,1085.83,1083.84,1082.23,1081.59,1080.61,1085.77,1094.67,1095.67,1099.36,1104.5,1106.87,1114.72,1124.88,1129.87,1131.74,1132.64,1133,1132.94,1132.63,1132.43,1131.71,1129.96,1129.5,1127.46,1125.19,1121.9,1120.33,1118.8,1116.06,1111.95,1109.22,1107.16,1103.01,1098.76,1097.24,1092.83,1090.69,1088.92,1088.02,1084.73,1081.78,1079.73,1071.5,1067.94,1061.01,1052.1,1036.72,1017.25,1000.19,971.584,952.243,941.219,928.204,923.719,900.155,874.639,847.1,807.135,774.674,715.796,677.632,637.403,623.549]];

    var timeToSaturationArray;
    if (document.getElementById("sedFilename").value.includes("REF_APP_SEDTeff")) {
      if (document.getElementById("runGlobalThroughputGenerator").checked) {
        if (document.getElementById("applyThroughput").checked && document.getElementById("applyQE").checked) {
          timeToSaturationArray = timeToSaturationArray_throughput_QE;
        } else if (document.getElementById("applyThroughput").checked) {
          timeToSaturationArray = timeToSaturationArray_throughput_noQE;
        } else if (document.getElementById("applyQE").checked) {
          timeToSaturationArray = timeToSaturationArray_noThroughput_QE;
        } else {
          timeToSaturationArray = timeToSaturationArray_noThroughput_noQE;
        }
      } else {
        timeToSaturationArray = timeToSaturationArray_noThroughput_noQE;
      }
    } else {
      if (document.getElementById("runGlobalThroughputGenerator").checked) {
        if (document.getElementById("applyThroughput").checked && document.getElementById("applyQE").checked) {
          timeToSaturationArray = timeToSaturationArray_throughput_QE_bb;
        } else if (document.getElementById("applyThroughput").checked) {
          timeToSaturationArray = timeToSaturationArray_throughput_noQE_bb;
        } else if (document.getElementById("applyQE").checked) {
          timeToSaturationArray = timeToSaturationArray_noThroughput_QE_bb;
        } else {
          timeToSaturationArray = timeToSaturationArray_noThroughput_noQE_bb;
        }
      } else {
        timeToSaturationArray = timeToSaturationArray_noThroughput_noQE_bb;
      }
    }

    //Require that (Gaia) magnitude is in the range 5.0 to 13.0
    var mag = document.getElementById("star0_Mag").value;
    if (document.getElementById("fileRadio").checked) {
      mag = document.getElementById("star0_Mag_file").value;
    }
    if (mag < 5.0 || mag > 13.0) {
      document.getElementById("saturation1").value = "not available";
      document.getElementById("saturation1").style.color="red";
      //document.getElementById("saturation1").style.borderColor="red";
      document.getElementById("saturation2").value = "not available";
      document.getElementById("saturation2").style.color="red";
      //document.getElementById("saturation2").style.borderColor="red";
      return;
    } else {
      document.getElementById("saturation1").style.borderColor='';
      document.getElementById("saturation2").style.borderColor='';
    }

    //Identify correct row of timeToSaturationArray
    var imag=0;
    for (i=0; i<17; i++) {
       if (mag<=timeToSaturationArray[i][0]) {
          imag=i;
          break;
       }
    }

    //Identify correct column of timeToSaturationArray
    var specType = document.getElementById("star0_SpecType").value;
    if (document.getElementById("fileRadio").checked) {
      specType = document.getElementById("star0_SpecType_file").value;
    }

    //console.log(specType);
    var iSpecType = 1;
    if (specType=="O7") iSpecType=1;
    else if (specType=="O8") iSpecType=2;
    else if (specType=="O9") iSpecType=3;
    else if (specType=="B0") iSpecType=4;
    else if (specType=="B1") iSpecType=5;
    else if (specType=="B2") iSpecType=6;
    else if (specType=="B3") iSpecType=7;
    else if (specType=="B4") iSpecType=8;
    else if (specType=="B5") iSpecType=9;
    else if (specType=="B6") iSpecType=10;
    else if (specType=="B7") iSpecType=11;
    else if (specType=="B8") iSpecType=12;
    else if (specType=="B9") iSpecType=13;
    else if (specType=="A0") iSpecType=14;
    else if (specType=="A1") iSpecType=15;
    else if (specType=="A2") iSpecType=16;
    else if (specType=="A3") iSpecType=17;
    else if (specType=="A4") iSpecType=18;
    else if (specType=="A5") iSpecType=19;
    else if (specType=="A6") iSpecType=20;
    else if (specType=="A7") iSpecType=21;
    else if (specType=="A8") iSpecType=22;
    else if (specType=="A9") iSpecType=23;
    else if (specType=="F0") iSpecType=24;
    else if (specType=="F1") iSpecType=25;
    else if (specType=="F2") iSpecType=26;
    else if (specType=="F3") iSpecType=27;
    else if (specType=="F4") iSpecType=28;
    else if (specType=="F5") iSpecType=29;
    else if (specType=="F6") iSpecType=30;
    else if (specType=="F7") iSpecType=31;
    else if (specType=="F8") iSpecType=32;
    else if (specType=="F9") iSpecType=33;
    else if (specType=="G0") iSpecType=34;
    else if (specType=="G1") iSpecType=35;
    else if (specType=="G2") iSpecType=36;
    else if (specType=="G3") iSpecType=37;
    else if (specType=="G4") iSpecType=38;
    else if (specType=="G5") iSpecType=39;
    else if (specType=="G6") iSpecType=40;
    else if (specType=="G7") iSpecType=41;
    else if (specType=="G8") iSpecType=42;
    else if (specType=="G9") iSpecType=43;
    else if (specType=="K0") iSpecType=44;
    else if (specType=="K1") iSpecType=45;
    else if (specType=="K2") iSpecType=46;
    else if (specType=="K3") iSpecType=47;
    else if (specType=="K4") iSpecType=48;
    else if (specType=="K5") iSpecType=49;
    else if (specType=="K6") iSpecType=50;
    else if (specType=="K7") iSpecType=51;
    else if (specType=="K8") iSpecType=52;
    else if (specType=="K9") iSpecType=53;
    else if (specType=="M0") iSpecType=54;
    else if (specType=="M1") iSpecType=55;
    else if (specType=="M2") iSpecType=56;
    else if (specType=="M3") iSpecType=57;
    else if (specType=="M4") iSpecType=58;
    else if (specType=="M5") iSpecType=59;
    else if (specType=="M6") iSpecType=60;
    else if (specType=="M7") iSpecType=61;
    else if (specType=="M8") iSpecType=62;
    else if (specType=="M9") iSpecType=63;
    else console.log("Spectral type unrecognized: "+specType);

    //console.log(iSpecType);

    //Initialize timeToSaturation to value for magnitude 5.0 (row 0)
    var timeToSaturation = timeToSaturationArray[0][iSpecType];
    //For magnitude>5.0, perform linear interpolation between rows according to input magnitude
    if (mag > 5.0) {
      var mag_low = timeToSaturationArray[imag-1][0]; //column 0 denotes the magnitude
      var time_low = timeToSaturationArray[imag-1][iSpecType];
      var time_high = timeToSaturationArray[imag][iSpecType];
      timeToSaturation = time_low + (mag-mag_low)*2.0*(time_high-time_low); //factor 2 because magnitude is in steps of 0.5
    }

    //peak value ratios calculated using "PSF peak height comparison.ipynb"
    if (document.getElementById("whitePSF_filename").value=="CH_TU2020-01-29T00-00-00_REF_APP_WhitePSF_V0105.fits" ||
        document.getElementById("whitePSF_filename").value=="CH_TU2020-01-29T00-00-00_REF_APP_WhiteCCDLocationPSF_V0101.fits") {
      timeToSaturation /= 0.9004; //ratio of peak values of CH_TU2020-01-29T00-00-00_REF_APP_WhitePSF_V0105.fits / CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits
    } else if (document.getElementById("whitePSF_filename").value=="CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0102.fits") {
      timeToSaturation /= 4.2416; //ratio of peak values of CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0102.fits / CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits
    }

    var exposureTime = document.getElementById("exposureTime").value;
    var fullWellCapacity = document.getElementById("fullWellCapacity").value;
    var saturation1 = (exposureTime/timeToSaturation)*(125000./fullWellCapacity);
    document.getElementById("saturation1").value = parseFloat(saturation1*100.).toFixed(1);
    if (saturation1 > 1.) {
      document.getElementById("saturation1").style.color="red";
      document.getElementById("saturationWarning1").innerHTML="Warning: images will saturate (full well)";
      document.getElementById("saturationWarning1").style.color="red";
    } else if (saturation1 > 0.9 || (saturation1 < 0.1 && saturation1 > 0.)) {
      document.getElementById("saturation1").style.color="orange";
      document.getElementById("saturationWarning1").style.color="orange";
      if (saturation1 > 0.9) {
        document.getElementById("saturationWarning1").innerHTML="Warning: close to full well saturation level: response will be non-linear for some pixels";
      } else {
        document.getElementById("saturationWarning1").innerHTML="Warning: less than 10% of full well saturation: a longer exposure time is recommended";
      }
    } else {
      document.getElementById("saturation1").style.color="green";
      document.getElementById("saturationWarning1").innerHTML="";
    }

    var biasMean = 0.;
    var gain =1.;
    var ADCBits = 16;
    if (document.getElementById("runBiasGenerator").checked) {
      biasMean = document.getElementById("biasMean").value;
      gain = 0.5111;
      //ADCBits = document.getElementById("ADCBits").value;
    }
    var saturation2 = parseFloat(saturation1*fullWellCapacity*gain);
    saturation2 += parseFloat(biasMean);
    saturation2 /= Math.pow(2,ADCBits);
    document.getElementById("saturation2").value = parseFloat(saturation2*100.).toFixed(1);
    if (saturation2 > 1.) {
      document.getElementById("saturation2").style.color="red";
      document.getElementById("saturationWarning2").innerHTML="Warning: images will saturate (ADU)";
      document.getElementById("saturationWarning2").style.color="red";
    } else if (saturation2 < 0.1 && saturation2 > 0.) {
      document.getElementById("saturation2").style.color="orange";
      document.getElementById("saturationWarning2").style.color="orange";
      document.getElementById("saturationWarning2").innerHTML="Warning: less than 10% of ADU saturation";
    } else {
      document.getElementById("saturation2").style.color="green";
      document.getElementById("saturationWarning2").innerHTML="";
    }

}
</SCRIPT>

<SCRIPT language="javascript">
function setTargetStarForPointing() {
    if (document.getElementById("runStarProducer").checked && document.getElementById("doForegroundStars").checked && document.getElementById("useTargetStarForPointing").checked) {
      document.getElementById("pointingDec").value="As target star";
      document.getElementById("pointingRA").value="As target star";
      document.getElementById("pointingDec").readOnly=true;
      document.getElementById("pointingRA").readOnly=true;
      document.getElementById("pointingDec").style.color="green";
      document.getElementById("pointingRA").style.color="green";
      document.getElementById("pointingDec").style.borderColor="";
      document.getElementById("pointingRA").style.borderColor="";
    } else {
      var defaultRaDecString = "";
      if (document.getElementById("hiddenPointingDec").value == "00:00:00.0" && document.getElementById("hiddenPointingDec").value == "00:00:00.0") defaultRaDecString = ", default value RA=00:00:00.0, dec=00:00:00.0";
      alert("Note: pointing direction will be defined in Visit Configuration rather than using target star location"+defaultRaDecString);
      document.getElementById("pointingDec").value = document.getElementById("hiddenPointingDec").value;
      document.getElementById("pointingRA").value = document.getElementById("hiddenPointingRA").value;
      document.getElementById("pointingDec").readOnly=false;
      document.getElementById("pointingRA").readOnly=false;
      document.getElementById("pointingDec").style.color="";
      document.getElementById("pointingRA").style.color="";
      document.getElementById("useTargetStarForPointing").checked = false;
    }
}
</SCRIPT>

<SCRIPT language="javascript">
function checkTargetStarForPointing(el) {
    if (el.value == "As target star") {
      alert("Deselect 'Set the pointing direction to correspond to the target star' in StarProducer in order to manually set the pointing direction");
    }
}
</SCRIPT>

</div>
<div id="StarFieldTab" class="tabcontent">

<h3 id="linkStarProducer"><input TYPE="CHECKBOX" NAME="runStarProducer" id="runStarProducer" VALUE="true" CHECKED onchange="setTargetStarForPointing()"> Module: StarProducer <a href="UserManual/CHEOPSim_UserManual.html#StarProducer" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>

<div id="StarProducer">

  <i><font color=green>
  <table>
    <tr><td>NOTE: </td><td>The run time increases linearly with the number of stars that are processed.</td></tr>
    <tr><td></td><td>The number of stars can be tuned by changing the magnitude threshold.</td></tr>
    <tr><td></td><td>The number of stars to be processed can be reduced by factor 5 by switching off FrameTransferSmearer (Detector tab).</td></tr>
  </table>
  </i></font>
  
  <p>Magnitude threshold <font color=green><i>Stars with magnitudes fainter than this will be skipped </i></font> </td><td><input NAME="minMagnitude" ID="minMagnitude" VALUE="18" onchange="checkFloat(this);updateStars(false)">
  <a href="UserManual/CHEOPSim_UserManual.html#minMagnitude" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  
  <p>Model for stellar spectrum: <select ID="sedFilename" NAME="sedFilename" onchange="calculateSaturation()">
    <option value="CH_TU2015-01-01T00-00-00_REF_APP_SEDTeff_V0102.fits">Synthetic spectral energy distribution (PHOENIX model): CH_TU2015-01-01T00-00-00_REF_APP_SEDTeff_V0102.fits</option>
    <option value="black body">Planck black body</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#SEDs" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <p>Optional: Upload spectral energy distribution for the target star: <input type="file" name="UserSEDfile" id="UserSEDfile">
  <a href="UserManual/CHEOPSim_UserManual.html#userSED" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <p>Passband used to normalize the spectral energy distribution: <select ID="passband" NAME="passband">
    <option value="GaiaBand" selected>Gaia passband</option>
    <option value="Vband">V-band</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#passband" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul style="display:none">Optional: magnitude of target star in chosen band (override of value derived from StarCatalogue):
    <input NAME="targetMagnitude" ID="targetMagnitude" VALUE="" onchange="checkMagnitude(this)" style="display:none">
  </ul>
  
  <p><input TYPE="CHECKBOX" NAME="doForegroundStars" ID="doForegroundStars" VALUE="true" checked onchange="calculateRuntime();setTargetStarForPointing()">Define a list of stars:
  <a href="UserManual/CHEOPSim_UserManual.html#stars" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="foregroundStars">
  <ul>

    <input type="radio" name="starInputMethod" id="fileRadio" value="file" onchange="updateStars()">
    <input id="updateMagThresh" value="true" style="display:none"></td> <!--Need this as alternative to passing an argument to readStarCatalogue method--> 
    Upload a file containing the list of stars, either as a FITS file with format <a href="https://htmlpreview.github.io/?https://github.com/davefutyan/common_sw/blob/master/doc/fits_data_model/EXT_PRE_StarCatalogue.html" target="_blank">EXT_PRE_StarCatalogue</a> or  <a href="https://htmlpreview.github.io/?https://github.com/davefutyan/common_sw/blob/master/doc/fits_data_model/EXT_DRFT_StarCatalogue.html" target="_blank">EXT_DRFT_StarCatalogue</a>, or as an ASCII file with the format described <a href="UserManual/CHEOPSim_UserManual.html#stars" target="_CHEOPSimUserManual">here</a>. An EXT_PRE_StarCatalogue file can be generated, reading from the Gaia star catalogue, using <a href="catalogue_extraction.html" target="_blank">this form</a>.
    <ul>
      <table>
	<tr><td><input type="file" name="starFile" id="starFile" onclick="setFileRadio()" onchange="updateStars()"/>
	  <a href="UserManual/CHEOPSim_UserManual.html#stars" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
	</td></tr>
      </table>
    </ul>

    <table id="targetStarFromFile" style="display:none">
      <tr>
	<td>Target star Gaia magnitude and Spectral type:</td>
	<td><input ID="star0_Mag_file" NAME="star0_Mag_file" VALUE="9.0" readonly></td>
	<td><input ID="star0_SpecType_file" NAME="star0_SpecType_file" VALUE="G0" readonly></td>
      </tr>
    </table>
    <input ID="star0_Teff_file" NAME="star0_Teff_file" VALUE="5920." style="display:none">
    
    <p><input type="radio" name="starInputMethod" id="formRadio" value="form" checked onchange="updateStars()">
    Input the target star data using the fields below, and use the "Add star"
    button to add up to 9 additional stars to the field of view:
    <input name="nStars" id="nStars" style="display:none" value="1">
    <ul>
      <br>
      <INPUT type="button" value="Add star" onclick="addStar();calculateRuntime()"/>
      <INPUT type="button" value="Reset" onclick="resetStars();calculateRuntime()"/>
      <table id="stars">
	<tr style="display:inherit">
	  <td>ID</td>
	  <td>Right Ascension</td>
	  <td>Declination</td>
	  <td>Gaia Magnitude</td>
	  <td>Spectral Type /</td>
	</tr>
	<tr style="display:inherit">
	  <td></td>
	  <td>(HH:MM:SS[.SSS]</td>
	  <td>(DD:MM:SS[.SSS]</td>
	  <td></td>
	  <td>Effective Temperature</td>
	</tr>
	<tr style="display:inherit">
	  <td></td>
	  <td>or decimal degrees)</td>
	  <td>or decimal degrees)</td>
	  <td></td>
	  <td></td>
	</tr>
	<tr id="star0" style="display:inherit">
	  <td>0</td>
	  <td><input NAME="star0_RA" ID="star0_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star0_Dec" ID="star0_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star0_Mag" NAME="star0_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation();setAutoMinMag()" onchange="checkMagnitude(this);calculateSaturation();setAutoMinMag()"></td>
	  <td><select ID="star0_SpecType" NAME="star0_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star1" style="display:none">
	  <td>1</td>
	  <td><input NAME="star1_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star1_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star1_Mag" NAME="star1_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star1_SpecType" NAME="star1_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star2" style="display:none">
	  <td>2</td>
	  <td><input NAME="star2_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star2_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star2_Mag" NAME="star2_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star2_SpecType" NAME="star2_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9 / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star3" style="display:none">
	  <td>3</td>
	  <td><input NAME="star3_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star3_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star3_Mag" NAME="star3_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star3_SpecType" NAME="star3_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star4" style="display:none">
	  <td>4</td>
	  <td><input NAME="star4_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star4_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star4_Mag" NAME="star4_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star4_SpecType" NAME="star4_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star5" style="display:none">
	  <td>5</td>
	  <td><input NAME="star5_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star5_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star5_Mag" NAME="star5_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star5_SpecType" NAME="star5_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star6" style="display:none">
	  <td>6</td>
	  <td><input NAME="star6_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star6_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star6_Mag" NAME="star6_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star6_SpecType" NAME="star6_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star7" style="display:none">
	  <td>7</td>
	  <td><input NAME="star7_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star7_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star7_Mag" NAME="star7_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star7_SpecType" NAME="star7_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star8" style="display:none">
	  <td>8</td>
	  <td><input NAME="star8_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star8_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star8_Mag" NAME="star8_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star8_SpecType" NAME="star8_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
	<tr id="star9" style="display:none">
	  <td>9</td>
	  <td><input NAME="star9_RA" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkRA(this)"></td>
	  <td><input NAME="star9_Dec" VALUE="00:00:00.0" onclick="setFormRadio()" onchange="checkDec(this)"></td>
	  <td><input ID="star9_Mag" NAME="star9_Mag" VALUE="9.0" onclick="setFormRadio();calculateSaturation()" onchange="checkMagnitude(this);calculateSaturation()"></td>
	  <td><select ID="star9_SpecType" NAME="star9_SpecType" onchange="setFormRadio();calculateSaturation()">
	    <option value="O7">O7V / 36500K</option>
	    <option value="O8">O8V / 34500K</option>
	    <option value="O9">O9V / 32500K</option>
	    <option value="B0">B0V / 31500K</option>
	    <option value="B1">B1V / 26000K</option>
	    <option value="B2">B2V / 20600K</option>
	    <option value="B3">B3V / 17000K</option>
	    <option value="B4">B4V / 16700K</option>
	    <option value="B5">B5V / 15700K</option>
	    <option value="B6">B6V / 14500K</option>
	    <option value="B7">B7V / 14000K</option>
	    <option value="B8">B8V / 12500K</option>
	    <option value="B9">B9V / 10700K</option>
	    <option value="A0">A0V / 9700K</option>
	    <option value="A1">A1V / 9200K</option>
	    <option value="A2">A2V / 8840K</option>
	    <option value="A3">A3V / 8550K</option>
	    <option value="A4">A4V / 8270K</option>
	    <option value="A5">A5V / 8080K</option>
	    <option value="A6">A6V / 8000K</option>
	    <option value="A7">A7V / 7800K</option>
	    <option value="A8">A8V / 7500K</option>
	    <option value="A9">A9V / 7440K</option>
	    <option value="F0">F0V / 7220K</option>
	    <option value="F1">F1V / 7030K</option>
	    <option value="F2">F2V / 6810K</option>
	    <option value="F3">F3V / 6720K</option>
	    <option value="F4">F4V / 6640K</option>
	    <option value="F5">F5V / 6510K</option>
	    <option value="F6">F6V / 6340K</option>
	    <option value="F7">F7V / 6240K</option>
	    <option value="F8">F8V / 6170K</option>
	    <option value="F9">F9V / 6040K</option>
	    <option value="G0" selected>G0V / 5920K</option>
	    <option value="G1">G1V / 5880K</option>
	    <option value="G2">G2V / 5770K</option>
	    <option value="G3">G3V / 5720K</option>
	    <option value="G4">G4V / 5680K</option>
	    <option value="G5">G5V / 5660K</option>
	    <option value="G6">G6V / 5590K</option>
	    <option value="G7">G7V / 5530K</option>
	    <option value="G8">G8V / 5490K</option>
	    <option value="G9">G9V / 5340K</option>
	    <option value="K0">K0V / 5280K</option>
	    <option value="K1">K1V / 5170K</option>
	    <option value="K2">K2V / 5040K</option>
	    <option value="K3">K3V / 4840K</option>
	    <option value="K4">K4V / 4620K</option>
	    <option value="K5">K5V / 4410K</option>
	    <option value="K6">K6V / 4230K</option>
	    <option value="K7">K7V / 4070K</option>
	    <option value="K8">K8V / 4000K</option>
	    <option value="K9">K9V / 3940K</option>
	    <option value="M0">M0V / 3870K</option>
	    <option value="M1">M1V / 3700K</option>
	    <option value="M2">M2V / 3550K</option>
	    <option value="M3">M3V / 3410K</option>
	    <option value="M4">M4V / 3200K</option>
	    <option value="M5">M5V / 3030K</option>
	    <option value="M6">M6V / 2850K</option>
	    <option value="M7">M7V / 2650K</option>
	    <option value="M8">M8V / 2500K</option>
	    <option value="M9">M9V / 2400K</option>
	  </select></td>
	</tr>
      </table>
    </ul>
    <br>

    <p><input TYPE="CHECKBOX" NAME="useTargetStarForPointing" ID="useTargetStarForPointing" VALUE="true" checked onchange="setTargetStarForPointing()">Set the pointing direction to correspond to the target star.
    <i><font color=green>If unchecked, pointing direciton will be taken from the Visit Configuration (Visit tab)</font></i>
    <a href="UserManual/CHEOPSim_UserManual.html#useTargetStarForPointing" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      
  </div>
  
  <p><input TYPE="CHECKBOX" NAME="doBackgroundStars" ID="doBackgroundStars" VALUE="false" onclick="updateStars(false)">Generate a predefined background star field in addition to the list of stars specified above <a href="UserManual/CHEOPSim_UserManual.html#doBackgroundStars" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="backgroundStars" style="display:none">
    <ul>
      <table>
	<tr>
	  <td>Star field density:
	    <select NAME="fieldCrowding" ID="fieldCrowding" onchange="updateStars(false)">
	      <option value="low">Low</option>
	      <option value="medium" selected>Medium</option>
	      <option value="extreme">Extreme</option>
	    </select>
	    <a href="UserManual/CHEOPSim_UserManual.html#doBackgroundStars" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
	  </td>
	</tr>
      </table>
    </ul>
  </div>

</div>

<script type="text/javascript">
function updateStars(updateMagThresh=true) {

    document.getElementById("nStars_subarray").value = 0;

    var xdim = parseFloat(document.getElementById("subArrayXDim").value)/3600.;//work in degrees
    var ydim = parseFloat(document.getElementById("subArrayYDim").value)/3600.;//work in degrees
    if (document.getElementById("runFrameTransferSmearer").checked) ydim*=5;

    if (document.getElementById("fileRadio").checked) {

        if ($("#starFile").val().match(/.fits$/)) {

            //console.log($("#starFile").val().match(/EXT_DRFT_StarCatalogue/,$("#starFile").val().match(/EXT_PRE_StarCatalogue/);
            if (!($("#starFile").val().match(/EXT_DRFT_StarCatalogue/)) && !($("#starFile").val().match(/EXT_PRE_StarCatalogue/))) {
                alert("ERROR: name of uploaded star file in FITS format must contain either EXT_DRFT_StarCatalogue or EXT_PRE_StarCatalogue.");
                document.getElementById("starFile").value="";
                return;
            }
            document.getElementById("updateMagThresh").value=(updateMagThresh==true?"true":"false");  //Ideally would pass updateMagThresh as argument but readStarCatalogue but doesn't work
            var fits = new FITS($("#starFile")[0].files[0], readStarCatalogue);

        } else if ($("#starFile").val().match(/.txt/)) {

            if (typeof (FileReader) != "undefined") {
                var reader = new FileReader();
                reader.onload = function (e) {

                    var stars = (e.target.result).split("\n");
                    var target = stars[0].split(/\s+/g);
                    document.getElementById("star0_Mag_file").value = target[2];
                    checkMagnitude(document.getElementById("star0_Mag_file"));
                    document.getElementById("star0_SpecType_file").value = target[3];
                    document.getElementById("targetStarFromFile").style.display = "block";

                    if (updateMagThresh) setAutoMinMag(); 
                    var minMag = parseFloat(document.getElementById("minMagnitude").value);

                    var ra_targ = convertToDegrees(target[0],true);
                    var dec_targ = convertToDegrees(target[1],false);
                    var nStars_subarray = 0;
                    for (var i = 0, len = stars.length; i < len-1; i++) {
                        var star = stars[i].split(/\s+/g);
                        var ra = convertToDegrees(star[0],true);
                        var dec = convertToDegrees(star[1],false);
                        var mag = parseFloat(star[2]);
                        //var dist = Math.sqrt((ra-ra_targ)*(ra-ra_targ)+(dec-dec_targ)*(dec-dec_targ));
                        //if (dist < Math.sqrt(xdim*ydim/Math.PI) && mag<minMag) {
                        if (Math.abs(ra-ra_targ)<xdim/2 && Math.abs(dec-dec_targ)<ydim/2 && mag<minMag) {
                            nStars_subarray++;
                        }
                    }
                    document.getElementById("nStars_subarray").value = nStars_subarray;
                    countBackgroundStars();
                }
                reader.readAsText($("#starFile")[0].files[0]);
            } else {
                alert("This browser does not support HTML5.");
            }

        } else if (document.getElementById("starFile").value != "") {
            alert("Name of uploaded file must end with '.fits' or '.txt'");
            document.getElementById("starFile").value="";
        }

    } else {

        if (updateMagThresh) setAutoMinMag(); 
        document.getElementById("nStars_subarray").value = parseInt(document.getElementById("nStars").value);
        countBackgroundStars();

    }

}
</script>

<SCRIPT language="javascript">
function setAutoMinMag() {

    //Automatically set minMag to 9 mags fainter than the target
    var minMag = parseFloat(document.getElementById("minMagnitude").value);
    var targ_mag = document.getElementById("star0_Mag").value;
    if (document.getElementById("fileRadio").checked) {
      targ_mag = document.getElementById("star0_Mag_file").value;
    }
    minMag_auto = Math.round(parseFloat(targ_mag)+9.);
    if (minMag_auto > 19) minMag_auto = 19;
      if (minMag_auto != minMag) {
        alert("New target star magnitude "+targ_mag+". Changing magnitude threshold for background stars to "+minMag_auto);
        document.getElementById("minMagnitude").value = minMag_auto;
    }

}
</SCRIPT>

<script type="text/javascript">
function countBackgroundStars() {

    var minMag = parseFloat(document.getElementById("minMagnitude").value);
    var xdim = parseFloat(document.getElementById("subArrayXDim").value)/3600.;//work in degrees
    var ydim = parseFloat(document.getElementById("subArrayYDim").value)/3600.;//work in degrees
    if (document.getElementById("runFrameTransferSmearer").checked) ydim*=5;

    if (document.getElementById("doBackgroundStars").checked) {
            
        var fieldCrowding = document.getElementById("fieldCrowding").value;
        var bkgStarFile,ra_field,dec_field;
        if (fieldCrowding=="low") {
            bkgStarFile = "Low_field.txt";
            ra_field = 213.167; //FIXME: taken form closest star in HD154088.txt - should be true field origin
            dec_field = 4.30634; //FIXME: taken form closest star in HD154088.txt - should be true field origin
        } else if (fieldCrowding=="medium") {
            bkgStarFile = "Medium_field.txt";
            ra_field = 212.499; //FIXME: taken form closest star in BD-082823.txt - should be true field origin
            dec_field = 7.59092; //FIXME: taken form closest star in BD-082823.txt - should be true field origin
        } else if (fieldCrowding=="extreme") {
            bkgStarFile = "Extreme_field.txt";
            ra_field = 256.117; //FIXME: taken form closest star in HAT-P-26.txt - should be true field origin
            dec_field = -28.8322; //FIXME: taken form closest star in HAT-P-26.txt- should be true field origin
        } else {
            alert("invalid value for field crowding"+fieldCrowding);
        }

        $.get(bkgStarFile,function(txt){
            var stars = txt.split("\n");
            var nStars_subarray = 0;
            for (var i = 0, len = stars.length; i < len-1; i++) {
                var star = stars[i].split(/\s+/g);
                var ra = convertToDegrees(star[0],true);
                var dec = convertToDegrees(star[1],false);
                var mag = parseFloat(star[2]);
                //var dist = Math.sqrt((ra-ra_field)*(ra-ra_field)+(dec-dec_field)*(dec-dec_field));
                //if (dist < Math.sqrt(xdim*ydim/Math.PI) && mag<minMag) {
                if (Math.abs(ra-ra_field)<xdim/2 && Math.abs(dec-dec_field)<ydim/2 && mag<minMag) {
                    nStars_subarray++;
                }
            }
            document.getElementById("nStars_subarray").value = parseInt(document.getElementById("nStars_subarray").value) + nStars_subarray;
            calculateRuntime();
            calculateSaturation();
        });

    } else {
        calculateRuntime();
        calculateSaturation();
    }
}
</script>

<SCRIPT language="javascript">
function readStarCatalogue() {
    var table = this.getDataUnit(1);
    
    table.getColumn("T_EFF", function(column) {

        var Teff = column[0];

        document.getElementById("star0_Teff_file").value = Teff;

        if (Teff > (36500.+34500.)/2.) specType = "O7";
        else if (Teff > (34500.+32500.)/2.) specType = "O8";
        else if (Teff > (32500.+31500.)/2.) specType = "O9";
        else if (Teff > (31500.+26000.)/2.) specType = "B0";
        else if (Teff > (26000.+20600.)/2.) specType = "B1";
	else if (Teff > (20600.+17000.)/2.) specType = "B2";
	else if (Teff > (17000.+16700.)/2.) specType = "B3";
	else if (Teff > (16700.+15700.)/2.) specType = "B4";
	else if (Teff > (15700.+14500.)/2.) specType = "B5";
	else if (Teff > (14500.+14000.)/2.) specType = "B6";
	else if (Teff > (14000.+12500.)/2.) specType = "B7";
	else if (Teff > (12500.+10700.)/2.) specType = "B8";
	else if (Teff > (10700.+9700.)/2.) specType = "B9";
	else if (Teff > (9700.+9200.)/2.) specType = "A0";
	else if (Teff > (9200.+8840.)/2.) specType = "A1";
	else if (Teff > (8840.+8550.)/2.) specType = "A2";
	else if (Teff > (8550.+8270.)/2.) specType = "A3";
	else if (Teff > (8270.+8080.)/2.) specType = "A4";
	else if (Teff > (8080.+8000.)/2.) specType = "A5";
	else if (Teff > (8000.+7800.)/2.) specType = "A6";
	else if (Teff > (7800.+7500.)/2.) specType = "A7";
	else if (Teff > (7500.+7440.)/2.) specType = "A8";
	else if (Teff > (7440.+7220.)/2.) specType = "A9";
	else if (Teff > (7220.+7030.)/2.) specType = "F0";
	else if (Teff > (7030.+6810.)/2.) specType = "F1";
	else if (Teff > (6810.+6720.)/2.) specType = "F2";
	else if (Teff > (6720.+6640.)/2.) specType = "F3";
	else if (Teff > (6640.+6510.)/2.) specType = "F4";
	else if (Teff > (6510.+6340.)/2.) specType = "F5";
	else if (Teff > (6340.+6240.)/2.) specType = "F6";
	else if (Teff > (6240.+6170.)/2.) specType = "F7";
	else if (Teff > (6170.+6040.)/2.) specType = "F8";
	else if (Teff > (6040.+5920.)/2.) specType = "F9";
	else if (Teff > (5920.+5880.)/2.) specType = "G0";
	else if (Teff > (5880.+5770.)/2.) specType = "G1";
	else if (Teff > (5770.+5720.)/2.) specType = "G2";
	else if (Teff > (5720.+5680.)/2.) specType = "G3";
	else if (Teff > (5680.+5660.)/2.) specType = "G4";
	else if (Teff > (5660.+5590.)/2.) specType = "G5";
	else if (Teff > (5590.+5530.)/2.) specType = "G6";
	else if (Teff > (5530.+5490.)/2.) specType = "G7";
	else if (Teff > (5490.+5340.)/2.) specType = "G8";
	else if (Teff > (5340.+5280.)/2.) specType = "G9";
	else if (Teff > (5280.+5170.)/2.) specType = "K0";
	else if (Teff > (5170.+5040.)/2.) specType = "K1";
	else if (Teff > (5040.+4840.)/2.) specType = "K2";
	else if (Teff > (4840.+4620.)/2.) specType = "K3";
	else if (Teff > (4620.+4450.)/2.) specType = "K4";
	else if (Teff > (4450.+4200.)/2.) specType = "K5";
	else if (Teff > (4200.+4050.)/2.) specType = "K6";
	else if (Teff > (4050.+3970.)/2.) specType = "K7";
	else if (Teff > (3970.+3880.)/2.) specType = "K8";
	else if (Teff > (3880.+3850.)/2.) specType = "K9";
	else if (Teff > (3850.+3700.)/2.) specType = "M0";
	else if (Teff > (3700.+3550.)/2.) specType = "M1";
	else if (Teff > (3550.+3400.)/2.) specType = "M2";
	else if (Teff > (3400.+3200.)/2.) specType = "M3";
	else if (Teff > (3200.+3050.)/2.) specType = "M4";
	else if (Teff > (3050.+2800.)/2.) specType = "M5";
	else if (Teff > (2800.+2650.)/2.) specType = "M6";
	else if (Teff > (2650.+2500.)/2.) specType = "M7";
	else if (Teff > (2500.+2450.)/2.) specType = "M8";
	else specType = "M9";

        document.getElementById("star0_SpecType_file").value = specType;

    });

    table.getColumn("MAG_GAIA", function(mag_column) {

        document.getElementById("star0_Mag_file").value = mag_column[0];
        checkMagnitude(document.getElementById("star0_Mag_file"))
        document.getElementById("targetStarFromFile").style.display = "block";
        calculateSaturation();

        if (document.getElementById("updateMagThresh").value=="true") setAutoMinMag();
        var minMag = parseFloat(document.getElementById("minMagnitude").value);
        var xdim = parseFloat(document.getElementById("subArrayXDim").value)/3600.;//work in degrees
        var ydim = parseFloat(document.getElementById("subArrayYDim").value)/3600.;//work in degrees
        if (document.getElementById("runFrameTransferSmearer").checked) ydim*=5;

        table.getColumn("RA", function(ra_column) {
            table.getColumn("DEC", function(dec_column) {

                var ra_targ = ra_column[0];
                var dec_targ = dec_column[0];
                var nStars_subarray = 0;
                for (var i = 0, len = ra_column.length; i < len-1; i++) {
                    var ra = parseFloat(ra_column[i]);
                    var dec = parseFloat(dec_column[i]);
                    var mag = parseFloat(mag_column[i]);
                    if (Math.abs(ra-ra_targ)<xdim/2 && Math.abs(dec-dec_targ)<ydim/2 && mag<minMag) {
                        nStars_subarray++;
                    }
                }
                document.getElementById("nStars_subarray").value = nStars_subarray;
                countBackgroundStars();

            });
        });
    });

}
</SCRIPT>

<SCRIPT language="javascript">
function setDefaultRadio() {
    document.getElementById("defaultRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function setFileRadio() {
    document.getElementById("fileRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function setFormRadio() {
    document.getElementById("formRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function addStar() {
    document.getElementById("formRadio").checked=true;
    var N = parseInt(document.getElementById("nStars").value);
    N = parseInt(N)+1;
    if (N>10) {
        alert("Maximum number of manually defined stars is 10. For a longer list of stars, please use the file upload option.");
    } else {
        var index = N-1;
        document.getElementById("star"+index).style.display = "inherit";
        document.getElementById("nStars").value = N;
    }
    updateStars(false);
}
function resetStars() {
    var N = parseInt(document.getElementById("nStars").value);
    for (var i = 1; i < N; i++) {
        document.getElementById("star"+i).style.display = "none";
    }    
    document.getElementById("nStars").value = 1;
    updateStars(false);
}
function displayManualStars() {
    var N = parseInt(document.getElementById("nStars").value);
    for (var i = 1; i < N; i++) {
        document.getElementById("star"+i).style.display = "inherit";
    }    
}
</SCRIPT>

</div>
<div id="StellarFluxTab" class="tabcontent">
						  
<h3 id="linkTransitFluxModulator"><input TYPE="CHECKBOX" NAME="runTransitFluxModulator_star0" id="runTransitFluxModulator_star0" VALUE="true" CHECKED> Module: TransitFluxModulator (target star) 
<a href="UserManual/CHEOPSim_UserManual.html#TransitFluxModulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="TransitFluxModulator_star0">
  <table>
    <tr>
      <td>Time of midpoint of first transit as a fraction of the simulation duration</td>
      <td><input NAME="firstTransitTime_star0" ID="firstTransitTime_star0" VALUE="0.5" onchange="checkFirstTransitTime()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#firstTransitTime" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet radius as a multiple of the radius of
	<select NAME="planetScale_star0" ID="planetScale_star0" onchange="checkImpactParameter()">
	  <option value="Jupiter" selected>Jupiter</option>
	  <option value="Neptune" selected>Neptune</option>
	  <option value="Earth">Earth</option>
	</select>
      </td>
      <td><input NAME="planetRadius_star0" ID="planetRadius_star0" VALUE="1.0" onchange="checkFloat(this);checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#planetRadius" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet orbit period around the star in
	<select NAME="orbitUnits_star0" ID="orbitUnits_star0">
	  <option value="hours">hours</option>
	  <option value="days" selected>days</option>
	</select>
      </td>
      <td><input NAME="orbitPeriod_star0" ID="orbitPeriod_star0" VALUE="2.0" onchange="checkNonZeroFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#orbitPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Impact parameter for the transit (smallest distance from planet centre to star centre divided by star radius)</td>
      <td><input NAME="impactParameter_star0" ID="impactParameter_star0" VALUE="0.0" onchange="checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#impactParameter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td><input type="checkbox" name="doLimbDarkening_star0" id="doLimbDarkening_star0" VALUE="true" CHECKED> Include limb darkening
      <a href="UserManual/CHEOPSim_UserManual.html#limbDarkening" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></td>
    </tr>
  </table>
</div>
						  
<h3 id="linkTransitFluxModulator"><input TYPE="CHECKBOX" NAME="runTransitFluxModulator_star1" id="runTransitFluxModulator_star1" VALUE="false"> Module: TransitFluxModulator (background star 1) 
<a href="UserManual/CHEOPSim_UserManual.html#TransitFluxModulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="TransitFluxModulator_star1">
  <table>
    <tr>
      <td>Time of midpoint of first transit as a fraction of the simulation duration</td>
      <td><input NAME="firstTransitTime_star1" ID="firstTransitTime_star1" VALUE="0.5" onchange="checkFirstTransitTime()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#firstTransitTime" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet radius as a multiple of the radius of
	<select NAME="planetScale_star1" ID="planetScale_star1" onchange="checkImpactParameter()">
	  <option value="Jupiter" selected>Jupiter</option>
	  <option value="Neptune" selected>Neptune</option>
	  <option value="Earth">Earth</option>
	</select>
      </td>
      <td><input NAME="planetRadius_star1" ID="planetRadius_star1" VALUE="1.0" onchange="checkFloat(this);checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#planetRadius" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet orbit period around the star in
	<select NAME="orbitUnits_star1" ID="orbitUnits_star1">
	  <option value="hours">hours</option>
	  <option value="days" selected>days</option>
	</select>
      </td>
      <td><input NAME="orbitPeriod_star1" ID="orbitPeriod_star1" VALUE="2.0" onchange="checkNonZeroFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#orbitPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Impact parameter for the transit (smallest distance from planet centre to star centre divided by star radius)</td>
      <td><input NAME="impactParameter_star1" ID="impactParameter_star1" VALUE="0.0" onchange="checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#impactParameter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td><input type="checkbox" name="doLimbDarkening_star1" id="doLimbDarkening_star1" VALUE="true" CHECKED> Include limb darkening
      <a href="UserManual/CHEOPSim_UserManual.html#limbDarkening" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></td>
    </tr>
  </table>
</div>
						  
<h3 id="linkTransitFluxModulator"><input TYPE="CHECKBOX" NAME="runTransitFluxModulator_star2" id="runTransitFluxModulator_star2" VALUE="false"> Module: TransitFluxModulator (background star 2) 
<a href="UserManual/CHEOPSim_UserManual.html#TransitFluxModulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="TransitFluxModulator_star2">
  <table>
    <tr>
      <td>Time of midpoint of first transit as a fraction of the simulation duration</td>
      <td><input NAME="firstTransitTime_star2" ID="firstTransitTime_star2" VALUE="0.5" onchange="checkFirstTransitTime()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#firstTransitTime" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet radius as a multiple of the radius of
	<select NAME="planetScale_star2" ID="planetScale_star2" onchange="checkImpactParameter()">
	  <option value="Jupiter" selected>Jupiter</option>
	  <option value="Neptune" selected>Neptune</option>
	  <option value="Earth">Earth</option>
	</select>
      </td>
      <td><input NAME="planetRadius_star2" ID="planetRadius_star2" VALUE="1.0" onchange="checkFloat(this);checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#planetRadius" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Planet orbit period around the star in
	<select NAME="orbitUnits_star2" ID="orbitUnits_star2">
	  <option value="hours">hours</option>
	  <option value="days" selected>days</option>
	</select>
      </td>
      <td><input NAME="orbitPeriod_star2" ID="orbitPeriod_star2" VALUE="2.0" onchange="checkNonZeroFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#orbitPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Impact parameter for the transit (smallest distance from planet centre to star centre divided by star radius)</td>
      <td><input NAME="impactParameter_star2" ID="impactParameter_star2" VALUE="0.0" onchange="checkImpactParameter()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#impactParameter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td><input type="checkbox" name="doLimbDarkening_star2" id="doLimbDarkening_star2" VALUE="true" CHECKED> Include limb darkening
      <a href="UserManual/CHEOPSim_UserManual.html#limbDarkening" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></td>
    </tr>
  </table>
</div>

<hr>						  
<h3 id="linkStellarNoiseFluxModulator"><input TYPE="CHECKBOX" NAME="runStellarNoiseFluxModulator_star0" id="runStellarNoiseFluxModulator_star0" VALUE="true" CHECKED> Module: StellarNoiseFluxModulator (target star) 
<a href="UserManual/CHEOPSim_UserManual.html#StellarNoiseFluxModulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="StellarNoiseFluxModulator_star0">
</div>

<hr>						  
<h3 id="linkStellarVariationFluxModulator"><input TYPE="CHECKBOX" NAME="runStellarVariationFluxModulator_star0" id="runStellarVariationFluxModulator_star0" VALUE="false"> Module: StellarVariationFluxModulator (target star) 
<a href="UserManual/CHEOPSim_UserManual.html#StellarVariationFluxModulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="StellarVariationFluxModulator_star0" style="display:none">
  <table>
    <tr>
      <td>Stellar rotation period in days</td>
      <td><input NAME="rotationPeriod" ID="rotationPeriod" VALUE="5.0" onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#rotationPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Seed for random number generation</td>
      <td><input NAME="stellarVariationSeed" ID="stellarVariationSeed" VALUE="1234" onchange="checkInteger(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#stellarVariationSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
</div>

<hr>						  
<h3 id="linkUserFluxModifier"><input TYPE="CHECKBOX" NAME="runUserFluxModifier_star0" id="runUserFluxModifier_star0" VALUE="false"> Module: UserFluxModifier (target star) 
<a href="UserManual/CHEOPSim_UserManual.html#UserFluxModifier" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="UserFluxModifier_star0" style="display:none">
  Upload a file to define the flux time series for the target star relative to the nominal flux:
  <p><input type="file" name="userFluxUploadFile" id="userFluxUploadFile"/>
  <a href="UserManual/CHEOPSim_UserManual.html#UserFluxModifier" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
</div>

</div>
<div id="SatelliteTab" class="tabcontent">
  						
<h3 id="linkJitterProducer"><input TYPE="CHECKBOX" NAME="runJitterProducer" ID="runJitterProducer" VALUE="true" CHECKED> Module: JitterProducer 
<a href="UserManual/CHEOPSim_UserManual.html#JitterProducer" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="JitterProducer">
  <input type="radio" name="jitterInputMethod" id="jitterSelectRadio" value="select" checked>Select a pre-existing file to define the jitter time series:
  <select name="jitterFilename" id="jitterFilename" onchange="setJitterSelectRadio()">
    <option value="48hrAOCSTimeseries2016_simu2_1s.fits" selected>48hrAOCSTimeseries2016_simu2_1s.fits (not blinded, 4RW, 2ST, Oct 2016)</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#JitterProducer" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p><input type="radio" name="jitterInputMethod" id="jitterUploadRadio" value="upload">Upload a file to define the jitter time series:
  <a href="UserManual/CHEOPSim_UserManual.html#jitterUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul>
    <input type="file" name="jitterUploadFile" id="jitterUploadFile" onclick="setJitterUploadRadio()"/>
    <p>Omit the first <input NAME="jitterFileOffset" ID="jitterFileOffset" VALUE="0." onclick="setJitterUploadRadio()" onchange="checkFloat(this)"> seconds from the uploaded file
    <a href="UserManual/CHEOPSim_UserManual.html#jitterFileOffset" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </ul>
  <p>Scale factor to apply to jitter RMS <input NAME="jitterScale" ID="jitterScale" VALUE="1.0" onchange="checkFloat(this)">
  <a href="UserManual/CHEOPSim_UserManual.html#jitterScale" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
</div>

<SCRIPT language="javascript">
function setJitterSelectRadio() {
    document.getElementById("jitterSelectRadio").checked=true;
}
function setJitterUploadRadio() {
    document.getElementById("jitterUploadRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function setOrbitSelectRadio() {
    document.getElementById("orbitSelectRadio").checked=true;
}
function setOrbitUploadRadio() {
    document.getElementById("orbitUploadRadio").checked=true;
}
</SCRIPT>

<hr>						  
<h3 id="linkOrbitSimulator"><input TYPE="CHECKBOX" NAME="runOrbitSimulator" ID="runOrbitSimulator" VALUE="true" CHECKED> Module: OrbitSimulator 
<a href="UserManual/CHEOPSim_UserManual.html#OrbitSimulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="OrbitSimulator">
  <input type="radio" name="orbitInputMethod" id="orbitSelectRadio" value="select" checked>Select a pre-existing orbit model: 
  <select name="orbitFilename" id="orbitFilename" onchange="setSAAMap();checkStartTime(document.getElementById('startTime'));setOrbitSelectRadio()">
    <option value="AUX_REF_Orbit_20181231_20220801_V0000" selected>Reference orbit from INTA, valid 31/12/2018 - 01/08/2022; altitude: 700km, LTAN: 6am</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#orbitFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p><input type="radio" name="orbitInputMethod" id="orbitUploadRadio" value="upload">Upload an orbit file in format <a href="https://htmlpreview.github.io/?https://github.com/davefutyan/common_sw/blob/master/doc/fits_data_model/AUX_RES_Orbit.html" target="_blank">AUX_RES_Orbit</a>:
  <!--<a href="UserManual/CHEOPSim_UserManual.html#orbitUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>-->
  <ul>
    <input type="file" name="orbitUploadFile" id="orbitUploadFile" onclick="setOrbitUploadRadio()"/>
  </ul>
  <input id="SAAMapFilename" name="SAAMapFilename" style="display:none" value="CH_TU2020-03-11T00-00-00_EXT_APP_SAAMap-700km_V0102.fits">
  <p><table>
    <tr>
      <td>Cadence for writing out spacecraft attitude data (seconds)</td><td><input NAME="attitudeCadence" ID="attitudeCadence" VALUE="1" onchange="checkInteger(this)">
	<a href="UserManual/CHEOPSim_UserManual.html#attitudeCadence" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td>
    </tr>
    <tr>
      <td>Cadence for writing out spacecraft orbit data (minutes)</td><td><input NAME="orbitCadence" ID="orbitCadence" VALUE="5" onchange="checkInteger(this)">
	<a href="UserManual/CHEOPSim_UserManual.html#orbitCadence" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td>
    </tr>
  </table>
  <p><input TYPE="CHECKBOX" NAME="saaFlagFromVisitConstraints" ID="saaFlagFromVisitConstraints" VALUE="false" disabled> Read SAA flags, stray light flags and Earth occultation flags from MPS_PRE_VisitConstraints <font color="green"><i>- requires MPS_PRE_Visits file with this extension to be uploaded in Visit tab</i></font color>
  <a href="UserManual/CHEOPSim_UserManual.html#saaFlagFromVisitConstraints" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
  <p><input TYPE="CHECKBOX" NAME="rotateFOV" ID="rotateFOV" VALUE="true" CHECKED> Apply field of view rotation
  <a href="UserManual/CHEOPSim_UserManual.html#rotateFOV" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
  <div id="rotation">
    <ul>
      Minimum angle between pointing direction and orbital plane (degrees) <input NAME="minAngleToOrbitalPlane" ID="minAngleToOrbitalPlane" VALUE="10" onchange="checkInteger(this)">
      <a href="UserManual/CHEOPSim_UserManual.html#minAngleToOrbitalPlane" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <ul>
  </div>
  <p><input TYPE="CHECKBOX" NAME="telescopeTemperatureVariation" ID="telescopeTemperatureVariation" VALUE="true" CHECKED> Temperature variation for telescope optics <font color="green"><i> - Affects PSF (if thermal map is set to "breathing" in PSFGenerator (Telescope tab)) and HK data</i></font> :
  <div id="telescopeTemp">
    <ul>
      <p><input type="radio" name="telescopeTemperatureMethod" id="telescopeTemperatureFileRadio" value="file" checked>Read temperature time series from an existing file:
      <select name="telescopeTemperatureFilename" id="telescopeTemperatureFilename" onchange="setTelescopeTemperatureFileRadio()">
	<option value="temperature_telescope.fits" selected>temperature_telescope.fits</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#telescopeTemperatureFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <p><input type="radio" name="telescopeTemperatureMethod" id="telescopeTemperatureUploadRadio" value="upload">Upload a file to define the temperature time series:
      <a href="UserManual/CHEOPSim_UserManual.html#telescopeTemperatureUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <input type="file" name="telescopeTemperatureUploadFile" id="telescopeTemperatureUploadFile" onclick="setTelescopeTemperatureUploadRadio()"/>      
      <p><input type="radio" name="telescopeTemperatureMethod" id="telescopeTemperatureSinusoidRadio" value="sinusoid">Sinusoidal temperature variation:
      <ul>
	<table>
	  <tr>
	    <td>Mean (Kelvin)</td>
	    <td><input NAME="telescopeMeanTemperature" ID="telescopeMeanTemperature" VALUE="263" onchange="checkFloat(this);setTelescopeTemperatureSinusoidRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#telescopeMeanTemperature" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	  <tr>
	    <td>Amplitude (Kelvin)</td>
	    <td><input NAME="telescopeTemperatureAmplitude" ID="telescopeTemperatureAmplitude" VALUE="1" onchange="checkFloat(this);setTelescopeTemperatureSinusoidRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#telescopeTemperatureAmplitude" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	  <tr>
	    <td>Period (minutes)</td>
	    <td><input NAME="telescopeTemperaturePeriod" ID="telescopeTemperaturePeriod" VALUE="98.5" onchange="checkFloat(this);setTelescopeTemperatureSinusoidRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#telescopeTemperaturePeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	</table>
      </ul>
    </ul>
  </div>
  <div id="ccdTemp" style="display:none">
    <p><input TYPE="CHECKBOX" NAME="ccdTemperatureVariation" ID="ccdTemperatureVariation" VALUE="false"> Sinusoidal temperature variation for CCD <font color="green"><i> - Affects dark current, QE and HK data</i></font> :
    <ul>
      <table>
	<tr>
	  <td>Mean (Kelvin)</td>
	  <td><input NAME="ccdMeanTemperature" ID="ccdMeanTemperature" VALUE="233" onchange="checkFloat(this)">
	  <td><a href="UserManual/CHEOPSim_UserManual.html#ccdMeanTemperature" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Amplitude (Kelvin)</td>
	  <td><input NAME="ccdTemperatureAmplitude" ID="ccdTemperatureAmplitude" VALUE="0.002" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#ccdTemperatureAmplitude" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Period (minutes)</td>
	  <td><input NAME="ccdTemperaturePeriod" ID="ccdTemperaturePeriod" VALUE="1.2" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#ccdTemperaturePeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
    </ul>
  </div>
  <div id="feeTemp" style="display:none">
    <p><input TYPE="CHECKBOX" NAME="feeTemperatureVariation" ID="feeTemperatureVariation" VALUE="false"> Sinusoidal temperature variation for FEE <font color="green"><i> - Affects bias voltages, gain and HK data</i></font> :
    <ul>
      <table>
	<tr>
	  <td>Mean (Kelvin)</td>
	  <td><input NAME="feeMeanTemperature" ID="feeMeanTemperature" VALUE="263" onchange="checkFloat(this)">
	  <td><a href="UserManual/CHEOPSim_UserManual.html#feeMeanTemperature" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Amplitude (Kelvin)</td>
	  <td><input NAME="feeTemperatureAmplitude" ID="feeTemperatureAmplitude" VALUE="0.001" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#feeTemperatureAmplitude" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Period (minutes)</td>
	  <td><input NAME="feeTemperaturePeriod" ID="feeTemperaturePeriod" VALUE="6" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#feeTemperaturePeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
    </ul>
  </div>
</div>

<SCRIPT language="javascript">
function setSAAMap() {
    var orbitFilename = document.getElementById("orbitFilename").value;
    if (orbitFilename.indexOf("800km")!=-1) {
      document.getElementById("SAAMapFilename").value="CH_TU2016-01-01T00-00-00_EXT_APP_SAAMap-800km_V000.fits";
    } else {
      document.getElementById("SAAMapFilename").value="CH_TU2020-03-11T00-00-00_EXT_APP_SAAMap-700km_V0102.fits";
    }
    //console.log(document.getElementById("SAAMapFilename").value);
}
function setTelescopeTemperatureFileRadio() {
    document.getElementById("telescopeTemperatureFileRadio").checked=true;
}
function setTelescopeTemperatureUploadRadio() {
    document.getElementById("telescopeTemperatureUploadRadio").checked=true;
}
function setTelescopeTemperatureSinusoidRadio() {
    document.getElementById("telescopeTemperatureSinusoidRadio").checked=true;
}
</SCRIPT>

</div>
<div id="TelescopeTab" class="tabcontent">
						
<h3 id="linkFocalPlaneGenerator"><input TYPE="CHECKBOX" NAME="runFocalPlaneGenerator" ID="runFocalPlaneGenerator" VALUE="true" CHECKED> Module: FocalPlaneGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#FocalPlaneGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="FocalPlaneGenerator">
  <p><input type="radio" name="imageSizeRadio" id="subArrayRadio" value="subArray" checked> Define dimensions and positioning of the sub-array:
  <ul>
    <table>
      <tr>
	<td>Size of image sub-array in X dimension (pixels)</td>
	<td><input NAME="subArrayXDim" ID="subArrayXDim" VALUE="200" onclick="setSubArrayRadio()" onchange="checkInteger(this);updateStars(false)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#subArrayXDim" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Size of image sub-array in Y dimension (pixels)</td>
	<td><input NAME="subArrayYDim" ID="subArrayYDim" VALUE="200" onclick="setSubArrayRadio()" onchange="checkInteger(this);updateStars(false)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#subArrayYDim" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Offset of first column of image sub-array w.r.t. left edge of exposed part of CCD</td>
	<td><input NAME="subArrayXOffset" ID="subArrayXOffset" VALUE="163" onclick="setSubArrayRadio()" onchange="checkInteger(this)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#subArrayXOffset" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Offset of first row of image sub-array w.r.t. bottom edge of exposed part of CCD</td>
	<td><input NAME="subArrayYOffset" ID="subArrayYOffset" VALUE="742" onclick="setSubArrayRadio()" onchange="checkInteger(this)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#subArrayYOffset" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
    </table>
  </ul>
  <p><input type="radio" name="imageSizeRadio" id="fullFrameRadio" value="fullFrame" onclick="setRectangular()"> Generate all images as full frame
  <table>
    <tr>
      <td>X coordinate of intended target location / axis of FOV rotation, w.r.t. left edge of exposed part of CCD</td>
      <td><input NAME="targetLocationX" ID="targetLocationX" VALUE="263.0" onchange="checkPosNegFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#targetLocationX" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Y coordinate of intended target location / axis of FOV rotation, w.r.t. bottom edge of exposed part of CCD</td>
      <td><input NAME="targetLocationY" ID="targetLocationY" VALUE="842.0" onchange="checkPosNegFloat (this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#targetLocationY" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
</div>
<hr>
<input NAME="targetLocationListX" ID="targetLocationListX" style="display:none" VALUE="null"></td>
<input NAME="targetLocationListY" ID="targetLocationListY" style="display:none" VALUE="null"></td>

<h3 id="linkZodiacalLightGenerator"><input TYPE="CHECKBOX" NAME="runZodiacalLightGenerator" ID="runZodiacalLightGenerator" VALUE="true" CHECKED onchange="checkSolarAvoidanceZone()"> Module: ZodiacalLightGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#ZodiacalLightGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>


<SCRIPT language="javascript">
function setSubArrayRadio () {
    document.getElementById("subArrayRadio").checked=true;
}
function setRectangular () {
    document.getElementById("subarrayShape").value="rectangular";
}
</SCRIPT>

<hr>						
<h3 id="linkStrayLightGenerator"><input TYPE="CHECKBOX" NAME="runStrayLightGenerator" ID="runStrayLightGenerator" VALUE="true" CHECKED> Module: StrayLightGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#StrayLightGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="StrayLightGenerator">
  <p>Stray light threshold, above which images are omitted (if requested in Output tab)
  <input NAME="strayLightThreshold" ID="strayLightThreshold" VALUE="1.E9" onchange="checkFloat(this)">
  <a href="UserManual/CHEOPSim_UserManual.html#strayLightThreshold" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p><input type="radio" name="strayLightInputMethod" id="strayLightSelectRadio" value="select" checked>Select stray light scenario: 
  <select name="strayLightFile" id="strayLightFile" onchange="setStrayLightSelectRadio()">
    <option value="sl_timeseries_6am_SSO650km_low.fits">low</option>
    <option value="sl_timeseries_6am_SSO650km_medium.fits" selected>medium</option>
    <option value="sl_timeseries_6am_SSO650km_high.fits">high</option>
    <option value="sl_timeseries_6am_SSO650km_high_select_2.01peak.fits">ultra high</option>
    <option value="sl_timeseries_6am_SSO650km_catastrophic.fits">catastrophic</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#StrayLightGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p><input type="radio" name="strayLightInputMethod" id="strayLightUploadRadio" value="upload">Upload a file to define stray light time series:
  <a href="UserManual/CHEOPSim_UserManual.html#strayLightUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <input type="file" name="strayLightUploadFile" id="strayLightUploadFile" onclick="setStrayLightUploadRadio()"/>
  <p><input type="radio" name="strayLightInputMethod" id="strayLightFromVisitConstraints" value="visitConstraints" disabled>Read stray light from MPS_PRE_VisitConstraints <font color="green"><i>- requires MPS_PRE_Visits file with this extension to be uploaded in Visit tab</i></font color>
  <a href="UserManual/CHEOPSim_UserManual.html#strayLightFromVisitConstraints" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
</div>

<SCRIPT language="javascript">
function setStrayLightSelectRadio() {
    document.getElementById("strayLightSelectRadio").checked=true;
}
function setStrayLightUploadRadio() {
    document.getElementById("strayLightUploadRadio").checked=true;
}
function setStrayLightMpsRadio() {
    document.getElementById("strayLightFromVisitConstraints").disabled=false;
    document.getElementById("strayLightFromVisitConstraints").checked=true;
}
</SCRIPT>

<hr>						
<h3 id="linkPSFGenerator"><input TYPE="CHECKBOX" NAME="runPSFGenerator" ID="runPSFGenerator" VALUE="true" CHECKED> Module: PSFGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#PSFGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="PSFGenerator">
  
  <input type="radio" name="PsfType" id="whitePSFradio" value="white" checked onchange="setWhitePSFradio();setOversampling();calculateSaturation();setCCDLocation()">Select white PSF (flat combination over wavelength range 330-1100nm):
  <select name="whitePSF_filename" id="whitePSF_filename" onchange="setOversampling();calculateSaturation();setCCDLocation()">
    <option value="CH_TU2020-04-18T06-30-00_REF_APP_WhiteCCDLocationPSF_V0103.fits">In flight PSF according to target location: CH_TU2020-04-18T06-30-00_REF_APP_WhiteCCDLocationPSF_V0103.fits</option>
    <option value="CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits" selected>In flight PSF at CCD location (263,842): CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits</option>
    <option value="FLAT">FLAT (Uniform over 200x200 pixels)</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#whitePSF" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <p><input type="radio" name="PsfType" id="monochromaticPSFradio" value="monochromatic" onchange="setMonochromaticPSFradio();setOversampling();setCCDLocation()">Select monochromatic PSF:
  <select name="monochromaticPSF_filename" id="monochromaticPSF_filename" disabled>
    <option value="PSF_Field1_def0.000mm_W_350_1100nm_Dwave5nm_radius12px_nominal_monochromatic.fits" selected>Nominal, 12 pixel radius, Field1: PSF_Field1_def0.000mm_W_350_1100nm_Dwave5nm_radius12px_nominal_monochromatic.fits</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#monochromaticPSF" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul>
    <input type="radio" name="monoPSFweighting" id="monoPSFblackbodyRadio" value="blackbody" checked disabled>Weighted combination over wavelength range 350-1100nm
    <a href="UserManual/CHEOPSim_UserManual.html#PSFGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    <p><input type="radio" name="monoPSFweighting" id="monoPSFsingleWavelengthRadio" value="singleWavelength" disabled>Select a specific wavelength:
    <select name="monoPSFwavelength" id="monoPSFwavelength" onchange="setMonoPSFsingleWavelengthRadio()" disabled>
      <option value="375">375nm</option>
      <option value="425">425nm</option>
      <option value="475">475nm</option>
      <option value="525">525nm</option>
      <option value="575">575nm</option>
      <option value="625">625nm</option>
      <option value="675">675nm</option>
      <option value="725">725nm</option>
      <option value="775">775nm</option>
      <option value="825">825nm</option>
      <option value="875">875nm</option>
      <option value="925">925nm</option>
      <option value="975">975nm</option>
      <option value="1025">1025nm</option>
      <option value="1075">1075nm</option>
    </select>
    <a href="UserManual/CHEOPSim_UserManual.html#monochromaticPSFwavelength" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </ul>

  <p>Select thermal map: <select name="thermalMap" id="thermalMap">
    <option value="fixed" selected>fixed</option>
    <option value="cold">cold</option>
    <option value="hot1">hot1</option>
    <option value="hot2">hot2</option>
    <option value="breathing">breathing (requires OrbitSimulator)</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#psfTemperature" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  
  <p>Select sampling rate for jitter and roll angle: <select name="oversampleJitter" id="oversampleJitter" onchange="calculateRuntime()">
    <option value="true" selected>Once per second</option>
    <option value="false">Once per exposure</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#oversampleJitter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p>Method for sub-pixel positioning of the PSF for the target star <select name="targetStarPositioning" id="targetStarPositioning" onchange="calculateRuntime()">
    <option value="Oversampling" id="targetOversampling">Oversampling</option>
    <option value="Interpolation" selected>Interpolation</option>
    <option value="SnapToGrid">SnapToGrid</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#psfPositioningMethod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <p>Method for sub-pixel positioning of the PSF for background stars <select name="backgroundStarPositioning" id="backgroundStarPositioning" onchange="calculateRuntime()">
    <option value="Oversampling" id="backgroundOversampling" disabled>Oversampling</option>
    <option value="Interpolation" selected>Interpolation</option>
    <option value="SnapToGrid">SnapToGrid</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#psfPositioningMethod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <!--<p>Estimated run time (hours): <input name="runtime" id="runtime" VALUE="" onclick="calculateRuntime()" readonly>-->
  <!-- <br><input TYPE="CHECKBOX" NAME="convertFluxToPhotons" VALUE="true" CHECKED>Convert flux (ergs/s/nm) to photons/s/nm. This should normally always be switched on but can be switched off in order to perform a closure test that the input flux is recovered in the extracted light curve. -->
</div>

<SCRIPT language="javascript">
function setOversampling() {

   if (document.getElementById("whitePSFradio").checked &&
          (document.getElementById("whitePSF_filename").value == "CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0100.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0101.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0102.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-01-29T00-00-00_REF_APP_WhitePSF_V0105.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-04-18T06-30-00_REF_APP_WhiteCCDLocationPSF_V0103.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-01-29T00-00-00_REF_APP_WhiteCCDLocationPSF_V0101.fits" ||
           document.getElementById("whitePSF_filename").value == "PSF_SelectedMeasurement_12px_-10C.fits")) {
      if (document.getElementById("targetStarPositioning").value == "Oversampling") {
        document.getElementById("targetStarPositioning").value = "Interpolation";
      }
      if (document.getElementById("backgroundStarPositioning").value == "Oversampling") {
        document.getElementById("backgroundStarPositioning").value = "Interpolation";
      }
      document.getElementById("targetOversampling").disabled = true;
      document.getElementById("backgroundOversampling").disabled = true;
   } else {
      var alertString = "";
      if (document.getElementById("targetStarPositioning").value == "Interpolation") {
        alertString += "Spatial oversampling is available for the selected PSF. Target star sub-pixel positioning will be automatically changed to oversampling. Please change back to interpolation if desired for faster run time.";
        document.getElementById("targetStarPositioning").value = "Oversampling";
      }
      document.getElementById("targetOversampling").disabled = false;
      document.getElementById("backgroundOversampling").disabled = false;
      if (alertString != "") alert(alertString);
   }

   if (document.getElementById("whitePSFradio").checked &&
          (document.getElementById("whitePSF_filename").value == "CH_TU2018-01-01T00-00-00_REF_APP_WhitePSF_V0100.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-01-29T00-00-00_REF_APP_WhitePSF_V0105.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-04-18T06-30-00_REF_APP_WhiteCCDLocationPSF_V0103.fits" ||
           document.getElementById("whitePSF_filename").value == "CH_TU2020-01-29T00-00-00_REF_APP_WhiteCCDLocationPSF_V0101.fits" ||
           document.getElementById("whitePSF_filename").value == "PSF_SelectedMeasurement_12px_-10C.fits")) {
      document.getElementById("runHaloGenerator").checked = false;
      $('#HaloGenerator').fadeOut();
   } else {
      var alertString = "";
      if (!document.getElementById("runHaloGenerator").checked) {
        alertString += "The selected PSF has synthetic tails. HaloGenerator will be automatically switched on. Please switch off again if desired.\n\n";
        document.getElementById("runHaloGenerator").checked = true;
        $('#HaloGenerator').fadeIn();
      }
      if (alertString != "") alert(alertString);
   }
}
function setCCDLocation() {
    if (document.getElementById("whitePSF_filename").value == "CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits") {
        document.getElementById("subArrayXOffset").value = 163
        document.getElementById("subArrayYOffset").value = 742
        document.getElementById("targetLocationX").value = 263; 
        document.getElementById("targetLocationY").value = 842;
    } else {
        document.getElementById("subArrayXOffset").value = 412; 
        document.getElementById("subArrayYOffset").value = 412;
        document.getElementById("targetLocationX").value = 512; 
        document.getElementById("targetLocationY").value = 512; 
    }
}
function setMonochromaticPSFradio() {
    document.getElementById("monochromaticPSFradio").checked=true;
    document.getElementById("monochromaticPSF_filename").disabled=false;
    document.getElementById("monoPSFblackbodyRadio").disabled=false;
    document.getElementById("monoPSFsingleWavelengthRadio").disabled=false;
    document.getElementById("monoPSFwavelength").disabled=false;
    document.getElementById("whitePSF_filename").disabled=true;
}
function setWhitePSFradio() {
    document.getElementById("whitePSFradio").checked=true;
    document.getElementById("monochromaticPSF_filename").disabled=true;
    document.getElementById("monoPSFblackbodyRadio").disabled=true;
    document.getElementById("monoPSFsingleWavelengthRadio").disabled=true;
    document.getElementById("monoPSFwavelength").disabled=true;
    document.getElementById("whitePSF_filename").disabled=false;
}
function setMonoPSFsingleWavelengthRadio() {
    document.getElementById("monoPSFsingleWavelengthRadio").checked=true;
}
function setPSFDropDown() {
   if (document.getElementById("whitePSFradio").checked) {
      setWhitePSFradio();
   } else {
      setMonochromaticPSFradio();
   }
}
</SCRIPT>

<hr>						
<h3 id="linkHaloGenerator"><input TYPE="CHECKBOX" NAME="runHaloGenerator" ID="runHaloGenerator" VALUE="true" checked> Module: HaloGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#HaloGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="HaloGenerator">
  <p><input TYPE="CHECKBOX" NAME="doGhosts" ID="doGhosts" VALUE="true" CHECKED> Include ghosts <a href="UserManual/CHEOPSim_UserManual.html#doGhosts" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
</div>

<hr>						
<h3 id="linkGlobalThroughputGenerator"><input TYPE="CHECKBOX" NAME="runGlobalThroughputGenerator" ID="runGlobalThroughputGenerator" VALUE="true" CHECKED onclick="calculateSaturation()"> Module: GlobalThroughputGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#GlobalThroughputGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="GlobalThroughputGenerator">

  <font color="green"><i>NOTE: Changing the following parameters only affects the global throughput and does not affect the flat field. The flat field is read in from a pre-weighted library generated using the default throughput and QE.</i></font>
  
  <p><input TYPE="CHECKBOX" NAME="applyThroughput" ID="applyThroughput" VALUE="true" CHECKED onclick="calculateSaturation()"> Apply optical throughput <a href="UserManual/CHEOPSim_UserManual.html#applyThroughput" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="throughput">
    <ul>
      <p><input type="radio" name="throughputInputMethod" id="throughputSelectRadio" value="select" checked>Select throughput file:
      <select name="throughputFilename" id="throughputFilename" onchange="setThroughputSelectRadio()">
	<option value="CH_TU2018-01-01T00-00-00_REF_APP_Throughput-BeginOfLife_V0101.fits" selected>CH_TU2018-01-01T00-00-00_REF_APP_Throughput-BeginOfLife_V0101.fits (latest, beginning of life)</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#throughputFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <p><input type="radio" name="throughputInputMethod" id="throughputUploadRadio" value="upload">Upload a file:
      <a href="UserManual/CHEOPSim_UserManual.html#throughputUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <input type="file" name="throughputUploadFile" id="throughputUploadFile" onclick="setThroughputUploadRadio()"/>
    </ul>
  </div>
  
  <input TYPE="CHECKBOX" NAME="applyQE" ID="applyQE" VALUE="true" CHECKED onclick="calculateSaturation()"> Apply quantum efficiency
  <a href="UserManual/CHEOPSim_UserManual.html#applyQE" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="QE">
    <ul>
      <p><input type="radio" name="qeInputMethod" id="qeSelectRadio" value="select" checked>Select quantum efficiency file:
      <select name="QEFilename" id="QEFilename" onchange="setQESelectRadio()">
	<option value="CH_TU2020-01-29T00-00-00_REF_APP_QE_V0102.fits" selected>CH_TU2020-01-29T00-00-00_REF_APP_QE_V0102.fits (2020 ESA measurement of FM1 duplicate)</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#qeFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <p><input type="radio" name="qeInputMethod" id="qeUploadRadio" value="upload">Upload a file:
      <a href="UserManual/CHEOPSim_UserManual.html#qeUploadFile" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <input type="file" name="qeUploadFile" id="qeUploadFile" onclick="setQEUploadRadio()"/>
    </ul>
  </div>
  
</div>

<SCRIPT language="javascript">
function setThroughputSelectRadio() {
    document.getElementById("throughputSelectRadio").checked=true;
}
function setThroughputUploadRadio() {
    document.getElementById("throughputUploadRadio").checked=true;
}
function setQESelectRadio() {
    document.getElementById("qeSelectRadio").checked=true;
}
function setQEUploadRadio() {
    document.getElementById("qeUploadRadio").checked=true;
}
</SCRIPT>

</div>
<div id="DetectorTab" class="tabcontent">
  						  
<h3 id="linkFlatFieldGenerator"><input TYPE="CHECKBOX" NAME="runFlatFieldGenerator" ID="runFlatFieldGenerator" VALUE="true" CHECKED> Module: FlatFieldGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#FlatFieldGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="FlatFieldGenerator">
  <p><input TYPE="CHECKBOX" NAME="applyFlatField" ID="applyFlatField" VALUE="true" CHECKED> Apply flat field <a href="UserManual/CHEOPSim_UserManual.html#applyFlatField" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="flatField">
    <ul>
      <p><input type="radio" name="flatFieldMethod" id="flatFieldFileRadio" value="file" checked>Empirical flat field from laboratory measurements with wavelength weighting according to effective temperature
      <select name="flatFieldFilename" id="flatFieldFilename" onchange="setFlatFieldFileRadio()">
	<option value="CH_TU2020-01-29T00-00-00_REF_APP_FlatFieldTeff-PointSource_V0103.fits" selected>CH_TU2020-01-29T00-00-00_REF_APP_FlatFieldTeff-PointSource_V0103.fits (2018 on ground calibration, SED, 2020 ESA QE weighting)</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#EmpiricalFlatField" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <ul>
	<table>
	  <tr>
	    <td>Standard deviation of Gaussian used to smear the flat field</td>
	    <td><input NAME="flatFieldSmearSigma" ID="flatFieldSmearSigma" VALUE="0.0005" onchange="checkFloat(this)" onclick="setFlatFieldFileRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#flatFieldSmearSigma" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	  <tr>
	    <td>Offset to the black body effective temperature used for wavelength weighting</td>
	    <td><input NAME="flatFieldTeffOffset" ID="flatFieldTeffOffset" VALUE="0.0" onchange="checkFloat(this)" onclick="setFlatFieldFileRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#flatFieldTeffOffset" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	</table>
      </ul>
      <p><input type="radio" name="flatFieldMethod" id="flatFieldGaussianRadio" value="gaussian">Gaussian flat field:
      <ul>
	<table>
	  <tr>
	    <td>Standard deviation for Gaussian flat field</td>
	    <td><input NAME="flatFieldSigma" ID="flatFieldSigma" VALUE="0.001" onchange="checkFloat(this)" onclick="setFlatFieldGaussianRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#flatFieldSigma" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	  <tr>
	    <td>Seed for random number generation</td>
	    <td><input NAME="flatFieldSeed" ID="flatFieldSeed" VALUE="3456" onchange="checkInteger(this)" onclick="setFlatFieldGaussianRadio()"></td>
	    <td><a href="UserManual/CHEOPSim_UserManual.html#flatFieldSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	  </tr>
	</table>
      </ul>
      <p><input type="radio" name="flatFieldMethod" id="flatFieldUploadRadio" value="upload">User provided flat field
      <a href="UserManual/CHEOPSim_UserManual.html#FlatFieldGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <input type="file" name="flatFieldUploadFile" id="flatFieldUploadFile" onclick="setFlatFieldUploadRadio()"/>
      <p>Scale factor to apply to deviations from the mean (does not apply for Gaussian option) <input NAME="flatFieldScaleFactor" ID="flatFieldScaleFactor" VALUE="1.0" onchange="checkFloat(this)">
      <a href="UserManual/CHEOPSim_UserManual.html#flatFieldScaleFactor" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <p><input TYPE="CHECKBOX" NAME="writeTruthFlatField" ID="writeTruthFlatField" VALUE="true" CHECKED> Output truth flat field
      <a href="UserManual/CHEOPSim_UserManual.html#writeTruthFlatField" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </ul>
  </div>
  
  <p><input TYPE="CHECKBOX" NAME="doDeadPixels" ID="doDeadPixels" VALUE="false"> Simulate dead pixels
  <a href="UserManual/CHEOPSim_UserManual.html#deadPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="DeadPixels" style="display:none">
    <ul>
      <table>
	<tr>
	  <td>Fraction of pixels which are dead</td>
	  <td><input NAME="fracDeadPixels" ID="fracDeadPixels" VALUE="0.0005" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#fracDeadPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Factor by which quantum efficiency is reduced for dead pixels</td>
	  <td><input NAME="deadPixelRelativeQE" ID="deadPixelRelativeQE" VALUE="0.5" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#deadPixelRelativeQE" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Seed for random number generation for dead pixel positions</td>
	  <td><input NAME="deadPixelPositionSeed" ID="deadPixelPositionSeed" VALUE="2345" onchange="checkInteger(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#deadPixelPositionSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
    </ul>
  </div>
  
</div>

<SCRIPT language="javascript">
function setFlatFieldFileRadio() {
    document.getElementById("flatFieldFileRadio").checked=true;
}
function setFlatFieldUploadRadio() {
    document.getElementById("flatFieldUploadRadio").checked=true;
}
function setFlatFieldGaussianRadio() {
    document.getElementById("flatFieldGaussianRadio").checked=true;
}
</SCRIPT>

<hr>						
<h3 id="linkDarkCurrentGenerator"><input TYPE="CHECKBOX" NAME="runDarkCurrentGenerator" ID="runDarkCurrentGenerator" VALUE="true" CHECKED> Module: DarkCurrentGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#DarkCurrentGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="DarkCurrentGenerator">
  <font color="green"><i>Note: This module generates the expected dark current in each pixel, without shot noise. Shot noise is generated for both signal and dark electrons in <a href="#linkPhotonNoiseGenerator">ShotNoiseGenerator</a>.</i></font>
  <p><input type="radio" name="darkCurrentMethod" id="darkFrameRadio" value="file" checked>Expected dark current in each pixel determined from empirical dark frame:
  <ul>
    <table>
      <tr><td>Dark frame file
	<select name="darkFrameFilename" id="darkFrameFilename" onchange="setDarkFrameRadio()">
	  <option value="CH_TU2018-01-01T00-00-00_REF_APP_DarkFrame_V0101.fits" selected>CH_TU2018-01-01T00-00-00_REF_APP_DarkFrame_V0101.fits (2018 on ground calibration)</option>
	</select>
	<a href="UserManual/CHEOPSim_UserManual.html#darkFrameFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td>Scale factor to apply to the dark frame <input NAME="darkFrameScaleFactor" ID="darkFrameScaleFactor" VALUE="1.0" onchange="checkFloat(this)" onclick="setDarkFrameRadio()">
	<a href="UserManual/CHEOPSim_UserManual.html#darkFrameScaleFactor" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      <td></tr>
      </table>
  </ul>
  <p><input type="radio" name="darkCurrentMethod" id="flatDarkCurrentRadio" value="flat">Expected dark current set to the same value for all pixels:
  <ul>
    Mean dark current at 233K in electrons/second/pixel <input NAME="meanDarkCurrent233K" ID="meanDarkCurrent233K" VALUE="0.01" onchange="checkFloat(this)" onclick="setFlatDarkCurrentRadio()">
    <a href="UserManual/CHEOPSim_UserManual.html#meanDarkCurrent233K" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </ul>

  <p><input TYPE="CHECKBOX" NAME="includeReadoutTime" ID="includeReadoutTime" VALUE="true" CHECKED> Include position dependent readout time as well as exposure duration for dark current accumulation:
  <a href="UserManual/CHEOPSim_UserManual.html#readoutModes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  <div id="readoutTime">
    <ul>
      <table>
	<tr>
	  <td>Time to shift down one row in microseconds</td>
	  <td><input NAME="rowDownShiftTime" ID="rowDownShiftTime" VALUE="30.0" onchange="checkFloat(this)">
	  <td><a href="UserManual/CHEOPSim_UserManual.html#readoutModes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Serial read rate in kHz</td>
	  <td><input NAME="serialReadRate" ID="serialReadRate" VALUE="100.0" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#readoutModes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
    </ul>
  </div>
  <table>
    <tr>
      <td>Seed for random number generation for hot, warm and telegraphic pixel positions</td>
      <td><input NAME="hotPixelPositionSeed" ID="hotPixelPositionSeed" VALUE="5432" onchange="checkInteger(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#hotPixelPositionSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Seed for random number generation for telegraphic pixel transitions</td>
      <td><input NAME="telegraphicTransitionSeed" ID="telegraphicTransitionSeed" VALUE="6543" onchange="checkInteger(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#telegraphicTransitionSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Time constant for transitions between states (active/inactive) for telegraphic pixels in seconds</td>
      <td><input NAME="telegraphicTimeConstant" ID="telegraphicTimeConstant" VALUE="540" onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#telegraphicPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
  <p><input TYPE="CHECKBOX" NAME="doHotPixels" ID="doHotPixels" VALUE="false"> Randomly generate hot pixels 
  <a href="UserManual/CHEOPSim_UserManual.html#hotPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="HotPixels">
    <ul>
      <table>
	<tr>
	  <td>Fraction of pixels which are hot</td>
	  <td><input NAME="fracHotPixels" ID="fracHotPixels" VALUE="0.000125" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#fracHotPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Factor by which mean dark current is increased for hot pixels</td>
	  <td><input NAME="hotPixelRelativeDarkCurrent" ID="hotPixelRelativeDarkCurrent" VALUE="500" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#hotPixelRelativeDarkCurrent" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
      </ul>
  </div>
  <p><input TYPE="CHECKBOX" NAME="doWarmPixels" ID="doWarmPixels" VALUE="false"> Randomly generate warm pixels 
  <a href="UserManual/CHEOPSim_UserManual.html#hotPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="WarmPixels">
    <ul>
      <table>
	<tr>
	  <td>Fraction of pixels which are warm</td>
	  <td><input NAME="fracWarmPixels" ID="fracWarmPixels" VALUE="0.000125" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#fracWarmPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Factor by which mean dark current is increased for warm pixels</td>
	  <td><input NAME="warmPixelRelativeDarkCurrent" ID="warmPixelRelativeDarkCurrent" VALUE="200" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#warmPixelRelativeDarkCurrent" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
      </ul>
  </div>
  <p><input TYPE="CHECKBOX" NAME="doTelegraphicPixels" ID="doTelegraphicPixels" VALUE="false"> Randomly generate telegraphic pixels 
  <a href="UserManual/CHEOPSim_UserManual.html#telegraphicPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="TelegraphicPixels">
    <ul>
      <table>
	<tr>
	  <td>Fraction of pixels which are telegraphic</td>
	  <td><input NAME="fracTelegraphicPixels" ID="fracTelegraphicPixels" VALUE="0.000125" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#fracTelegraphicPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Factor by which mean dark current is increased for telegraphic pixels</td>
	  <td><input NAME="telegraphicPixelRelativeDarkCurrent" ID="telegraphicPixelRelativeDarkCurrent" VALUE="500" onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#telegraphicPixelRelativeDarkCurrent" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
      </ul>
  </div>
  <p><input TYPE="CHECKBOX" NAME="doManualHotPixels" ID="doManualHotPixels" VALUE="false"> Manually generate hot/warm/telegraphic pixels 
  <a href="UserManual/CHEOPSim_UserManual.html#manualHotPixels" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="ManualHotPixels">
    <ul>Define up to 14 hot/warm/telegraphic pixel positions manually within the 200x200 subarray:
	<p><INPUT type="button" value="Add hot/warm/telegraphic pixel" onclick="addManualHotPixel()"/>
	<INPUT type="button" value="Reset" onclick="resetManualHotPixels()"/>
	<input id="nManualHotPixels" name="nManualHotPixels" style="display:none" value="1">
	<table id="manualHotPixels">
	  <tr style="display:inherit">
	    <td></td>
	    <td>X position</td>
	    <td>Y position</td>
	    <td>Mean dark current</td>
	    <td>Telegraphic</td>
	  </tr>
	  <tr style="display:inherit">
	    <td></td>
	    <td>(0 to 199)</td>
	    <td>(0 to 199)</td>
	    <td>(e-/s/pixel at 233K) </td>
	    <td></td>
	  </tr>
	  <tr style="display:inherit">
	    <td>0</td>
	    <td><input NAME="manualHotPixel0_X" ID="manualHotPixel0_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel0_Y" ID="manualHotPixel0_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel0_rate" ID="manualHotPixel0_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel0_isTelegraphic" ID="manualHotPixel0_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel1" style="display:none">
	    <td>1</td>
	    <td><input NAME="manualHotPixel1_X" ID="manualHotPixel1_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel1_Y" ID="manualHotPixel1_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel1_rate" ID="manualHotPixel1_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel1_isTelegraphic" ID="manualHotPixel1_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel2" style="display:none">
	    <td>2</td>
	    <td><input NAME="manualHotPixel2_X" ID="manualHotPixel2_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel2_Y" ID="manualHotPixel2_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel2_rate" ID="manualHotPixel2_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel2_isTelegraphic" ID="manualHotPixel2_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel3" style="display:none">
	    <td>3</td>
	    <td><input NAME="manualHotPixel3_X" ID="manualHotPixel3_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel3_Y" ID="manualHotPixel3_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel3_rate" ID="manualHotPixel3_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel3_isTelegraphic" ID="manualHotPixel3_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel4" style="display:none">
	    <td>4</td>
	    <td><input NAME="manualHotPixel4_X" ID="manualHotPixel4_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel4_Y" ID="manualHotPixel4_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel4_rate" ID="manualHotPixel4_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel4_isTelegraphic" ID="manualHotPixel4_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel5" style="display:none">
	    <td>5</td>
	    <td><input NAME="manualHotPixel5_X" ID="manualHotPixel5_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel5_Y" ID="manualHotPixel5_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel5_rate" ID="manualHotPixel5_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel5_isTelegraphic" ID="manualHotPixel5_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel6" style="display:none">
	    <td>6</td>
	    <td><input NAME="manualHotPixel6_X" ID="manualHotPixel6_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel6_Y" ID="manualHotPixel6_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel6_rate" ID="manualHotPixel6_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel6_isTelegraphic" ID="manualHotPixel6_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel7" style="display:none">
	    <td>7</td>
	    <td><input NAME="manualHotPixel7_X" ID="manualHotPixel7_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel7_Y" ID="manualHotPixel7_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel7_rate" ID="manualHotPixel7_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel7_isTelegraphic" ID="manualHotPixel7_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel8" style="display:none">
	    <td>8</td>
	    <td><input NAME="manualHotPixel8_X" ID="manualHotPixel8_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel8_Y" ID="manualHotPixel8_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel8_rate" ID="manualHotPixel8_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel8_isTelegraphic" ID="manualHotPixel8_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel9" style="display:none">
	    <td>9</td>
	    <td><input NAME="manualHotPixel9_X" ID="manualHotPixel9_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel9_Y" ID="manualHotPixel9_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel9_rate" ID="manualHotPixel9_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel9_isTelegraphic" ID="manualHotPixel9_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel10" style="display:none">
	    <td>10</td>
	    <td><input NAME="manualHotPixel10_X" ID="manualHotPixel10_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel10_Y" ID="manualHotPixel10_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel10_rate" ID="manualHotPixel10_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel10_isTelegraphic" ID="manualHotPixel10_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel11" style="display:none">
	    <td>11</td>
	    <td><input NAME="manualHotPixel11_X" ID="manualHotPixel11_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel11_Y" ID="manualHotPixel11_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel11_rate" ID="manualHotPixel11_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel11_isTelegraphic" ID="manualHotPixel11_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel12" style="display:none">
	    <td>12</td>
	    <td><input NAME="manualHotPixel12_X" ID="manualHotPixel12_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel12_Y" ID="manualHotPixel12_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel12_rate" ID="manualHotPixel12_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel12_isTelegraphic" ID="manualHotPixel12_isTelegraphic" VALUE="false"></td>
	  </tr>
	  <tr id="manualHotPixel13" style="display:none">
	    <td>13</td>
	    <td><input NAME="manualHotPixel13_X" ID="manualHotPixel13_X" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel13_Y" ID="manualHotPixel13_Y" VALUE="100" onchange="checkSubarrayIndex(this)"></td>
	    <td><input NAME="manualHotPixel13_rate" ID="manualHotPixel13_rate" VALUE="5." onchange="checkFloat(this)"></td>
	    <td><input TYPE="CHECKBOX" NAME="manualHotPixel13_isTelegraphic" ID="manualHotPixel13_isTelegraphic" VALUE="false"></td>
	  </tr>
	</table>
    </ul>
  </div>
</div>

<SCRIPT language="javascript">
function addManualHotPixel() {
    var N = parseInt(document.getElementById("nManualHotPixels").value);
    N = parseInt(N)+1;
    if (N>14) {
        alert("Maximum number of manually defined hot/warm/telegraphic pixels is 14");
    } else {
        var index = N-1;
        document.getElementById("manualHotPixel"+index).style.display = "inherit";
        document.getElementById("nManualHotPixels").value = N;
    }
}
function resetManualHotPixels() {
    var N = parseInt(document.getElementById("nManualHotPixels").value);
    for (var i = 1; i < N; i++) {
        document.getElementById("manualHotPixel"+i).style.display = "none";
    }    
    document.getElementById("nManualHotPixels").value = 1;
}
function displayManualHot() {
    var N = parseInt(document.getElementById("nManualHotPixels").value);
    for (var i = 1; i < N; i++) {
        document.getElementById("manualHotPixel"+i).style.display = "inherit";
    }    
}
</SCRIPT>

<SCRIPT language="javascript">
function setDarkFrameRadio() {
    document.getElementById("darkFrameRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function setFlatDarkCurrentRadio() {
    document.getElementById("flatDarkCurrentRadio").checked=true;
}
</SCRIPT>

<hr>
<h3 id="linkFrameTransferSmearer"><input TYPE="CHECKBOX" NAME="runFrameTransferSmearer" ID="runFrameTransferSmearer" VALUE="true" CHECKED onchange="updateStars(false)"> Module: FrameTransferSmearer 
<a href="UserManual/CHEOPSim_UserManual.html#FrameTransferSmearer" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="FrameTransferSmearer">
  <table>
    <tr>
      <td>Frame transfer clock period in microseconds</td><td><input NAME="transferClockPeriod" ID="transferClockPeriod" VALUE="25.0" onchange="checkFloat(this)">
      <td><a href="UserManual/CHEOPSim_UserManual.html#transferClockPeriod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
</div>

<hr>						  
<h3 id="linkPhotonNoiseGenerator"><input TYPE="CHECKBOX" NAME="runPhotonNoiseGenerator" ID="runPhotonNoiseGenerator" VALUE="true" CHECKED> Module: ShotNoiseGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#PhotonNoiseGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="PhotonNoiseGenerator">
  <p>Seed for random number generation <input NAME="photonNoiseSeed" ID="photonNoiseSeed" VALUE="4567" onchange="checkInteger(this)">
  <a href="UserManual/CHEOPSim_UserManual.html#photonNoiseSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
</div>

<hr>						
<h3 id="linkCosmicRayGenerator"><input TYPE="CHECKBOX" NAME="runCosmicRayGenerator" ID="runCosmicRayGenerator" VALUE="true" CHECKED> Module: CosmicRayGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#CosmicRayGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="CosmicRayGenerator">
  <table>
    <tr>
      <td>Mean number of cosmic rays per minute on 200x200 pixels</td>
      <td><input NAME="meanCosmicsPerMinute" ID="meanCosmicsPerMinute" VALUE="10.8" onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#meanCosmicsPerMinute" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
    <tr>
      <td>Factor by which cosmic ray flux increases within the SAA (requires OrbitSimulator (Satellite tab))</td>
      <td><input NAME="SAAFluxFactor" ID="SAAFluxFactor" VALUE="1000." onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#SAAFluxFactor" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </tr>
    <tr>
      <td>Scale factor for cosmic ray energy distribution</td>
      <td><input NAME="cosmicEnergyScaleFactor" ID="cosmicEnergyScaleFactor" VALUE="1." onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#cosmicEnergyScaleFactor" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </tr>
    <tr>
      <td>Seed for random number generation</td>
      <td><input NAME="cosmicSeed" ID="cosmicSeed" VALUE="6789" onchange="checkInteger(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#cosmicSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
</div>

<hr>
<h3 id="linkFullWellSimulator"><input TYPE="CHECKBOX" NAME="runFullWellSimulator" ID="runFullWellSimulator" VALUE="true" CHECKED> Module: FullWellSimulator 
<a href="UserManual/CHEOPSim_UserManual.html#FullWellSimulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="FullWellSimulator">
  <table>
    <tr>
      <td>Full well capacity (number of electrons)</td><td><input ID="fullWellCapacity" NAME="fullWellCapacity" VALUE="114000" onchange="checkInteger(this);calculateSaturation()"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#fullWellCapacity" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
</div>

<hr>
<h3 id="linkChargeTransferSimulator"><input TYPE="CHECKBOX" NAME="runChargeTransferSimulator" ID="runChargeTransferSimulator" VALUE="false" onchange="calculateRuntime()"> Module: ChargeTransferSimulator 
<a href="UserManual/CHEOPSim_UserManual.html#ChargeTransferSimulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="ChargeTransferSimulator" style="display:none">
  <p><input type="radio" name="stageOfLife" id="beginOfLifeRadio" value="begin" checked>Simulate CTI at beginning of life, by simulating the shifting of rows and pixels performed during frame transfer and readout, assuming a fixed fraction of charge is not transferred during each shift:
  <a href="UserManual/CHEOPSim_UserManual.html#beginOfLife" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul>
    <table>
      <tr>
	<td>Parallel (vertical) charge transfer efficiency (%)</td><td><input NAME="cte_vertical" ID="cte_vertical" VALUE="99.9999" onchange="checkFloat(this)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#cte_vertical" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Serial (horizontal) charge transfer efficiency (%)</td><td><input NAME="cte_horizontal" ID="cte_horizontal" VALUE="99.9993" onchange="checkFloat(this)">
	<td><a href="UserManual/CHEOPSim_UserManual.html#cte_horizontal" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
    </table>
  </ul>
  <p><input type="radio" name="stageOfLife" id="endOfLifeRadio" value="end">Simulate CTI at end of life, by generating exponential tails in the upward direction for each pixel, containing a fraction of the pixel charge which scales with the pixel intensity:
  <a href="UserManual/CHEOPSim_UserManual.html#endOfLife" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul>
    <table>
      <tr>
	<td>Exponential decay constant for CTI trails (in pixels)</td><td><input NAME="cti_trailLength" ID="cti_trailLength" VALUE="100." onchange="checkFloat(this)"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#cti_trailLength" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Fraction of intensity transferred to CTI tails for a pixel intensity of 10000 electrons</td><td><input NAME="cti_trailFraction" ID="cti_trailFraction" VALUE="0.028" onchange="checkFloat(this)">
	<td><a href="UserManual/CHEOPSim_UserManual.html#cti_trailFraction" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Scaling exponent for fraction of intensity transferred to CTI tails as a function of intensity</td><td><input NAME="cti_intensityScaling" ID="cti_intensityScaling" VALUE="-0.65" onchange="checkFloat(this)">
	<td><a href="UserManual/CHEOPSim_UserManual.html#cti_intensityScaling" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
    </table>
  </ul>
</div>

<hr>						  
<h3 id="linkBiasGenerator"><input TYPE="CHECKBOX" NAME="runBiasGenerator" ID="runBiasGenerator" VALUE="true" CHECKED onclick="calculateSaturation()"> Module: BiasGenerator 
<a href="UserManual/CHEOPSim_UserManual.html#BiasGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="BiasGenerator">
  <i><font color=green>Note: If this module is active, the output image has units of ADU. If it is deactivated, the units are electrons.</font></i><br>

  <p><input type="radio" name="biasMethod" id="biasFrameRadio" value="file" checked>Define bias offset and readout noise separately for each pixel according to empirical bias frame:
  <ul>
    <select name="biasFrameFilename" id="biasFrameFilename" onchange="setBiasFrameRadio()">
      <option value="CH_TU2019-12-18T00-00-00_REF_APP_BiasFrame_V0109.fits" selected>CH_TU2019-12-18T00-00-00_REF_APP_BiasFrame_V0109.fits (2018 on ground calibration)</option>
    </select>
    <a href="UserManual/CHEOPSim_UserManual.html#biasFrameFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </ul>
  <p><input type="radio" name="biasMethod" id="gaussianBiasRadio" value="flat">Define the same bias offset and readout noise for all pixels:
  <ul>
    <table>
      <tr>
	<td>Bias level offset [ADU]</td>
	<td><input ID="biasMean" NAME="biasMean" VALUE="609.0" onchange="checkFloat(this);calculateSaturation()" onclick="setGaussianBiasRadio()"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#biasMean" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
      <tr>
	<td>Readout noise Gaussian width [ADU]</td>
	<td><input NAME="biasWidth" ID="biasWidth" VALUE="3.5" onchange="checkFloat(this)" onclick="setGaussianBiasRadio()"></td>
	<td><a href="UserManual/CHEOPSim_UserManual.html#biasWidth" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
      </tr>
    </table>
  </ul>
  
  <p>Seed for Gaussian random number generator for readout noise <input NAME="biasNoiseSeed" ID="biasNoiseSeed" VALUE="5678" onchange="checkInteger(this)">
  <a href="UserManual/CHEOPSim_UserManual.html#biasNoiseSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <p>Electronic gain of the CCD (formula)
  <select name="gainCorrectionFilename" id="gainCorrectionFilename">
    <option value="CH_TU2020-02-18T06-15-13_REF_APP_GainCorrection_V0109.fits" selected>CH_TU2020-02-18T06-15-13_REF_APP_GainCorrection_V0109.fits</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#gain" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <ul>
    <p><input TYPE="CHECKBOX" NAME="applyAnalogElectronicsStability" ID="applyAnalogElectronicsStability" VALUE="true" checked> Include analog electronics stability
    <a href="UserManual/CHEOPSim_UserManual.html#BiasGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </ul>
  <p><input TYPE="CHECKBOX" NAME="doCcdNonLinearity" ID="doCcdNonLinearity" VALUE="true" checked> Include CCD non-linearity 
  <a href="UserManual/CHEOPSim_UserManual.html#ccdNonLinearity" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="ccdNonLinearity">
    <ul>
      File containing spline coefficients used to define the non-linearity:
      <select name="ccdNonLinearityFilename" id="ccdNonLinearityFilename">
	<option value="CH_TU2018-01-01T00-00-00_REF_APP_CCDLinearisationLUT100_V0104.fits" selected>CH_TU2018-01-01T00-00-00_REF_APP_CCDLinearisationLUT100_V0104.fits</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#ccdNonLinearityFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </ul>
  </div>
  <!-- <p><input TYPE="CHECKBOX" NAME="applyAnalogChainRandomNoise" ID="applyAnalogChainRandomNoise" VALUE="true" checked> Include analog chain random noise -->
  <!-- <a href="UserManual/CHEOPSim_UserManual.html#analogChainRandomNoise" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a> -->
  <!-- <div id="analogChainRandomNoise"> -->
  <!--   <ul> -->
  <!--     <table> -->
  <!-- 	<tr> -->
  <!-- 	  <td>Mean value for analog chain random noise [electrons/second/pixel]</td> -->
  <!-- 	  <td><input NAME="meanAnalogChainRandomNoise" VALUE="15.7" onchange="checkFloat(this)"></td> -->
  <!-- 	  <td><a href="UserManual/CHEOPSim_UserManual.html#meanAnalogChainRandomNoise" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	</tr> -->
  <!-- 	<tr> -->
  <!-- 	  <td>Seed for random number generation for analog chain random noise</td> -->
  <!-- 	  <td><input NAME="analogChainRandomNoiseSeed" ID="analogChainRandomNoiseSeed" VALUE="7890" onchange="checkInteger(this)"></td> -->
  <!-- 	  <td><a href="UserManual/CHEOPSim_UserManual.html#analogChainRandomNoiseSeed" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	</tr> -->
  <!--     </table> -->
  <!--     </ul> -->
  <!-- </div> -->
  <!-- <br><input type="checkbox" name="doADCSaturation" id="doADCSaturation" VALUE="true" CHECKED> Apply ADC Saturation  -->
  <!-- <div id="ADCSaturation"> -->
  <!--   <ul> -->
  <!--     <table> -->
  <!-- 	<tr> -->
  <!-- 	  <td>ADC number of bits</td><td><input ID="ADCBits" NAME="ADCBits" VALUE="16" onchange="checkInteger(this);calculateSaturation()"></td> -->
  <!-- 	  <td><a href="UserManual/CHEOPSim_UserManual.html#ADCBits" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	</tr> -->
  <!--     </ul> -->
  <!--   </table> -->
  <!-- </div> -->
</div>

<SCRIPT language="javascript">
function setBiasFrameRadio() {
    document.getElementById("biasFrameRadio").checked=true;
}
</SCRIPT>

<SCRIPT language="javascript">
function setGaussianBiasRadio() {
    document.getElementById("gaussianBiasRadio").checked=true;
}
</SCRIPT>

</div>
<div id="OutputTab" class="tabcontent">
						
<h3 id="linkImageWriter"><input TYPE="CHECKBOX" NAME="runImageWriter" ID="runImageWriter" VALUE="true" CHECKED> Module: ImageWriter 
<a href="UserManual/CHEOPSim_UserManual.html#ImageWriter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="ImageWriter">

  <input type="checkbox" name="writeStackedImages" id="writeStackedImages" VALUE="true" CHECKED> Output FITS files containing stacked images 
  <a href="UserManual/CHEOPSim_UserManual.html#writeStackedImages" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="stackedImages">
    <ul>
      <table><tr><td>Format: </td><td><select ID="doublePrecisionStackedImages" NAME="doublePrecisionStackedImages">
	<option value="false" selected>32 bit unsigned integers</option>
	<option value="true">Double precision</option>
      </select>
      </td></tr>
      <tr><td>Stacking method for sub-arrays and imagettes: </td><td><select ID="stackingMethod" NAME="stackingMethod">
	<option value="coadd" selected>coadd</option>
	<option value="mean">mean</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#stackingMethod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td>Stacking method for CCD margins: </td><td><select ID="marginStackingMethod" NAME="marginStackingMethod">
	<option value="coadd" selected>coadd</option>
	<option value="mean">mean</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#marginStackingMethod" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td>Shape: </td><td><select ID="subarrayShape" NAME="subarrayShape">
	<option value="circular" selected>circular</option>
	<option value="rectangular">rectangular</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#subarrayShape" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </td></tr></table>
    </ul>
  </div>
  
  <p><input type="checkbox" name="writeImagettes" id="writeImagettes" VALUE="true" CHECKED> Output FITS files containing an imagette for each exposure
  <a href="UserManual/CHEOPSim_UserManual.html#writeImagettes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="imagette">
    <ul>
      <table><tr><td>Size of imagette in number of pixels along each side of a square <input NAME="imagetteSize" ID="imagetteSize" VALUE="60" onchange="checkInteger(this)">
	<a href="UserManual/CHEOPSim_UserManual.html#imagetteSize" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td>Cropping method: <select ID="croppingMethod" NAME="croppingMethod">
	<option value="static" selected>static (fixed position on CCD)</option>
	<option value="dynamic">dynamic (position follows centroid)</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#dynamicImagettes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td>Shape: <span style="display:inline-block; width: 1.77cm;"></span><select ID="imagetteShape" NAME="imagetteShape">
	<option value="circular" selected>circular</option>
	<option value="rectangular">rectangular</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#imagetteShape" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr>
      <tr><td><input type="checkbox" name="stackImagettes" id="stackImagettes" VALUE="true" CHECKED> Perform imagette stacking (stacking order is indicated in the Visit tab)
      <a href="UserManual/CHEOPSim_UserManual.html#stackImagettes" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
      </td></tr></table>
    </ul>
  </div>
    
  <!--     Parameters for imagette extraction: -->
  <!--     <ul> -->
  <!-- 	<table> -->
  <!-- 	  <tr> -->
  <!-- 	    <td>Size of imagette in number of pixels along each side of a square</td><td><input NAME="imagetteSize" VALUE="35" onchange="checkInteger(this)"></td> -->
  <!-- 	    <td><a href="UserManual/CHEOPSim_UserManual.html#imagetteSize" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	  </tr> -->
  <!-- 	  <tr> -->
  <!-- 	    <td>Radius of circle centred on image centre used to determine PSF barycentre</td><td><input NAME="radius_barycentre_imagette" VALUE="35." onchange="checkFloat(this)"></td> -->
  <!-- 	    <td><a href="UserManual/CHEOPSim_UserManual.html#radius_barycentre_imagette" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	  </tr> -->
  <!-- 	  <tr> -->
  <!-- 	    <td>Inner radius of anulus centred on image centre used to evaluate the background</td><td><input NAME="radius_bkgInner_imagette" VALUE="40." onchange="checkFloat(this)"></td> -->
  <!-- 	    <td><a href="UserManual/CHEOPSim_UserManual.html#radius_bkgInner_imagette" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	  </tr> -->
  <!-- 	  <tr> -->
  <!-- 	    <td>Outer radius of anulus centred on image centre used to evaluate the background</td><td><input NAME="radius_bkgOuter_imagette" VALUE="60." onchange="checkFloat(this)"></td> -->
  <!-- 	    <td><a href="UserManual/CHEOPSim_UserManual.html#radius_bkgOuter_imagette" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
  <!-- 	  </tr> -->
  <!-- 	</table> -->
  <!--     </ul> -->

  <p><input type="checkbox" name="writeUnstackedImages" id="writeUnstackedImages" VALUE="false"> Output FITS files containing unstacked images 
  <a href="UserManual/CHEOPSim_UserManual.html#writeUnstackedImages" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <table><tr><td><input type="checkbox" name="writeCentroid" id="writeCentroid" VALUE="true" CHECKED> Write onboard calculated centroid for each exposure
    <a href="UserManual/CHEOPSim_UserManual.html#writeCentroid" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr>
  <table><tr><td><input type="checkbox" name="writeTruthData" id="writeTruthData" VALUE="true" CHECKED> Write truth information
    <a href="UserManual/CHEOPSim_UserManual.html#writeTruthData" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr>
  <tr><td><input type="checkbox" name="omitEarthOccultation" id="omitEarthOccultation" VALUE="true" checked> Do not write images during Earth occultation
    <a href="UserManual/CHEOPSim_UserManual.html#omitEarthOccultation" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr>
  <tr><td><input type="checkbox" name="omitSAA" id="omitSAA" VALUE="true" checked> Do not write images when spacecraft is within the SAA
    <a href="UserManual/CHEOPSim_UserManual.html#omitSAA" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <tr><td><input type="checkbox" name="omitStrayLight" id="omitStrayLight" VALUE="true" checked> Do not write images when stray light is above the threshold defined in MPS_PRE_Visits (Visit tab) or StrayLightGenerator (Telescope tab)
    <a href="UserManual/CHEOPSim_UserManual.html#omitStrayLight" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr></table>
    
  <p>CCD margin mode:  
  <select ID="marginMode" NAME="marginMode">
    <option value="image">image</option>
    <option value="reduced" selected>reduced</option>
    <option value="total collapsed">total collapsed</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#ccdMargins" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <!--<i><font color=green>   Note: Will be overridden by MPS_PRE_Visits MARGIN_MODE if the Visit is defined by <a href="#time">uploading an MPS_PRE_Visits file</a></font></i>-->

  <p>CCD readout hardware:  
  <select ID="readoutHardware" NAME="readoutHardware">
    <option value="main" selected>main</option>
    <option value="redundant">redundant</option>
  </select>
  <a href="UserManual/CHEOPSim_UserManual.html#readoutHardware" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>

  <table><tr><td>Maximum number of images per FITS image cube <input NAME="maxImagesPerCube" ID="maxImagesPerCube" VALUE="2000" onchange="checkInteger(this)">
  <a href="UserManual/CHEOPSim_UserManual.html#maxImagesPerCube" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr>
  <tr><td>Omit the first <input name="numberOfCEsToOmitAtStart" id="numberOfCEsToOmitAtStart" VALUE="0" onchange="checkInteger(this)"> stacked images from the start of the simulation
    <a href="UserManual/CHEOPSim_UserManual.html#numberOfCEsToOmitAtStart" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr>
  <tr><td>Only write out every Nth stacked image, where N=<input name="onlyWriteEveryNthCE" id="onlyWriteEveryNthCE" VALUE="1" onchange="checkInteger(this)">
    <a href="UserManual/CHEOPSim_UserManual.html#onlyWriteEveryNthCE" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </td></tr></table>
  
  <input name="targetLocationFromJitter" id="targetLocationFromJitter" value="false" style="display:none">
  <input name="ceCounterOffset" id="ceCounterOffset" value="0" style="display:none">
  
  <!-- <p><input type="checkbox" name="writeAnimation" id="writeAnimation" VALUE="true" CHECKED>Output an animation of the first <input NAME="animationNImages" VALUE="100" onchange="checkInteger(this)"> stacked images
  <a href="UserManual/CHEOPSim_UserManual.html#animationNImages" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a> -->
  
</div>

<hr>	
<h3 id="linkHKWriter"><input TYPE="CHECKBOX" NAME="runHKWriter" ID="runHKWriter" VALUE="true" CHECKED> Module: HKWriter 
<a href="UserManual/CHEOPSim_UserManual.html#HKWriter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<input name="sdsCounterOffset" id="sdsCounterOffset" value="0" style="display:none">

<hr>						  
<h3 id="linkDataReduction"><input TYPE="CHECKBOX" NAME="extractLightCurve" ID="extractLightCurve" VALUE="false"> Module: Photometry
<a href="UserManual/CHEOPSim_UserManual.html#DataReduction" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></h3>
<div id="photometry">

  <p><font color=green><i>Basic photometry internal to CHEOPSim. In most cases, the Data Reduction Pipeline should be run after CHEOPSim instead. The option to do that is presented after submitting this form.</i></font>
  
  <table>
    <!-- <tr> -->
      <!--   <td>Radius of circle centred on image centre used to determine PSF barycentre</td><td><input NAME="radius_barycentre" VALUE="35." onchange="checkFloat(this)"></td> -->
      <!--   <td><a href="UserManual/CHEOPSim_UserManual.html#radius_barycentre" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td> -->
    <!-- </tr> -->
    <tr>
      <td>Radius of circle centred on truth PSF barycentre used to extract the signal flux</td><td><input NAME="radius_psf" ID="radius_psf" VALUE="33." onchange="checkFloat(this)"></td>
      <td><a href="UserManual/CHEOPSim_UserManual.html#radius_psf" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
    </tr>
  </table>
  
  <p><input type="checkbox" name="subtractBackground" id="subtractBackground" VALUE="true" CHECKED> Subtract the background calculated as the median within an annulus centred on the PSF barycentre
  <a href="UserManual/CHEOPSim_UserManual.html#subtractBackground" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="backgroundSubtraction">
    <ul>
      <table>
	<tr>
	  <td>Inner radius of anulus centred on truth PSF barycentre used to evaluate the background</td><td><input NAME="radius_bkgInner" id="radius_bkgInner" VALUE="40." onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#radius_bkgInner" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
	<tr>
	  <td>Outer radius of anulus centred on truth PSF barycentre used to evaluate the background</td><td><input NAME="radius_bkgOuter" id="radius_bkgOuter" VALUE="60." onchange="checkFloat(this)"></td>
	  <td><a href="UserManual/CHEOPSim_UserManual.html#radius_bkgOuter" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
	</tr>
      </table>
    </ul>
  </div>
  
  <p><input type="checkbox" name="subtractFlatField" id="subtractFlatField" VALUE="false"> Perform flat field correction (requires FlatFieldGenerator (Detector tab) to be run)
  <a href="UserManual/CHEOPSim_UserManual.html#flatFieldCorrection" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  <div id="flatFieldCorrection">
    <ul>
      <p>REF_APP_FlatFieldTeff file used to define the flat field for the correction <font color=green><i> - requires empirical flat field option in FlatFieldGenerator, otherwise the applied flat field is used for the correction</i></font>
      <select name="flatFieldToSubtractFilename" id="flatFieldToSubtractFilename">
	<option value="CH_TU2020-01-29T00-00-00_REF_APP_FlatFieldTeff-PointSource_V0103.fits" selected>CH_TU2020-01-29T00-00-00_REF_APP_FlatFieldTeff-PointSource_V0103.fits (2018 on ground calibration, SED, 2020 ESA QE weighting)</option>
      </select>
      <a href="UserManual/CHEOPSim_UserManual.html#flatFieldToSubtractFilename" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
    </ul>
  </div>

  <p><input type="checkbox" name="generateNoiseCurve" id="generateNoiseCurve"  VALUE="true" CHECKED> Output a FITS table containing the noise curve (standard deviation of the extracted light curve as a function of the binning in time)
  <a href="UserManual/CHEOPSim_UserManual.html#generateNoiseCurve" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a>
  </div>

</div>

<SCRIPT language="javascript">
function calculateRuntime() {
    calculateDuration();
    var duration = document.getElementById("duration").value*3600.;
    var nStars = document.getElementById("nStars_subarray").value;
    var targetStarPositioning = document.getElementById("targetStarPositioning").value;
    var backgroundStarPositioning = document.getElementById("backgroundStarPositioning").value;
    var oversampleJitter = (document.getElementById("oversampleJitter").value=="true");
    var runtime = 0;
    if (oversampleJitter) {
        if (backgroundStarPositioning=="Oversampling") {
            runtime = (24.7*nStars + 26.3)/300;
        } else if (targetStarPositioning=="Oversampling" && nStars<=100) {
            runtime = (3.12*nStars + 47.9)/300;
        } else {
            runtime = (3.39*nStars + 20.6)/300;
        }
    } else {
        if (backgroundStarPositioning=="Oversampling") {
            runtime = (2.37*nStars + 20.6)/300;
        } else if (targetStarPositioning=="Oversampling") {
            runtime = (1.38*nStars + 21.6)/300;
        } else {
            runtime = (1.40*nStars + 19.6)/300;
        }
    }
    if (document.getElementById("runChargeTransferSimulator").checked) runtime*=2.;
    runtime *= duration/3600.;
    runtime += 0.02;
    runtime*=2.; //fudge factor because predictions are too short
    document.getElementById("runtime").value = parseFloat(runtime).toFixed(1);
    if (runtime > 24.) {
      document.getElementById("runtime").style.color="orange";
      document.getElementById("runtime").style.color="orange";
      alert("Warning: runtime is more than 24 hours");
      document.getElementById("runtimeError").innerHTML="Warning: runtime is more than 24 hours";
      document.getElementById("runtimeError").style.color="orange";
    } else {
      document.getElementById("runtime").style.color="green";
      document.getElementById("runtime").style.color="green";
      document.getElementById("runtime").style.borderColor='';
      document.getElementById("runtime").style.borderColor='';
      document.getElementById("runtimeError").innerHTML='';
    }
}
</SCRIPT>

<br><br>
<center>
<style type="text/css">
.myTable2 { background-color:#CED8F6;border-collapse:collapse;text-align:center;border:1px solid #000;width:950px; }
.myTable2 th { background-color:#A9BCF5;border:1px solid #000;}
.myTable2 td, .myTable th { padding:6px }
</style>
<table class="myTable2">
  <tr>
    <td>Simulation duration in hours = (no. of stacked images * no. of exposures per stack * repetition period)/3600  </td>
    <td><input id="duration" VALUE="" onclick="calculateRuntime()" readonly></td>
    <td></td>
  </tr>
  <tr>
    <td>No. of stars to be processed (within sub-array, plus regions above and below if FrameTransferSmearer (Detector tab) is on): </td>
    <td><input name="nStars_subarray" id="nStars_subarray" value="1" onchange="checkInteger(this);calculateRuntime()" readonly></td>
    <td></td>
  </tr>
  <tr>
    <td>Saturation 1: Predicted PSF maximum for target star as a percentage of full well capacity (valid for default PSF): </td>
    <td><input id="saturation1" VALUE="" onclick="calculateSaturation()" readonly></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#FullWellSimulator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Saturation 2: Predicted PSF maximum for target star as a percentage of the ADU saturation level (valid for default PSF): </td>
    <td><input id="saturation2" VALUE="" onclick="calculateSaturation()" readonly></td>
    <td><a href="UserManual/CHEOPSim_UserManual.html#BiasGenerator" target="_CHEOPSimUserManual"><img src="information.gif" width="12"></a></td>
  </tr>
  <tr>
    <td>Estimated run time (hours): </td>
    <td><input name="runtime" id="runtime" VALUE="" onclick="calculateRuntime()" readonly></td>
    <td></td>
  </tr>
</table>
<p id="saturationWarning1"></p>
<p id="saturationWarning2"></p>
</center>
<p>The saturation levels can be modified by adjusting the exposure duration (Visit tab).  Full well capacity saturation depends on the stellar magnitude and spectral type (Star Field tab) and full well capacity (FullWellSimulator module in Detector tab).  ADU saturation depends additionally on the gain and bias offset (BiasGenerator module in Detector tab). The saturation level prediction is only available for target star magnitude values between 5.0 and 13.0. 
<center><p id="runtimeError"></p></center>
<p>The runtime can be reduced by:
<ul>
  <li>reducing the simulation duration (Visit tab)
  <li>reducing the number of stars, e.g. by changing the magnitude threshold (Star Field tab)
  <li>Switching off ChargeTransferSimulator (Detector tab)
  <li>Switching off FrameTransferSmearer (Detector tab) if there are background stars outside the sub-array
  <li>using interpolation rather than oversampling for the PSF positioning (PSFGenerator module in Telescope tab)
  <li>reducing the jitter sampling rate (PSFGenerator module in Telescope tab)
</ul>
<center>
<p>Use the following button to increment the values of all random seeds relating to the CCD by 1: <input TYPE="Button" name="incrementSeeds" value="Increment random seeds" onClick="incrementRandomSeeds()">
<p><input TYPE="Submit" name="formSubmit" value="Generate configuration file" onClick="setPSF()";>
<input type="Reset" name="formReset" onClick="resetPSF();window.location.reload()">
</center>

<SCRIPT language="javascript">
function incrementRandomSeeds() {
    document.getElementById("flatFieldSeed").value = parseInt(document.getElementById("flatFieldSeed").value) + 1;
    document.getElementById("deadPixelPositionSeed").value = parseInt(document.getElementById("deadPixelPositionSeed").value) + 1;
    document.getElementById("photonNoiseSeed").value = parseInt(document.getElementById("photonNoiseSeed").value) + 1;
    document.getElementById("hotPixelPositionSeed").value = parseInt(document.getElementById("hotPixelPositionSeed").value) + 1;
    document.getElementById("telegraphicTransitionSeed").value = parseInt(document.getElementById("telegraphicTransitionSeed").value) + 1;
    document.getElementById("cosmicSeed").value = parseInt(document.getElementById("cosmicSeed").value) + 1;
    document.getElementById("biasNoiseSeed").value = parseInt(document.getElementById("biasNoiseSeed").value) + 1;
}
</SCRIPT>

<SCRIPT language="javascript">
function setPSF() {
    //Remember the selected PSF for when using "back to form"
    //console.log("setting white PSF to "+document.getElementById("whitePSF_filename").value)
    sessionStorage.setItem("whitePSF_filename", document.getElementById("whitePSF_filename").value);
    //console.log("setting monochromatic PSF to "+document.getElementById("monochromaticPSF_filename").value)
    sessionStorage.setItem("monochromaticPSF_filename", document.getElementById("monochromaticPSF_filename").value); 
    sessionStorage.setItem("repetitionPeriod", document.getElementById("repetitionPeriod").value); 
}
</SCRIPT>

<SCRIPT language="javascript">
function resetPSF() {
    sessionStorage.setItem("whitePSF_filename","CH_TU2020-04-18T06-30-00_REF_APP_WhitePSF_V0107.fits");
    sessionStorage.setItem("monochromaticPSF_filename","PSF_Field1_def0.000mm_W_350_1100nm_Dwave5nm_radius12px_nominal_monochromatic.fits");
}
</SCRIPT>

</form>

</body>
</html>
